var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(f){var b=function(){};b.prototype=f;return new b};$jscomp.underscoreProtoCanBeSet=function(){var f={a:!0},b={};try{return b.__proto__=f,b.a}catch(n){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(f,b){f.__proto__=b;if(f.__proto__!==b)throw new TypeError(f+" is not extensible");return f}:null;
$jscomp.inherits=function(f,b){f.prototype=$jscomp.objectCreate(b.prototype);f.prototype.constructor=f;if($jscomp.setPrototypeOf){var n=$jscomp.setPrototypeOf;n(f,b)}else for(n in b)if("prototype"!=n)if(Object.defineProperties){var l=Object.getOwnPropertyDescriptor(b,n);l&&Object.defineProperty(f,n,l)}else f[n]=b[n];f.superClass_=b.prototype};
$jscomp.findInternal=function(f,b,n){f instanceof String&&(f=String(f));for(var l=f.length,m=0;m<l;m++){var t=f[m];if(b.call(n,t,m,f))return{i:m,v:t}}return{i:-1,v:void 0}};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,b,n){f!=Array.prototype&&f!=Object.prototype&&(f[b]=n.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(f,b,n,l){if(b){n=$jscomp.global;f=f.split(".");for(l=0;l<f.length-1;l++){var m=f[l];m in n||(n[m]={});n=n[m]}f=f[f.length-1];l=n[f];b=b(l);b!=l&&null!=b&&$jscomp.defineProperty(n,f,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(b,f){return $jscomp.findInternal(this,b,f).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(f){var b=0;return function(){return b<f.length?{done:!1,value:f[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};$jscomp.makeIterator=function(f){var b="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return b?b.call(f):$jscomp.arrayIterator(f)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(f){function b(){this.batch_=null}function n(b){return b instanceof m?b:new m(function(a,c){a(b)})}if(f&&!$jscomp.FORCE_POLYFILL_PROMISE)return f;b.prototype.asyncExecute=function(b){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(b)};var l=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(b){l(b,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];b[a]=null;try{c()}catch(e){this.asyncThrow_(e)}}}this.batch_=null};b.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var m=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(c){a.reject(c)}};m.prototype.createResolveAndReject_=function(){function b(e){return function(d){c||(c=!0,e.call(a,d))}}var a=this,c=!1;
return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};m.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof m)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};m.prototype.resolveToNonPromiseObj_=function(b){var a=void 0;try{a=b.then}catch(c){this.reject_(c);return}"function"==typeof a?
this.settleSameAsThenable_(a,b):this.fulfill_(b)};m.prototype.reject_=function(b){this.settle_(2,b)};m.prototype.fulfill_=function(b){this.settle_(1,b)};m.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};m.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)t.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var t=new b;m.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};m.prototype.settleSameAsThenable_=function(b,a){var c=this.createResolveAndReject_();try{b.call(a,c.resolve,c.reject)}catch(e){c.reject(e)}};m.prototype.then=function(b,a){function c(a,c){return"function"==typeof a?function(c){try{e(a(c))}catch(p){d(p)}}:c}var e,d,h=new m(function(a,c){e=a;d=c});this.callWhenSettled_(c(b,e),c(a,d));return h};
m.prototype.catch=function(b){return this.then(void 0,b)};m.prototype.callWhenSettled_=function(b,a){function c(){switch(e.state_){case 1:b(e.result_);break;case 2:a(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?t.asyncExecute(c):this.onSettledCallbacks_.push(c)};m.resolve=n;m.reject=function(b){return new m(function(a,c){c(b)})};m.race=function(b){return new m(function(a,c){for(var e=$jscomp.makeIterator(b),d=e.next();!d.done;d=e.next())n(d.value).callWhenSettled_(a,
c)})};m.all=function(b){var a=$jscomp.makeIterator(b),c=a.next();return c.done?n([]):new m(function(b,d){function e(a){return function(c){g[a]=c;k--;0==k&&b(g)}}var g=[],k=0;do g.push(void 0),k++,n(c.value).callWhenSettled_(e(g.length-1),d),c=a.next();while(!c.done)})};return m},"es6","es3");$jscomp.polyfill("Number.isFinite",function(f){return f?f:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}},"es6","es3");
$jscomp.polyfill("Number.isInteger",function(f){return f?f:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}},"es6","es3");
JSROOT.define("d3 jquery painter hierarchy jquery-ui jqueryui-mousewheel jqueryui-touch-punch".split(" "),function(f,b,n){JSROOT.loadScript("$$$style/jquery-ui");"undefined"===typeof jQuery&&(globalThis.jQuery=b);var l=JSROOT.BrowserLayout;l.prototype.setBrowserTitle=function(a){var c=f.select("#"+this.gui_div+" .jsroot_browser");c.empty()||c.select(".jsroot_browser_title").text(a)};l.prototype.toggleBrowserKind=function(a){if(this.gui_div){if(!a){if(!this.browser_kind)return;a="float"===this.browser_kind?
"fix":"float"}var c=f.select("#"+this.gui_div+" .jsroot_browser"),e=b(c.node()).find(".jsroot_browser_area"),d=this;"float"===this.browser_kind?e.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",!1).resizable("destroy").draggable("destroy"):"fix"===this.browser_kind&&(c.select(".jsroot_v_separator").remove(),e.css("left","0px"),f.select("#"+this.gui_div+"_drawing").style("left","0px"),c.select(".jsroot_h_separator").style("left","0px"),f.select("#"+
this.gui_div+"_status").style("left","0px"),d.checkResize());this.browser_kind=a;this.browser_visible=!0;"float"===a?(e.css("bottom","40px").toggleClass("jsroot_float_browser",!0).resizable({containment:"parent",minWidth:100,resize:function(){d.setButtonsPosition()},stop:function(a,c){7>b(this).parent().innerHeight()-c.position.top-c.size.height&&b(this).css("height","").css("bottom",0)}}).draggable({containment:"parent",handle:b("#"+this.gui_div).find(".jsroot_browser_title"),snap:!0,snapMode:"inner",
snapTolerance:10,drag:function(){d.setButtonsPosition()},stop:function(){7>b(this).parent().innerHeight()-b(this).offset().top-b(this).outerHeight()&&b(this).css("height","").css("bottom",0)}}),this.adjustBrowserSize()):(e.css("left",0).css("top",0).css("bottom",0).css("height",""),a=c.append("div").classed("jsroot_separator",!0).classed("jsroot_v_separator",!0).style("position","absolute").style("top",0).style("bottom",0),b(a.node()).draggable({axis:"x",cursor:"ew-resize",containment:"parent",helper:function(){return b(this).clone().css("background-color",
"grey")},drag:function(a,c){d.setButtonsPosition();d.adjustSeparators(c.position.left,null)},stop:function(){d.checkResize()}}),this.adjustSeparators(250,null,!0,!0));this.setButtonsPosition()}};l.prototype.setButtonsPosition=function(){if(this.gui_div){var a=b("#"+this.gui_div+" .jsroot_browser"),c=a.find(".jsroot_browser_btns"),e=7,d=7;if(c.length){if(this.browser_visible){d=a.find(".jsroot_browser_area");a=a.offset();var h=d.offset();e=h.top-a.top+7;d=h.left-a.left+d.innerWidth()-27}c.css("left",
d+"px").css("top",e+"px")}}};l.prototype.adjustBrowserSize=function(a){if(this.gui_div&&"float"===this.browser_kind){var c=b("#"+this.gui_div+" .jsroot_browser");if(c.length){var e=c.find(".jsroot_browser_area"),d=c.find(".jsroot_browser_hierarchy");c=d.children(":first");a?e.parent().innerHeight()-10<e.innerHeight()&&e.css("bottom","0px").css("top","0px"):c.length&&(a=d.innerHeight(),c=c.innerHeight(),void 0!==c&&c<.7*a&&e.css("bottom",""))}}};l.prototype.toggleBrowserVisisbility=function(a){var c=
this;if(this.gui_div&&"string"!==typeof this.browser_visible){var e=f.select("#"+this.gui_div+" .jsroot_browser"),d=e.select(".jsroot_browser_area");if(!d.empty()){var h=e.select(".jsroot_v_separator"),g=f.select("#"+this.gui_div+"_drawing"),k=d.property("last_left"),r=d.property("last_vsepar"),p=d.property("last_drawing");if(this.browser_visible)d.property("last_left",d.style("left")),h.empty()||(d.property("last_vsepar",h.style("left")),d.property("last_drawing",g.style("left"))),k=(-b(d.node()).outerWidth(!0)-
10).toString()+"px",r=b(e.node()).outerWidth(!0),h.empty()&&b(d.node()).offset().left>r/2&&(k=r+10+"px"),r="-10px",p="0px";else{if(a)return;d.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}var q=!this.browser_visible,u=a?0:700;this.browser_visible="changing";d.transition().style("left",k).duration(u).on("end",function(){a||(c.browser_visible=q)&&c.setButtonsPosition()});q||e.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(u);
h.empty()||(h.transition().style("left",r).duration(u),g.transition().style("left",p).duration(u).on("end",this.checkResize.bind(this)));this.status_layout&&"fix"==this.browser_kind&&(e.select(".jsroot_h_separator").transition().style("left",p).duration(u),e.select(".jsroot_status_area").transition().style("left",p).duration(u))}}};l.prototype.toggleKind=function(a){"changing"!==this.browser_visible&&(a===this.browser_kind?this.toggleBrowserVisisbility():this.toggleBrowserKind(a))};l.prototype.deleteContent=
function(){var a=f.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()){this.createStatusLine(0,"delete");var c=a.select(".jsroot_v_separator");c.empty()||b(c.node()).draggable("destroy");this.toggleBrowserVisisbility(!0);a.selectAll("*").remove();delete this.browser_visible;delete this.browser_kind;this.checkResize()}};l.prototype.createStatusLine=function(a,c){var e=f.select("#"+this.gui_div+" .jsroot_browser");if(e.empty())return Promise.resolve("");var d=this.gui_div+"_status",h=f.select("#"+
d),g=!h.empty();"toggle"===c?c=!g:"delete"===c?(c=!1,a=0,delete this.status_layout):void 0===c&&(c=!0,this.status_layout="app");if(g){if(!0===c)return Promise.resolve(d);d=e.select(".jsroot_h_separator");b(d.node()).draggable("destroy");d.remove();h.remove();"app"!==this.status_layout&&delete this.status_layout;this.status_handler&&n.showStatus===this.status_handler&&(delete n.showStatus,delete this.status_handler);this.adjustSeparators(null,0,!0);return Promise.resolve("")}if(!1===c)return Promise.resolve("");
h=f.select("#"+this.gui_div+"_drawing").style("left");e.insert("div",".jsroot_browser_area").attr("id",d).classed("jsroot_status_area",!0).style("position","absolute").style("left",h).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);e=e.insert("div",".jsroot_browser_area").classed("jsroot_separator",!0).classed("jsroot_h_separator",!0).style("position","absolute").style("left",h).style("right",0).style("bottom","20px").style("height","5px");var k=this;
b(e.node()).draggable({axis:"y",cursor:"ns-resize",containment:"parent",helper:function(){return b(this).clone().css("background-color","grey")},drag:function(a,c){k.adjustSeparators(null,-c.position.top)},stop:function(){k.checkResize()}});a&&"string"!==typeof a||(a=this.last_hsepar_height||20);this.adjustSeparators(null,a,!0);if("app"==this.status_layout)return Promise.resolve(d);this.status_layout=new JSROOT.GridDisplay(d,"horizx4_1213");a=["object name","object title","mouse coordinates","object info"];
for(e=0;4>e;++e)f.select(this.status_layout.getGridFrame(e)).attr("title",a[e]).style("overflow","hidden").append("label").attr("class","jsroot_status_label");this.status_handler=this.showStatus.bind(this);n.showStatus=this.status_handler;return Promise.resolve(d)};l.prototype.adjustSeparators=function(a,c,e,d){if(this.gui_div){var h=f.select("#"+this.gui_div+" .jsroot_browser");null===c&&d&&!h.select(".jsroot_h_separator").empty()&&(c=h.select(".jsroot_h_separator").style("bottom"),c="string"==typeof c&&
2<c.length&&c.indexOf("px")==c.length-2?c.substr(0,c.length-2):null);if(null!==c){c=parseInt(c);d=h.select(".jsroot_h_separator");var g=0;d.empty()||(0>c&&(c+=b(h.node()).outerHeight(!0)-5),5>c&&(c=5),this.last_hsepar_height=c,d.style("bottom",c+"px").style("height","5px"),f.select("#"+this.gui_div+"_status").style("height",c+"px"),g=c+5+"px");f.select("#"+this.gui_div+"_drawing").style("bottom",g)}null!==a&&(a=parseInt(a),50>a&&(a=50),h.select(".jsroot_browser_area").style("width",a-5+"px"),f.select("#"+
this.gui_div+"_drawing").style("left",a+5+"px"),h.select(".jsroot_h_separator").style("left",a+5+"px"),f.select("#"+this.gui_div+"_status").style("left",a+5+"px"),h.select(".jsroot_v_separator").style("left",a+"px").style("width","5px"));e&&this.checkResize()}};l.prototype.showStatus=function(a,c,e,d){if(this.status_layout&&(b(this.status_layout.getGridFrame(0)).children("label").text(a||""),b(this.status_layout.getGridFrame(1)).children("label").text(c||""),b(this.status_layout.getGridFrame(2)).children("label").text(d||
""),b(this.status_layout.getGridFrame(3)).children("label").text(e||""),!this.status_layout.first_check)){this.status_layout.first_check=!0;for(c=a=0;4>c;++c)a=Math.max(a,b(this.status_layout.getGridFrame(c)).children("label").outerHeight());5<a&&(a>this.last_hsepar_height||a<this.last_hsepar_height+5)&&this.adjustSeparators(null,a,!0)}};l=JSROOT.HierarchyPainter;l.prototype.isLastSibling=function(a){if(!a||!a._parent||!a._parent._childs)return!1;var c=a._parent._childs;a=c.indexOf(a);if(0>a)return!1;
for(;++a<c.length;)if(!("_hidden"in c[a]))return!1;return!0};l.prototype.addItemHtml=function(a,c,b){if(!a||"_hidden"in a)return!0;var d=a===this.h,e="_childs"in a,g=n.getDrawHandle(a._kind),k="",f="",p=!1,q=!1,u=this.itemFullName(a);null!==g&&("icon"in g&&(k=g.icon),"icon2"in g&&(f=g.icon2),0==k.length&&"function"==typeof g.icon_get&&(k=g.icon_get(a,this)),"func"in g||"execute"in g||"aslink"in g||"expand"in g&&!1!==a._more)&&(p=!0);"_icon"in a&&(k=a._icon);"_icon2"in a&&(f=a._icon2);0==k.length&&
"_online"in a&&(a._icon=k="img_globe");0==k.length&&d&&(a._icon=k="img_base");if(a._more||a._expand||a._player||a._can_draw)p=!0;var l=p;l||"string"!=typeof a._kind||0!=a._kind.indexOf("ROOT.")||(l=p=!0);0==f.length&&(f=k);0==k.length&&(k=e||a._more?"img_folder":"img_page");0==f.length&&(f=e||a._more?"img_folderopen":"img_page");"update"===b?c.selectAll("*").remove():(c=c.append("div"),b&&b>=(a._parent._show_limit||JSROOT.settings.HierarchyLimit)&&(q=!0));a._d3cont=c.node();c.attr("item",u);for(var m=
c.append("div").attr("class","h_line"),x=d?null:a._parent;x&&x!==this.h;)m.insert("div",":first-child").attr("class",this.isLastSibling(x)?"img_empty":"img_line"),x=x._parent;var w="";x=!1;d||(e&&!q?(w=a._isopen?"img_minus":"img_plus",x=!0):w="img_join");var v=this;if(0<w.length){if(q||this.isLastSibling(a))w+="bottom";w=m.append("div").attr("class",w);if(x)w.style("cursor","pointer").on("click",function(a){v.tree_click(a,this,"plusminus")})}if(this.with_icons&&!q&&(k=a._isopen?f:k,k=0==k.indexOf("img_")?
m.append("div").attr("class",k).attr("title",a._kind):m.append("img").attr("src",k).attr("alt","").attr("title",a._kind).style("vertical-align","top").style("width","18px").style("height","18px"),"_icon_click"in a||g&&"icon_click"in g))k.on("click",function(a){v.tree_click(a,this,"icon")});g=m.append("a");if(p||e||q)g.attr("class","h_item").on("click",function(a){v.tree_click(a,this)});if(q)return a._break_point=!0,g.attr("title","there are "+(a._parent._childs.length-b)+" more items").text("...more..."),
!1;if("disp_kind"in v){JSROOT.settings.DragAndDrop&&p&&this.enableDrag(g.node(),u);if(JSROOT.settings.ContextMenu&&l)g.on("contextmenu",function(a){v.tree_contextmenu(a,this)});g.on("mouseover",function(){v.tree_mouseover(!0,this)}).on("mouseleave",function(){v.tree_mouseover(!1,this)})}else if(a._direct_context&&JSROOT.settings.ContextMenu)g.on("contextmenu",function(a){v.direct_contextmenu(a,this)});b=a._name;p="";"_realname"in a&&(b=a._realname);"_title"in a&&(p=a._title);"_fullname"in a&&(p+=
"  fullname: "+a._fullname);p||(p=b);g.attr("title",p).text(b+("_value"in a?":":"")).style("background",a._background?a._background:null);"_value"in a&&(m=m.append("p"),"_vclass"in a&&m.attr("class",a._vclass),a._isopen||m.html(a._value));if(e&&(d||a._isopen))for(d=c.append("div").attr("class","h_childs"),e=0;e<a._childs.length&&(c=a._childs[e],c._parent=a,this.addItemHtml(c,d,e));++e);return!0};l.prototype.toggleOpenState=function(a,c){var b=c||this.h;if(void 0===b._childs){if(!a||this.with_icons&&
!b._more&&!b._expand&&!this.canExpandItem(b))return!1;this.expandItem(this.itemFullName(b));void 0!==b._childs&&(b._isopen=!0);return b._isopen}if(b!==this.h&&a&&!b._isopen)return b._isopen=!0;for(var d=!1,h=0;h<b._childs.length;++h)this.toggleOpenState(a,b._childs[h])&&(d=!0);if(b!==this.h&&!a&&b._isopen&&!d)return delete b._isopen,!0;c||this.refreshHtml();return!1};l.prototype.refreshHtml=function(){var a=this,c=this.selectDom();if(c.empty())return Promise.resolve(this);c.html("").style("overflow",
"hidden").style("display","flex").style("flex-direction","column");var b=this,d=[],h=null;this.forEachItem(function(a){delete a._d3cont;"_fastcmd"in a&&"Command"==a._kind&&d.push(a);"_status"in a&&!h&&(h=a)});if(!this.h||c.empty())return Promise.resolve(this);if(d.length)for(var g=c.append("div").attr("class","jsroot"),k=0;k<d.length;++k){var r=g.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(d[k])).attr("title",d[k]._title).on("click",function(){b.executeCommand(f.select(this).attr("item"),
this)});"_icon"in d[k]&&r.append("img").attr("src",d[k]._icon)}g=c.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);g.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",function(){return a.toggleOpenState(!0)});g.append("text").text(" | ");g.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",function(){return a.toggleOpenState(!1)});"function"==
typeof this.removeInspector&&(g.append("text").text(" | "),g.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",function(){return a.removeInspector()}));"_online"in this.h&&(g.append("text").text(" | "),g.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",function(){return a.reload()}));"disp_kind"in this&&(g.append("text").text(" | "),g.append("a").attr("class","h_button").text("clear").attr("title",
"clear all drawn objects").on("click",function(){return a.clearHierarchy(!1)}));c=c.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");this.background&&c.style("background-color",this.background).style("margin","2px").style("padding","2px");this.addItemHtml(this.h,c.append("div").attr("class","h_tree"));this.setTopPainter();if(h&&!this.status_disabled&&!JSROOT.decodeUrl().has("nostatus")){var p=JSROOT.findFunction(h._status);
if("function"==typeof p)return this.createStatusLine().then(function(c){c&&p(c,a.itemFullName(h))})}return Promise.resolve(this)};l.prototype.updateTreeNode=function(a,c){if(void 0===c||c.empty()){c=f.select(a._d3cont?a._d3cont:null);var b=this.itemFullName(a);c.empty()&&(c=this.selectDom().select("[item='"+b+"']"));c.empty()&&"_cycle"in a&&(c=this.selectDom().select("[item='"+b+";"+a._cycle+"']"));if(c.empty())return}this.addItemHtml(a,c,"update");this.brlayout&&this.brlayout.adjustBrowserSize(!0)};
l.prototype.updateBackground=function(a,c){if(a&&a._d3cont){var b=f.select(a._d3cont);b.empty()||(b=b.select(".h_item"),b.style("background",a._background?a._background:null),c&&a._background&&b.node().scrollIntoView(!1))}};l.prototype.tree_click=function(a,c,b){if(c){var d=f.select(c.parentNode.parentNode),e=d.attr("item"),g=e?this.findItem(e):null;if(g)if(g._break_point){delete g._break_point;this.addItemHtml(g,d,"update");e=g._parent;g=e._childs.indexOf(g);d=f.select(d.node().parentNode);if(0>
g)return console.error("internal error");e._show_limit=2*(e._show_limit||JSROOT.settings.HierarchyLimit);for(g+=1;g<e._childs.length;++g){var k=e._childs[g];k._parent=e;if(!this.addItemHtml(k,d,g))break}}else{k=g;for(var r=void 0;k&&void 0===(r=k._click_action);)k=k._parent;b&&""!=b||(b="item");var p=n.getDrawSettings(g._kind);k=p.handle;if("icon"==b)e=null,"function"==typeof g._icon_click?e=g._icon_click:k&&"function"==typeof k.icon_click&&(e=k.icon_click),e&&e(g,this)&&this.updateTreeNode(g,d);
else{"item"==b&&"_expand"in g&&!a.ctrlKey&&!a.shiftKey&&(b="plusminus");if("plusminus"==b&&!("_childs"in g)&&g._more||"item"==b&&"expand"===r)return this.expandItem(e,d);if("item"==b){if("_player"in g)return this.player(e);if(k&&k.aslink)return window.open(e+"/");if(k&&k.execute)return this.executeCommand(e,c.parentNode);if(k&&k.ignore_online&&this.isOnlineItem(g))return;c=g._can_draw;b=g._more;r="expand"===this.default_by_click;var q="";a.shiftKey&&(q=k&&k.shift?k.shift:"inspect","inspect"===q&&
k&&k.noinspect&&(q=""));k&&k.ctrl&&a.ctrlKey&&(q=k.ctrl);if(!q)for(a=g._parent;a;a=a._parent)if(a._painter){c=!1;void 0===b&&(b=!1);break}g._childs&&(b=!1);void 0===c&&(c=p.draw);void 0===b&&(b=p.expand);c&&b&&!q&&(r||k&&"expand"===k.dflt||this.isItemDisplayed(e))&&(c=!1);if(c)return this.display(e,q);if(b||r)return this.expandItem(e,d);if("string"===typeof g._kind&&0===g._kind.indexOf("ROOT.")&&p.inspect&&!1!==c)return this.display(e,"inspect");if(!g._childs||g===this.h)return}g._isopen?delete g._isopen:
g._isopen=!0;this.updateTreeNode(g,d)}}}};l.prototype.tree_mouseover=function(a,b){b=f.select(b.parentNode.parentNode).attr("item");var c=this.findItem(b);if(c){for(var d,h=c;h&&!d;)d=h._painter,h=h._parent;d&&"function"===typeof d.mouseOverHierarchy&&d.mouseOverHierarchy(a,b,c)}};l.prototype.direct_contextmenu=function(a,b){var c=this;a.preventDefault();var d=f.select(b.parentNode.parentNode).attr("item"),h=this.findItem(d);h&&"function"==typeof this.fill_context&&n.createMenu(a,this).then(function(a){c.fill_context(a,
h);0<a.size()&&(a.tree_node=b.parentNode,a.show())})};l.prototype.tree_contextmenu=function(a,b){function c(a){var b=document.createElement("div");b.innerHTML='<a href="'+a.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")+'">x</a>';return b.firstChild.href}var d=this;a.preventDefault();var h=f.select(b.parentNode.parentNode).attr("item"),g=this.findItem(h);if(g){var k=this.getOnlineProp(h),r=this.getFileProp(h);n.createMenu(a,this).then(function(a){if(""!=h||"_jsonfile"in
g)if(k)d.fillOnlineMenu(a,k,h);else{var e=n.getDrawSettings(g._kind,"nosame");g._can_draw&&(e.opts||(e.opts=[""]),0>e.opts.indexOf("")&&e.opts.unshift(""));e.opts&&a.addDrawMenu("Draw",e.opts,function(a){return d.display(h,a)});if(r&&e.opts&&!r.localfile){var f=c(r.fileurl);0==f.indexOf(JSROOT.source_dir)&&(f=f.slice(JSROOT.source_dir.length));f=r.kind+"="+f;if(0<r.itemname.length){var p=r.itemname;0<=p.search(/\+| |,/)&&(p="'"+p+"'");f+="&item="+p}a.addDrawMenu("Draw in new tab",e.opts,function(a){window.open(JSROOT.source_dir+
"index.htm?nobrowser&"+f+"&opt="+a)})}!e.expand||"_childs"in g||!g._more&&"_more"in g||a.add("Expand",function(){return d.expandItem(h)});"ROOT.TStyle"===g._kind&&a.add("Apply",function(){return d.applyStyle(h)})}else{var m=[],l="",w=0;e=function(){return 0<w++?"&":"?"};d.forEachRootFile(function(a){return m.push(a._file.fFullURL)});d.getTopOnlineItem()||(l=JSROOT.source_dir+"index.htm");d.isMonitoring()&&(l+=e()+"monitoring="+d.getMonitoringInterval());1==m.length?l+=e()+"file="+m[0]:1<m.length&&
(l+=e()+"files="+JSON.stringify(m));d.disp_kind&&(l+=e()+"layout="+d.disp_kind.replace(/ /g,""));var v=[];d.disp&&d.disp.forEachPainter(function(a){a.getItemName()&&v.push(a.getItemName())});1==v.length?l+=e()+"item="+v[0]:1<v.length&&(l+=e()+"items="+JSON.stringify(v));a.add("Direct link",function(){return window.open(l)});a.add("Only items",function(){return window.open(l+"&nobrowser")})}"function"==typeof g._menu&&g._menu(a,g,d);0<a.size()&&(a.tree_node=b.parentNode,a.separ&&a.add("separator"),
a.add("Close"),a.show())});return!1}};l.prototype.commandArgsDialog=function(a,c){var e=document.getElementById("jsroot_cmdargs_dialog");e&&e.parentNode.removeChild(e);e="";for(var d=0;d<c.length;++d)e+='<label for="jsroot_cmdargs_dialog_inp'+d+'">arg'+(d+1)+'</label>\n                    <input type="text" tabindex="0" name="jsroot_cmdargs_dialog_inp'+d+'" id="jsroot_cmdargs_dialog_inp'+d+'" value="'+c[d]+'" style="width:100%;display:block" class="text ui-widget-content ui-corner-all"/>';b(document.body).append('<div id="jsroot_cmdargs_dialog">\n           <form>\n             <fieldset style="padding:0; border:0">\n                '+
e+'\n                <input type="submit" tabindex="-1" style="position:absolute; top:-1000px; display:block"/>\n            </fieldset>\n           </form>\n         </div>');return new Promise(function(d){var e,h=function(){e="";for(var a=0;a<c.length;++a){var g=b("#jsroot_cmdargs_dialog_inp"+a).val();e+=0<a?"&":"?";e+="arg"+(a+1)+"="+g}f.dialog("close");d(e)};var f=b("#jsroot_cmdargs_dialog").dialog({height:110+60*c.length,width:400,modal:!0,resizable:!0,title:"Arguments for command "+a,buttons:{Ok:h,
Cancel:function(){f.dialog("close");d(!1)}},close:function(){f.remove();e||d(!1)}});f.find("form").on("submit",function(a){a.preventDefault();h()})})};l.prototype.createDisplay=function(){if("disp"in this){if(0<this.disp.numDraw())return Promise.resolve(this.disp);this.disp.cleanup();delete this.disp}if(!document.getElementById(this.disp_frameid))return Promise.resolve(null);"tabs"==this.disp_kind?this.disp=new t(this.disp_frameid):0==this.disp_kind.indexOf("flex")?this.disp=new y(this.disp_frameid):
0==this.disp_kind.indexOf("coll")?this.disp=new m(this.disp_frameid):this.disp=new JSROOT.GridDisplay(this.disp_frameid,this.disp_kind);this.disp&&(this.disp.cleanupFrame=this.cleanupFrame.bind(this));return Promise.resolve(this.disp)};l.prototype.enableDrag=function(a){b(a).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};l.prototype.enableDrop=function(a,c){var e=this;b(a).droppable({hoverClass:"ui-state-active",accept:function(a){a=a.parent().parent().attr("item");return a!=c&&a?(a=
e.findItem(a))&&"_kind"in a?0==a._kind.indexOf("ROOT."):!1:!1},drop:function(a,c){(a=c.draggable.parent().parent().attr("item"))&&e.dropItem(a,b(this).attr("id"))}})};l.prototype.createBrowser=function(a,c){var e=this;if(!this.gui_div||this.exclude_browser||!this.brlayout)return Promise.resolve(!1);var d=f.select("#"+this.gui_div+" .jsroot_browser"),h=b(d.node());if(d.empty())return Promise.resolve(!1);"float"===a&&this.float_browser_disabled&&(a="fix");if(!d.select(".jsroot_browser_area").empty())return c&&
this.brlayout.toggleKind(a),Promise.resolve(!0);var g="<p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+JSROOT.version+"</b></span></p>";if(this.is_online)g+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:inline-block;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';
else if(this.no_select)"file"==this.no_select&&(g+='<div style="display:flex;flex-direction:row">');else{var k=f.select("#"+this.gui_div),l=k.attr("files")||"../files/hsimple.root",m=JSROOT.decodeUrl().get("path")||k.attr("path")||"";k=l.split(";");g+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';
k.forEach(function(a){g+='<option value = "'+m+a+'">'+a+"</option>"});g+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}if(this.is_online||
!this.no_select||"file"==this.no_select)g+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>';g+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';this.brlayout.setBrowserContent(g);this.brlayout.setBrowserTitle(this.is_online?"ROOT online server":"Read a ROOT file");var q=null;this.is_online||this.no_select||(this.ReadSelectedFile=function(){var a=d.select(".gui_urlToLoad").property("value").trim();a&&(a.toLowerCase().lastIndexOf(".json")==
a.length-5?this.openJsonFile(a):this.openRootFile(a))},h.find(".gui_selectFileName").val("").change(function(){h.find(".gui_urlToLoad").val(b(this).val())}),h.find(".gui_fileBtn").button().click(function(){return h.find(".gui_localFile").click()}),h.find(".gui_ReadFileBtn").button().click(function(){return e.ReadSelectedFile()}),h.find(".gui_ResetUIBtn").button().click(function(){return e.clearHierarchy(!0)}),h.find(".gui_urlToLoad").keyup(function(a){13==a.keyCode&&e.ReadSelectedFile()}),h.find(".gui_localFile").change(function(a){a=
a.target.files;for(var b=0;b<a.length;++b){var c=a[b];d.select(".gui_urlToLoad").property("value",c.name);e.openRootFile(c).then(q)}q=null}),this.selectLocalFile=function(){var a=this;return new Promise(function(c){q=c;b("#"+a.gui_div+" .jsroot_browser").find(".gui_localFile").click()})});k=h.find(".gui_layout");if(k.length){l="simple;vert2;vert3;vert231;horiz2;horiz32;flex;grid 2x2;grid 1x3;grid 2x3;grid 3x3;grid 4x4;collapsible;tabs".split(";");for(var u=0;u<l.length;++u){var n=document.createElement("option");
n.value=l[u];n.innerHTML=l[u];k.get(0).appendChild(n)}var t=this;k.change(function(){t.setDisplay(b(this).val()||"collapsible",t.gui_div+"_drawing")})}this.setDom(this.gui_div+"_browser_hierarchy");c&&(this.refreshHtml(),this.initializeBrowser());this.brlayout.toggleBrowserKind(a||"fix");return Promise.resolve(!0)};l.prototype.initializeBrowser=function(){var a=f.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()&&this.brlayout){var c=b(a.node());this.brlayout&&this.brlayout.adjustBrowserSize();
if(a=a.select(".gui_layout").node()){var e=!1;for(h in a.options){var d=a.options[h].text;if("string"===typeof d&&(d==this.getLayout()||d.replace(/ /g,"")==this.getLayout())){a.selectedIndex=h;e=!0;break}}if(!e){var h=document.createElement("option");h.innerHTML=h.value=this.getLayout();a.appendChild(h);a.selectedIndex=a.options.length-1}}if(this.is_online){this.h&&this.h._toptitle&&this.brlayout.setBrowserTitle(this.h._toptitle);var g=this;c.find(".gui_monitoring").prop("checked",this.isMonitoring()).click(function(){g.enableMonitoring(this.checked);
g.updateItems()})}else if(!this.no_select){var k="";this.forEachRootFile(function(a){k||(k=a._fullurl)});c.find(".gui_urlToLoad").val(k)}}};l.prototype.enableMonitoring=function(a){this.setMonitoring(void 0,a);var b=f.select("#"+this.gui_div+" .jsroot_browser .gui_monitoring");b.empty()||b.property("checked")===a||b.property("checked",a)};JSROOT.buildGUI=function(a,b){var c="string"==typeof a?f.select("#"+a):f.select(a);if(c.empty())return alert("no div for gui found");var d=!1;"online"==b&&(d=!0);
"true"===c.attr("ignoreurl")&&(JSROOT.settings.IgnoreUrlOptions=!0);if(JSROOT.decodeUrl().has("nobrowser")||c.attr("nobrowser")&&"false"!==c.attr("nobrowser")||"draw"==b||"nobrowser"==b)return JSROOT.buildNobrowserGUI(a,b);n.readStyleFromURL();var h=new JSROOT.HierarchyPainter("root",null);h.is_online=d;return h.startGUI(c).then(function(){h.initializeBrowser();return h})};var m=function(a){a=JSROOT.MDIDisplay.call(this,a)||this;a.cnt=0;return a};$jscomp.inherits(m,JSROOT.MDIDisplay);m.prototype.forEachFrame=
function(a,c){var e=this.frameid+"_collapsible";document.getElementById(e)&&"function"==typeof a&&b("#"+e+" .collapsible_draw").each(function(){c&&b(this).is(":hidden")||a(b(this).get(0))})};m.prototype.getActiveFrame=function(){var a=JSROOT.MDIDisplay.prototype.getActiveFrame.call(this);if(a&&!b(a).is(":hidden"))return a;a=null;this.forEachFrame(function(b){a||(a=b)},!0);return a};m.prototype.activateFrame=function(a){b(a).is(":hidden")&&b(a).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0);
b(a).prev()[0].scrollIntoView();this.active_frame_title=f.select(a).attr("frame_title")};m.prototype.createFrame=function(a){this.beforeCreateFrame(a);var c=this.frameid+"_collapsible";document.getElementById(c)||b("#"+this.frameid).append('<div id="'+c+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>');var e=this,d=c+"_sub"+this.cnt++,h=d+"h",g='<h5 id="'+h+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+
a+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+d+"'></div>\n";b("#"+c).append(g);b("#"+h).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){b(this).toggleClass("ui-state-hover")}).click(function(){b(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
var a=b(this).next(),c=a.is(":hidden");a.css("display",c?"none":"");c||JSROOT.resize(a.get(0))}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();b("#"+h).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){e.cleanupFrame(b(this).parent().next().attr("id"));b(this).parent().next().remove();b(this).parent().remove()});b("#"+h).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
return b("#"+d).attr("frame_title",a).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};var t=function(a){a=JSROOT.MDIDisplay.call(this,a)||this;a.cnt=0;return a};$jscomp.inherits(t,JSROOT.MDIDisplay);t.prototype.forEachFrame=function(a,c){var e=this.frameid+"_tabs";if(document.getElementById(e)&&"function"==typeof a){var d=-1,h=b("#"+e).tabs("option","active");b("#"+e+"> .tabs_draw").each(function(){d++;c&&d!=h||a(b(this).get(0))})}};t.prototype.getActiveFrame=
function(){var a=null;this.forEachFrame(function(b){a||(a=b)},!0);return a};t.prototype.activateFrame=function(a){var c=0,e=-1;this.forEachFrame(function(d){b(d).attr("id")==b(a).attr("id")&&(e=c);c++});b("#"+this.frameid+"_tabs").tabs("option","active",e);this.active_frame_title=f.select(a).attr("frame_title")};t.prototype.createFrame=function(a){this.beforeCreateFrame(a);var c=this,e=this.frameid+"_tabs",d=e+"_sub"+this.cnt++,h='<li><a href="#'+d+'">'+a+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',
g='<div class="tabs_draw" id="'+d+'"></div>';if(document.getElementById(e))b("#"+e).find("> .ui-tabs-nav").append(h),b("#"+e).append(g),b("#"+e).tabs("refresh"),b("#"+e).tabs("option","active",-1);else{b("#"+this.frameid).append('<div id="'+e+'" class="jsroot"> <ul>'+h+" </ul>"+g+"</div>");var f=b("#"+e).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(a,c){b(c.newPanel).css("overflow","hidden");JSROOT.resize(b(c.newPanel).get(0))}});f.delegate("span.ui-icon-close","click",function(){var a=
b(this).closest("li").remove().attr("aria-controls");c.cleanupFrame(a);b("#"+a).remove();f.tabs("refresh");0==b("#"+e+"> .tabs_draw").length&&b("#"+e).remove()})}b("#"+d).empty().css("overflow","hidden").attr("frame_title",a);return b("#"+d).get(0)};t.prototype.checkMDIResize=function(a,c){b("#"+this.frameid+"_tabs").tabs("refresh");JSROOT.MDIDisplay.prototype.checkMDIResize.call(this,a,c)};var y=function(a){a=JSROOT.MDIDisplay.call(this,a)||this;a.cnt=0;return a};$jscomp.inherits(y,JSROOT.MDIDisplay);
y.prototype.forEachFrame=function(a,c){var e=this.frameid+"_flex";document.getElementById(e)&&"function"==typeof a&&b("#"+e+" .flex_draw").each(function(){c&&b(this).is(":hidden")||a(b(this).get(0))})};y.prototype.getActiveFrame=function(){var a=JSROOT.MDIDisplay.prototype.getActiveFrame.call(this);if(a&&!b(a).is(":hidden"))return a;a=null;this.forEachFrame(function(b){a||(a=b)},!0);return a};y.prototype.createFrame=function(a){function c(a){var c;"first"===a?b("#"+d+" .flex_frame").each(function(){b(this).is(":hidden")||
"minimal"==b(this).prop("state")||(c=b(this))}):"object"==typeof a&&(c=a);c&&(c.appendTo(c.parent()),"minimal"!=c.prop("state")&&(a=c.find(".flex_draw").get(0),n.selectActivePad({pp:n.getElementCanvPainter(a),active:!0}),JSROOT.resize(a)))}function e(a,b){var d=a.prop("state");d||(d="normal");a.prop("state",b);if(b!=d){"normal"==d&&(a.prop("original_height",a.height()),a.prop("original_width",a.width()),a.prop("original_top",a.css("top")),a.prop("original_left",a.css("left")));a.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s",
"minimal"!=b).toggleClass("ui-icon-triangle-2-n-s","minimal"==b);a.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n","maximal"!=b).toggleClass("ui-icon-triangle-2-n-s","maximal"==b);switch(b){case "minimal":a.height(a.find(".flex_header").height()).width("auto");a.find(".flex_draw").css("display","none");a.find(".ui-resizable-handle").css("display","none");break;case "maximal":a.height("100%").width("100%").css("left","").css("top","");a.find(".flex_draw").css("display",
"");a.find(".ui-resizable-handle").css("display","none");break;default:a.find(".flex_draw").css("display",""),a.find(".ui-resizable-handle").css("display",""),a.height(a.prop("original_height")).width(a.prop("original_width")),"minimal"!=d&&a.css("left",a.prop("original_left")).css("top",a.prop("original_top"))}"minimal"!==b?c(a):c("first")}}this.beforeCreateFrame(a);var d=this.frameid+"_flex";document.getElementById(d)||b("#"+this.frameid).append('<div id="'+d+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>');
var h=this,g=b("#"+d),f=g.width(),l=g.height(),m=d+"_frame"+this.cnt;g.append('<div id="'+m+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+a+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+m+'_cont" class="flex_draw"></div></div>');b("#"+m).css("left",parseInt(this.cnt%5*f/10)).css("top",parseInt(this.cnt%5*l/
10)).width(Math.round(.58*f)).height(Math.round(.58*l)).resizable({helper:"jsroot-flex-resizable-helper",start:function(){c(b(this))},stop:function(a,c){a={width:c.size.width-1,height:c.size.height-b(this).find(".flex_header").height()-1};JSROOT.resize(b(this).find(".flex_draw").get(0),a)}}).draggable({containment:"parent",start:function(a){c(b(this));var d=b(this).find(".flex_draw");a=document.elementFromPoint(a.clientX,a.clientY);var e=!1;b(a).parents().each(function(){b(this).get(0)===d.get(0)&&
(e=!0)});if(e)return!1}}).click(function(){c(b(this))}).find(".flex_header").click(function(){c(b(this).parent())}).dblclick(function(){var a=b(this).parent();"normal"==a.prop("state")?e(a,"maximal"):e(a,"normal")}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){var a=b(this).parent().parent();h.cleanupFrame(a.find(".flex_draw").get(0));a.remove();c("first")}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},
text:!1}).click(function(){var a=b(this).parent().parent(),c=b(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");e(a,c?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).click(function(){var a=b(this).parent().parent(),c=b(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");e(a,c?"minimal":"normal")});b("#"+m).find(".ui-resizable-handle").css("z-index","");this.cnt++;return b("#"+m+"_cont").attr("frame_title",
a).get(0)};JSROOT.GridDisplay.prototype.createSeparator=function(a,c,e){c=b(c.append("div").node());c.toggleClass("jsroot_separator",!0).toggleClass(a.vertical?"jsroot_hline":"jsroot_vline",!0).prop("handle",a).attr("separator-id",e.id).css("position","absolute").css(a.vertical?"top":"left","calc("+e.position+"% - 2px)").css(a.vertical?"width":"height",(a.size||100)+"%").css(a.vertical?"height":"width","5px").css("cursor",a.vertical?"ns-resize":"ew-resize");c.on("changePosition",function(a,c){function d(a,
b){var c=e.vertical?"height":"width",d=e.groups[b].size+"%";a.children("[groupid='"+b+"']").css(c,d).children(".jsroot_separator").css(c,d)}var e=b(this).prop("handle");a=parseInt(b(this).attr("separator-id"));var h=e.groups[a].position;"restore"===c?h=e.groups[a].position0:c&&c.offset&&(h=e.vertical?Math.round((c.offset.top+2-b(this).parent().offset().top)/b(this).parent().innerHeight()*100):Math.round((c.offset.left+2-b(this).parent().offset().left)/b(this).parent().innerWidth()*100));var f=e.groups[a].position-
h;.3>Math.abs(f)||5>Math.min(e.groups[a-1].size-f,e.groups[a].size+f)||(e.groups[a-1].size-=f,e.groups[a].size+=f,e.groups[a].position=h,b(this).css(e.vertical?"top":"left","calc("+h+"% - 2px)"),d(b(this).parent(),a-1),d(b(this).parent(),a),"restore"===c&&(b(this).trigger("resizeGroup",a-1),b(this).trigger("resizeGroup",a)))});c.on("resizeGroup",function(a,c){a=b(this).parent().children("[groupid='"+c+"']");a.hasClass("jsroot_newgrid")||(a=a.find(".jsroot_newgrid"));a.each(function(){JSROOT.resize(b(this).get(0))})});
c.dblclick(function(){b(this).trigger("changePosition","restore")});c.draggable({axis:a.vertical?"y":"x",cursor:a.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return b(this).clone().css("background-color","grey")},start:function(){var a=b(this).prop("handle"),c=parseInt(b(this).attr("separator-id"));a.groups[c].startpos=a.groups[c].position},drag:function(a,c){b(this).trigger("changePosition",c)},stop:function(){var a=b(this).prop("handle"),c=parseInt(b(this).attr("separator-id"));
.5>Math.abs(a.groups[c].startpos-a.groups[c].position)||(b(this).trigger("resizeGroup",c-1),b(this).trigger("resizeGroup",c))}})};JSROOT.createTreePlayer=function(a){a.draw_first=!0;a.ConfigureOnline=function(a,b,d,f,g){this.setItemName(a,"",this);this.url=b;this.root_version=f;this.askey=d;this.dflt_expr=g};a.configureTree=function(a){this.local_tree=a};a.KeyUp=function(a){13==a.keyCode&&this.PerformDraw()};a.ShowExtraButtons=function(a){var c=this,d=b(this.selectDom().node());d.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");
var f=this.local_tree?this.local_tree.fEntries:0;d.find(".treedraw_cut").val(a&&a.parse_cut?a.parse_cut:"").keyup(this.keyup);d.find(".treedraw_opt").val(a&&a.drawopt?a.drawopt:"").keyup(this.keyup);d.find(".treedraw_number").val(a&&a.numentries?a.numentries:"").spinner({numberFormat:"n",min:0,page:1E3,max:f||0}).keyup(this.keyup);d.find(".treedraw_first").val(a&&a.firstentry?a.firstentry:"").spinner({numberFormat:"n",min:0,page:1E3,max:f||0}).keyup(this.keyup);d.find(".treedraw_clear").button().click(function(){return JSROOT.cleanup(c.drawid)})};
a.Show=function(a){var c=b(this.selectDom().node());this.drawid="jsroot_tree_player_"+JSROOT._.id_counter++ +"_draw";this.keyup=this.KeyUp.bind(this);var d=a&&(a.parse_cut||a.numentries||a.firstentry);c.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp treedraw_varexp_info ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> <label class='treedraw_varexp_info'>\u24d8</label>"+
(d?"":"<button class='treedraw_more'>More</button>")+"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");this.setTopPainter();var f=this;this.local_tree&&c.find(".treedraw_buttons").prop("title","Tree draw player for: "+this.local_tree.fName);c.find(".treedraw_exe").button().click(function(){return f.PerformDraw()});c.find(".treedraw_varexp").val(a&&a.parse_expr?a.parse_expr:this.dflt_expr||"px:py").keyup(this.keyup);c.find(".treedraw_varexp_info").prop("title","Example of valid draw expressions:\n  px  - 1-dim draw\n  px:py  - 2-dim draw\n  px:py:pz  - 3-dim draw\n  px+py:px-py - use any expressions\n  px:py>>Graph - create and draw TGraph\n  px:py>>dump - dump extracted variables\n  px:py>>h(50,-5,5,50,-5,5) - custom histogram\n  px:py;hbins:100 - custom number of bins");
d?this.ShowExtraButtons(a):c.find(".treedraw_more").button().click(function(){b(this).remove();f.ShowExtraButtons()});this.checkResize();n.registerForResize(this)};a.PerformLocalDraw=function(){var a=this;if(this.local_tree){var e=b(this.selectDom().node()),d={expr:e.find(".treedraw_varexp").val()};0==e.find(".treedraw_more").length&&(d.cut=e.find(".treedraw_cut").val(),d.cut||delete d.cut,d.drawopt=e.find(".treedraw_opt").val(),"dump"===d.drawopt&&(d.dump=!0,d.drawopt=""),d.drawopt||delete d.drawopt,
d.numentries=parseInt(e.find(".treedraw_number").val()),Number.isInteger(d.numentries)||delete d.numentries,d.firstentry=parseInt(e.find(".treedraw_first").val()),Number.isInteger(d.firstentry)||delete d.firstentry);d.drawopt&&JSROOT.cleanup(this.drawid);e=function(b){return JSROOT.redraw(a.drawid,b)};d.progress=e;this.local_tree.Draw(d).then(e)}};a.PerformDraw=function(){var a=this;if(this.local_tree)return this.PerformLocalDraw();var e=b(this.selectDom().node()),d=this.url+"/exe.json.gz?compact=3&method=Draw",
f=e.find(".treedraw_varexp").val(),g="h_tree_draw",k="",l=f.indexOf(">>");0>l?f+=">>"+g:(g=f.substr(l+2),"+"==g[0]&&(g=g.substr(1)),l=g.indexOf("("),0<l&&(g=g.substr(0,l)));if(0==e.find(".treedraw_more").length){l=e.find(".treedraw_cut").val();var m=e.find(".treedraw_number").val(),n=e.find(".treedraw_first").val();k=e.find(".treedraw_opt").val();d+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+f+'"&selection="'+l+'"';""==m&&(m=394499<=this.root_version?"TTree::kMaxEntries":
"1000000000");""==n&&(n="0");d+='&option="'+k+'"&nentries='+m+"&firstentry="+n}else d+='&prototype="Option_t*"&opt="'+f+'"';d+="&_ret_object_="+g;e=function(){JSROOT.httpRequest(d,"object").then(function(b){JSROOT.cleanup(a.drawid);JSROOT.draw(a.drawid,b,k)})};this.askey?(this.askey=!1,JSROOT.httpRequest(this.url+"/root.json","text").then(e)):e()};a.checkResize=function(){var a=b(this.selectDom().node());b("#"+this.drawid).width(a.width());var e=a.height(),d=a.find(".treedraw_buttons").outerHeight(!0);
a=a.find("hr").outerHeight(!0);b("#"+this.drawid).height(e-d-a-2);JSROOT.resize(this.drawid)};return a};JSROOT.drawTreePlayer=function(a,b,e,d){var c=a.findItem(b),g=a.getTopOnlineItem(c),k="",l=0;if(!c||!g)return null;if(d){for(k=c._name;c&&!c._ttree;)c=c._parent;if(!c)return null;b=a.itemFullName(c)}var m=a.getOnlineItemUrl(b);if(!m)return null;g=g._root_version?parseInt(g._root_version):396545;a=a.getDisplay();if(!a)return null;a=a.findFrame(b,!0);if(!a)return null;a=f.select(a).attr("id");a=new JSROOT.BasePainter(a);
if(c._childs&&!d)for(d=0;d<c._childs.length;++d){var n=c._childs[d];n&&n._kind&&0==n._kind.indexOf("ROOT.TLeaf")&&2>l&&(0<l++&&(k+=":"),k+=n._name)}JSROOT.createTreePlayer(a);a.ConfigureOnline(b,m,e,g,k);a.Show();return a};JSROOT.drawTreePlayerKey=function(a,b){return JSROOT.drawTreePlayer(a,b,!0)};JSROOT.drawLeafPlayer=function(a,b){return JSROOT.drawTreePlayer(a,b,!1,!0)};return JSROOT});
