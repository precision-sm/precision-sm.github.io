var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,l,k){c instanceof String&&(c=String(c));for(var g=c.length,r=0;r<g;r++){var t=c[r];if(l.call(k,t,r,c))return{i:r,v:t}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,l,k){c!=Array.prototype&&c!=Object.prototype&&(c[l]=k.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,l,k,g){if(l){k=$jscomp.global;c=c.split(".");for(g=0;g<c.length-1;g++){var r=c[g];r in k||(k[r]={});k=k[r]}c=c[c.length-1];g=k[c];l=l(g);l!=g&&null!=l&&$jscomp.defineProperty(k,c,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,k){return $jscomp.findInternal(this,c,k).v}},"es6","es3");
(function(c){if("function"===typeof define&&define.amd)define(["jquery","jquery-ui","d3","JSRootPainter","JSRootPainter.hierarchy"],c);else{if("undefined"==typeof jQuery)throw Error("jQuery not defined","JSRootPainter.jquery.js");if("undefined"==typeof jQuery.ui)throw Error("jQuery-ui not defined","JSRootPainter.jquery.js");if("object"!=typeof d3)throw Error("This extension requires d3.v3.js","JSRootPainter.jquery.js");if("undefined"==typeof JSROOT)throw Error("JSROOT is not defined","JSRootPainter.jquery.js");
if("object"!=typeof JSROOT.Painter)throw Error("JSROOT.Painter not defined","JSRootPainter.jquery.js");c(jQuery,jQuery.ui,d3,JSROOT)}})(function(c,l,k,g){function r(a){g.MDIDisplay.call(this,a);this.cnt=0}function t(a){g.MDIDisplay.call(this,a);this.cnt=0}function w(a){g.MDIDisplay.call(this,a);this.cnt=0}g.sources.push("jq2d");"function"===typeof define&&define.amd&&g.loadScript("$$$style/jquery-ui.css");g.Painter.createMenu=function(a,b,d){b||"function"!==typeof a||(b=a,a=null);var e={painter:a,
element:null,code:"",cnt:1,funcs:{},separ:!1};d&&"object"==typeof d&&void 0!==d.clientX&&void 0!==d.clientY&&(e.show_evnt={clientX:d.clientX,clientY:d.clientY});e.add=function(a,b,d,e){if("separator"==a)this.code+="<li>-</li>",this.separ=!0;else if(0==a.indexOf("header:"))this.code+="<li class='ui-widget-header' style='padding:3px; padding-left:5px;'>"+a.substr(7)+"</li>";else if("endsub:"==a)this.code+="</ul></li>";else{var f="",h="</li>";e=e?" title='"+e+"'":"";0==a.indexOf("sub:")&&(a=a.substr(4),
h="<ul>");"function"==typeof b&&(d=b,b=a);0==a.indexOf("chk:")?(f="<span class='ui-icon ui-icon-check' style='margin:1px'></span>",a=a.substr(4)):0==a.indexOf("unk:")&&(f="<span class='ui-icon ui-icon-blank' style='margin:1px'></span>",a=a.substr(4));f=0==c.ui.version.indexOf("1.10")||0==c.ui.version.indexOf("1.9")?'<a href="#">'+f+a+"</a>":0==c.ui.version.indexOf("1.11")?f+a:"<div"+e+">"+f+a+"</div>";this.code+="<li cnt='"+this.cnt+(void 0!==b?"' arg='"+b:"")+"'>"+f+h;"function"==typeof d&&(this.funcs[this.cnt]=
d);this.cnt++}};e.addchk=function(a,b,d,e){return this.add((a?"chk:":"unk:")+b,d,e)};e.size=function(){return this.cnt-1};e.addDrawMenu=function(a,b,d){b||(b=[]);0==b.length&&b.push("");var e=!1;0==a.indexOf("nosub:")&&(e=!0,a=a.substr(6));if(1===b.length)return"inspect"===b[0]&&(a=a.replace("Draw","Inspect")),this.add(a,b[0],d);e||this.add("sub:"+a,b[0],d);for(var f=0;f<b.length;++f){var c=b[f];""==c&&(c="&lt;dflt&gt;");var h=f+1;if(5<b.length&&0<c.length)for(;h<b.length&&0==b[h].indexOf(c);)h++;
e&&(c=a+" "+c);if(h<f+2)this.add(c,b[f],d);else{this.add("sub:"+c,b[f],d);for(f+=1;f<h;++f)this.add(b[f],b[f],d);this.add("endsub:");f=h-1}}e||this.add("endsub:")};e.remove=function(){null!==this.element&&(this.element.remove(),this.close_callback&&this.close_callback(),document.body.removeEventListener("click",this.remove_bind));this.element=null};e.remove_bind=e.remove.bind(e);e.show=function(a,b){this.remove();"function"==typeof b&&(this.close_callback=b);!a&&this.show_evnt&&(a=this.show_evnt);
document.body.addEventListener("click",this.remove_bind);(b=document.getElementById("root_ctx_menu"))&&b.parentNode.removeChild(b);c(document.body).append('<ul class="jsroot_ctxmenu">'+this.code+"</ul>");this.element=c(".jsroot_ctxmenu");var d=this;this.element.attr("id","root_ctx_menu").css("left",a.clientX+window.pageXOffset).css("top",a.clientY+window.pageYOffset).css("position","absolute").menu({items:"> :not(.ui-widget-header)",select:function(a,b){a=b.item.attr("arg");b=(b=b.item.attr("cnt"))?
d.funcs[b]:null;d.remove();"function"==typeof b&&("painter"in e?b.bind(d.painter)(a):b(a))}});var f=b=null;a.clientX+this.element.width()>c(window).width()&&(b=c(window).width()-this.element.width()-20);a.clientY+this.element.height()>c(window).height()&&(f=c(window).height()-this.element.height()-20);null!==b&&this.element.css("left",(0<b?b:0)+window.pageXOffset);null!==f&&this.element.css("top",(0<f?f:0)+window.pageYOffset)};g.CallBack(b,e);return e};l=g.BrowserLayout;l.prototype.SetBrowserTitle=
function(a){var b=k.select("#"+this.gui_div+" .jsroot_browser");b.empty()||b.select(".jsroot_browser_title").text(a)};l.prototype.ToggleBrowserKind=function(a){if(this.gui_div){if(!a){if(!this.browser_kind)return;a="float"===this.browser_kind?"fix":"float"}var b=k.select("#"+this.gui_div+" .jsroot_browser"),d=c(b.node()).find(".jsroot_browser_area"),e=this;"float"===this.browser_kind?d.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",!1).resizable("destroy").draggable("destroy"):
"fix"===this.browser_kind&&(b.select(".jsroot_v_separator").remove(),d.css("left","0px"),k.select("#"+this.gui_div+"_drawing").style("left","0px"),b.select(".jsroot_h_separator").style("left","0px"),k.select("#"+this.gui_div+"_status").style("left","0px"),e.CheckResize());this.browser_kind=a;this.browser_visible=!0;"float"===a?(d.css("bottom","40px").toggleClass("jsroot_float_browser",!0).resizable({containment:"parent",minWidth:100,resize:function(a,b){e.SetButtonsPosition()},stop:function(a,b){7>
c(this).parent().innerHeight()-b.position.top-b.size.height&&c(this).css("height","").css("bottom",0)}}).draggable({containment:"parent",handle:c("#"+this.gui_div).find(".jsroot_browser_title"),snap:!0,snapMode:"inner",snapTolerance:10,drag:function(a,b){e.SetButtonsPosition()},stop:function(a,b){7>c(this).parent().innerHeight()-c(this).offset().top-c(this).outerHeight()&&c(this).css("height","").css("bottom",0)}}),this.AdjustBrowserSize()):(d.css("left",0).css("top",0).css("bottom",0).css("height",
""),a=b.append("div").classed("jsroot_separator",!0).classed("jsroot_v_separator",!0).style("position","absolute").style("top",0).style("bottom",0),c(a.node()).draggable({axis:"x",cursor:"ew-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},drag:function(a,b){e.SetButtonsPosition();e.AdjustSeparator(b.position.left,null)},stop:function(a,b){e.CheckResize()}}),this.AdjustSeparator(250,null,!0,!0));this.SetButtonsPosition()}};l.prototype.SetButtonsPosition=
function(){if(this.gui_div){var a=c("#"+this.gui_div+" .jsroot_browser"),b=a.find(".jsroot_browser_btns"),d=7,e=7;if(b.length){if(this.browser_visible){e=a.find(".jsroot_browser_area");a=a.offset();var f=e.offset();d=f.top-a.top+7;e=f.left-a.left+e.innerWidth()-27}b.css("left",e+"px").css("top",d+"px")}}};l.prototype.AdjustBrowserSize=function(a){if(this.gui_div&&"float"===this.browser_kind){var b=c("#"+this.gui_div+" .jsroot_browser");if(b.length){var d=b.find(".jsroot_browser_area"),e=b.find(".jsroot_browser_hierarchy");
b=e.children(":first");a?d.parent().innerHeight()-10<d.innerHeight()&&d.css("bottom","0px").css("top","0px"):b.length&&(a=e.innerHeight(),b=b.innerHeight(),void 0!==b&&b<.7*a&&d.css("bottom",""))}}};l.prototype.ToggleBrowserVisisbility=function(a){if(this.gui_div&&"string"!==typeof this.browser_visible){var b=k.select("#"+this.gui_div+" .jsroot_browser"),d=b.select(".jsroot_browser_area");if(!d.empty()){var e=b.select(".jsroot_v_separator"),f=k.select("#"+this.gui_div+"_drawing"),h=d.property("last_left"),
g=d.property("last_vsepar"),p=d.property("last_drawing");if(this.browser_visible)d.property("last_left",d.style("left")),e.empty()||(d.property("last_vsepar",e.style("left")),d.property("last_drawing",f.style("left"))),h=(-c(d.node()).outerWidth(!0)-10).toString()+"px",g=c(b.node()).outerWidth(!0),e.empty()&&c(d.node()).offset().left>g/2&&(h=g+10+"px"),g="-10px",p="0px";else{if(a)return;d.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}var m=this,q=!this.browser_visible,
x=a?0:700;this.browser_visible="changing";d.transition().style("left",h).duration(x).on("end",function(){a||(m.browser_visible=q)&&m.SetButtonsPosition()});q||b.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(x);e.empty()||(e.transition().style("left",g).duration(x),f.transition().style("left",p).duration(x).on("end",this.CheckResize.bind(this)));this.status_layout&&"fix"==this.browser_kind&&(b.select(".jsroot_h_separator").transition().style("left",p).duration(x),
b.select(".jsroot_status_area").transition().style("left",p).duration(x))}}};l.prototype.Toggle=function(a){"changing"!==this.browser_visible&&(a===this.browser_kind?this.ToggleBrowserVisisbility():this.ToggleBrowserKind(a))};l.prototype.DeleteContent=function(){var a=k.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()){this.CreateStatusLine("delete");var b=a.select(".jsroot_v_separator");b.empty()||c(b.node()).draggable("destroy");this.ToggleBrowserVisisbility(!0);a.selectAll("*").remove();
delete this.browser_visible;delete this.browser_kind;this.CheckResize()}};l.prototype.CreateStatusLine=function(a,b){var d=k.select("#"+this.gui_div+" .jsroot_browser");if(d.empty())return"";var e=this.gui_div+"_status",f=k.select("#"+e),h=!f.empty();"toggle"===b?b=!h:"delete"===a?(b=!1,a=0,delete this.status_layout):void 0===b&&(b=!0,this.status_layout="app");if(h){if(!0===b||"app"===this.status_layout)return e;d=d.select(".jsroot_h_separator");c(d.node()).draggable("destroy");d.remove();f.remove();
delete this.status_layout;this.status_handler&&g.Painter.ShowStatus===this.status_handler&&(delete g.Painter.ShowStatus,delete this.status_handler);this.AdjustSeparator(null,0,!0);return""}if(!1===b)return"";b=k.select("#"+this.gui_div+"_drawing").style("left");f=d.insert("div",".jsroot_browser_area").attr("id",e).classed("jsroot_status_area",!0).style("position","absolute").style("left",b).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);d=d.insert("div",
".jsroot_browser_area").classed("jsroot_separator",!0).classed("jsroot_h_separator",!0).style("position","absolute").style("left",b).style("right",0).style("bottom","20px").style("height","5px");var n=this;c(d.node()).draggable({axis:"y",cursor:"ns-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},drag:function(a,b){n.AdjustSeparator(null,-b.position.top)},stop:function(a,b){n.CheckResize()}});a&&"string"!==typeof a||(a=this.last_hsepar_height||
20);this.AdjustSeparator(null,a,!0);if("app"==this.status_layout)return e;this.status_layout=new g.GridDisplay(e,"horizx4_1213");a=["object name","object title","mouse coordinates","object info"];for(f=0;4>f;++f)k.select(this.status_layout.GetFrame(f)).attr("title",a[f]).style("overflow","hidden").append("label").attr("class","jsroot_status_label");this.status_handler=this.ShowStatus.bind(this);g.Painter.ShowStatus=this.status_handler;return e};l.prototype.AdjustSeparator=function(a,b,d,e){if(this.gui_div){var f=
k.select("#"+this.gui_div+" .jsroot_browser");null===b&&e&&!f.select(".jsroot_h_separator").empty()&&(b=f.select(".jsroot_h_separator").style("bottom"),b="string"==typeof b&&b.indexOf("px")==b.length-2?b.substr(0,b.length-2):null);if(null!==b){b=parseInt(b);e=f.select(".jsroot_h_separator");var h=0;e.empty()||(0>b&&(b+=c(f.node()).outerHeight(!0)-5),5>b&&(b=5),this.last_hsepar_height=b,e.style("bottom",b+"px").style("height","5px"),k.select("#"+this.gui_div+"_status").style("height",b+"px"),h=b+5+
"px");k.select("#"+this.gui_div+"_drawing").style("bottom",h)}null!==a&&(a=parseInt(a),50>a&&(a=50),f.select(".jsroot_browser_area").style("width",a-5+"px"),k.select("#"+this.gui_div+"_drawing").style("left",a+5+"px"),f.select(".jsroot_h_separator").style("left",a+5+"px"),k.select("#"+this.gui_div+"_status").style("left",a+5+"px"),f.select(".jsroot_v_separator").style("left",a+"px").style("width","5px"));d&&this.CheckResize()}};l.prototype.ShowStatus=function(a,b,d,e){if(this.status_layout&&(c(this.status_layout.GetFrame(0)).children("label").text(a||
""),c(this.status_layout.GetFrame(1)).children("label").text(b||""),c(this.status_layout.GetFrame(2)).children("label").text(e||""),c(this.status_layout.GetFrame(3)).children("label").text(d||""),!this.status_layout.first_check)){this.status_layout.first_check=!0;for(b=a=0;4>b;++b)a=Math.max(a,c(this.status_layout.GetFrame(b)).children("label").outerHeight());5<a&&(a>this.last_hsepar_height||a<this.last_hsepar_height+5)&&this.AdjustSeparator(null,a,!0)}};l=g.HierarchyPainter;l.prototype.isLastSibling=
function(a){if(!a||!a._parent||!a._parent._childs)return!1;var b=a._parent._childs;a=b.indexOf(a);if(0>a)return!1;for(;++a<b.length;)if(!("_hidden"in b[a]))return!1;return!0};l.prototype.addItemHtml=function(a,b,d){if(!a||"_hidden"in a)return!0;var e=a===this.h,f="_childs"in a,c=g.getDrawHandle(a._kind),n="",p="",m=!1,q=!1,k=this.itemFullName(a);null!==c&&("icon"in c&&(n=c.icon),"icon2"in c&&(p=c.icon2),0==n.length&&"function"==typeof c.icon_get&&(n=c.icon_get(a,this)),"func"in c||"execute"in c||
"aslink"in c||"expand"in c&&!1!==a._more)&&(m=!0);"_icon"in a&&(n=a._icon);"_icon2"in a&&(p=a._icon2);0==n.length&&"_online"in a&&(a._icon=n="img_globe");0==n.length&&e&&(a._icon=n="img_base");if(a._more||"_expand"in a||"_player"in a)m=!0;var y=m;y||"string"!=typeof a._kind||0!=a._kind.indexOf("ROOT.")||(y=m=!0);0==p.length&&(p=n);0==n.length&&(n=f||a._more?"img_folder":"img_page");0==p.length&&(p=f||a._more?"img_folderopen":"img_page");"update"===d?b.selectAll("*").remove():(b=b.append("div"),d&&
d>=(a._parent._show_limit||g.gStyle.HierarchyLimit)&&(q=!0));a._d3cont=b.node();b.attr("item",k);for(var l=b.append("div").attr("class","h_line"),u=e?null:a._parent;u&&u!==this.h;)l.insert("div",":first-child").attr("class",this.isLastSibling(u)?"img_empty":"img_line"),u=u._parent;var r="";u=!1;e||(f&&!q?(r=a._isopen?"img_minus":"img_plus",u=!0):r="img_join");var v=this;if(0<r.length){if(q||this.isLastSibling(a))r+="bottom";r=l.append("div").attr("class",r);if(u)r.style("cursor","pointer").on("click",
function(){v.tree_click(this,"plusminus")})}if(this.with_icons&&!q&&(n=a._isopen?p:n,n=0==n.indexOf("img_")?l.append("div").attr("class",n).attr("title",a._kind):l.append("img").attr("src",n).attr("alt","").attr("title",a._kind).style("vertical-align","top").style("width","18px").style("height","18px"),"_icon_click"in a||c&&"icon_click"in c))n.on("click",function(){v.tree_click(this,"icon")});c=l.append("a");if(m||f||q)c.attr("class","h_item").on("click",function(){v.tree_click(this)});if(q)return a._break_point=
!0,c.attr("title","there are "+(a._parent._childs.length-d)+" more items").text("...more..."),!1;if("disp_kind"in v){g.gStyle.DragAndDrop&&m&&this.enable_dragging(c.node(),k);if(g.gStyle.ContextMenu&&y)c.on("contextmenu",function(){v.tree_contextmenu(this)});c.on("mouseover",function(){v.tree_mouseover(!0,this)}).on("mouseleave",function(){v.tree_mouseover(!1,this)})}else if(a._direct_context&&g.gStyle.ContextMenu)c.on("contextmenu",function(){v.direct_contextmenu(this)});d=a._name;m="";"_realname"in
a&&(d=a._realname);"_title"in a&&(m=a._title);"_fullname"in a&&(m+="  fullname: "+a._fullname);m||(m=d);c.attr("title",m).text(d+("_value"in a?":":"")).style("background",a._background?a._background:null);"_value"in a&&(l=l.append("p"),"_vclass"in a&&l.attr("class",a._vclass),a._isopen||l.html(a._value));if(f&&(e||a._isopen))for(e=b.append("div").attr("class","h_childs"),f=0;f<a._childs.length&&(b=a._childs[f],b._parent=a,this.addItemHtml(b,e,f));++f);return!0};l.prototype.toggleOpenState=function(a,
b){var d=b?b:this.h;if(!("_childs"in d)){if(!a||this.with_icons||!d._expand&&!0!==d._more)return!1;this.expand(this.itemFullName(d));d._childs&&(d._isopen=!0);return!0}if(d!=this.h&&a&&!d._isopen)return d._isopen=!0;for(var e=!1,f=0;f<d._childs.length;++f)this.toggleOpenState(a,d._childs[f])&&(e=!0);if(d!=this.h&&!a&&d._isopen&&!e)return delete d._isopen,!0;b||this.RefreshHtml();return!1};l.prototype.RefreshHtml=function(a){if(!this.divid)return g.CallBack(a);var b=this.select_main();b.html("").style("overflow",
"hidden").style("display","flex").style("flex-direction","column");var d=this,e=[],f=null;this.ForEach(function(a){delete a._d3cont;"_fastcmd"in a&&"Command"==a._kind&&e.push(a);"_status"in a&&!f&&(f=a)});if(!this.h||b.empty())return g.CallBack(a);if(e.length)for(var c=b.append("div").attr("class","jsroot"),n=0;n<e.length;++n){var p=c.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(e[n])).attr("title",e[n]._title).on("click",function(){d.ExecuteCommand(k.select(this).attr("item"),
this)});"_icon"in e[n]&&p.append("img").attr("src",e[n]._icon)}c=b.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);c.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",d.toggleOpenState.bind(d,!0));c.append("text").text(" | ");c.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",d.toggleOpenState.bind(d,!1));"function"==typeof d.removeInspector&&
(c.append("text").text(" | "),c.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",d.removeInspector.bind(d)));"_online"in this.h&&(c.append("text").text(" | "),c.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",d.reload.bind(d)));"disp_kind"in this&&(c.append("text").text(" | "),c.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",d.clear.bind(d,
!1)));b=b.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");this.background&&b.style("background-color",this.background).style("margin","2px").style("padding","2px");this.addItemHtml(this.h,b.append("div").attr("class","h_tree"));f&&!this.status_disabled&&null===g.GetUrlOption("nostatus")&&(b=g.findFunction(f._status),(c="function"==typeof b?this.CreateStatusLine():null)&&b(c,this.itemFullName(f)));g.CallBack(a)};l.prototype.UpdateTreeNode=
function(a,b){if(void 0===b||b.empty()){b=k.select(a._d3cont?a._d3cont:null);var d=this.itemFullName(a);b.empty()&&(b=this.select_main().select("[item='"+d+"']"));b.empty()&&"_cycle"in a&&(b=this.select_main().select("[item='"+d+";"+a._cycle+"']"));if(b.empty())return}this.addItemHtml(a,b,"update");this.brlayout&&this.brlayout.AdjustBrowserSize(!0)};l.prototype.UpdateBackground=function(a,b){if(a&&a._d3cont){var d=k.select(a._d3cont);d.empty()||(d=d.select(".h_item"),d.style("background",a._background?
a._background:null),b&&a._background&&d.node().scrollIntoView(!1))}};l.prototype.tree_click=function(a,b){if(a){var d=k.select(a.parentNode.parentNode),e=d.attr("item"),c=e?this.Find(e):null;if(c)if(c._break_point){delete c._break_point;this.addItemHtml(c,d,"update");var h=c._parent;c=h._childs.indexOf(c);d=k.select(d.node().parentNode);if(0>c)return console.error("internal error");h._show_limit=2*(h._show_limit||g.gStyle.HierarchyLimit);for(c+=1;c<h._childs.length&&(e=h._childs[c],e._parent=h,this.addItemHtml(e,
d,c));++c);}else{h=c;for(var n=void 0;h&&void 0===(n=h._click_action);)h=h._parent;b&&""!=b||(b="item");var p=g.getDrawSettings(c._kind);h=p.handle;if("icon"==b)e=null,"function"==typeof c._icon_click?e=c._icon_click:h&&"function"==typeof h.icon_click&&(e=h.icon_click),e&&e(c,this)&&this.UpdateTreeNode(c,d);else{"item"==b&&"_expand"in c&&!k.event.ctrlKey&&!k.event.shiftKey&&(b="plusminus");if("plusminus"==b&&!("_childs"in c)&&c._more||"item"==b&&"expand"===n)return this.expand(e,null,d);if("item"==
b){if("_player"in c)return this.player(e);if(h&&h.aslink)return window.open(e+"/");if(h&&h.execute)return this.ExecuteCommand(e,a.parentNode);if(h&&h.ignore_online&&this.isOnlineItem(c))return;a=c._can_draw;b=c._more;n="expand"===this.default_by_click;var m="";k.event.shiftKey&&(m=h&&h.shift?h.shift:"inspect","inspect"===m&&h&&h.noinspect&&(m=""));h&&h.ctrl&&k.event.ctrlKey&&(m=h.ctrl);if(!m)for(var q=c._parent;q;q=q._parent)if(q._painter){a=!1;void 0===b&&(b=!1);break}c._childs&&(b=!1);void 0===
a&&(a=p.draw);void 0===b&&(b=p.expand);a&&b&&!m&&(n||h&&"expand"===h.dflt?a=!1:this.isItemDisplayed(e)&&(a=!1));if(a)return this.display(e,m);if(b||n)return this.expand(e,null,d);if("string"===typeof c._kind&&0===c._kind.indexOf("ROOT.")&&p.inspect&&!1!==a)return this.display(e,"inspect");if(!c._childs||c===this.h)return}c._isopen?delete c._isopen:c._isopen=!0;this.UpdateTreeNode(c,d)}}}};l.prototype.tree_mouseover=function(a,b){b=k.select(b.parentNode.parentNode).attr("item");var c=this.Find(b);
if(c){for(var e,f=c;f&&!e;)e=f._painter,f=f._parent;e&&"function"===typeof e.MouseOverHierarchy&&e.MouseOverHierarchy(a,b,c)}};l.prototype.direct_contextmenu=function(a){k.event.preventDefault();var b=k.select(a.parentNode.parentNode).attr("item"),c=this.Find(b);c&&"function"===typeof this.fill_context&&g.Painter.createMenu(this,function(b){b.painter.fill_context(b,c);0<b.size()&&(b.tree_node=a.parentNode,b.show())},k.event)};l.prototype.tree_contextmenu=function(a){function b(a){var b=document.createElement("div");
b.innerHTML='<a href="'+a.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")+'">x</a>';return b.firstChild.href}k.event.preventDefault();var c=k.select(a.parentNode.parentNode).attr("item"),e=this.Find(c);if(e){var f=this,h=f.GetOnlineProp(c),n=f.GetFileProp(c);g.Painter.createMenu(f,function(d){if(""!=c||"_jsonfile"in e)if(h)f.FillOnlineMenu(d,h,c);else{var m=g.getDrawSettings(e._kind,"nosame");e._can_draw&&(m.opts||(m.opts=[""]),0>m.opts.indexOf("")&&m.opts.unshift(""));
m.opts&&d.addDrawMenu("Draw",m.opts,function(a){this.display(c,a)});if(n&&m.opts&&!n.localfile){var q=b(n.fileurl);0==q.indexOf(g.source_dir)&&(q=q.slice(g.source_dir.length));q=n.kind+"="+q;if(0<n.itemname.length){var k=n.itemname;0<=k.search(/\+| |,/)&&(k="'"+k+"'");q+="&item="+k}d.addDrawMenu("Draw in new tab",m.opts,function(a){window.open(g.source_dir+"index.htm?nobrowser&"+q+"&opt="+a)})}!m.expand||"_childs"in e||!e._more&&"_more"in e||d.add("Expand",function(){f.expand(c)});"ROOT.TStyle"===
e._kind&&d.add("Apply",function(){f.ApplyStyle(c)})}else{m=function(){return 0<l++?"&":"?"};var p="",l=0,r=[];f.ForEachRootFile(function(a){r.push(a._file.fFullURL)});f.GetTopOnlineItem()||(p=g.source_dir+"index.htm");f.IsMonitoring()&&(p+=m()+"monitoring="+f.MonitoringInterval());1==r.length?p+=m()+"file="+r[0]:1<r.length&&(p+=m()+"files="+JSON.stringify(r));f.disp_kind&&(p+=m()+"layout="+f.disp_kind.replace(/ /g,""));var t=[];f.disp&&f.disp.ForEachPainter(function(a){null!=a.GetItemName()&&t.push(a.GetItemName())});
1==t.length?p+=m()+"item="+t[0]:1<t.length&&(p+=m()+"items="+JSON.stringify(t));d.add("Direct link",function(){window.open(p)});d.add("Only items",function(){window.open(p+"&nobrowser")})}"function"==typeof e._menu&&e._menu(d,e,f);0<d.size()&&(d.tree_node=a.parentNode,d.separ&&d.add("separator"),d.add("Close"),d.show())},k.event);return!1}};l.prototype.CreateDisplay=function(a){if("disp"in this){if(0<this.disp.NumDraw())return g.CallBack(a,this.disp);this.disp.Reset();delete this.disp}if(null==document.getElementById(this.disp_frameid))return g.CallBack(a,
null);"tabs"==this.disp_kind?this.disp=new t(this.disp_frameid):0==this.disp_kind.indexOf("flex")?this.disp=new w(this.disp_frameid):0==this.disp_kind.indexOf("coll")?this.disp=new r(this.disp_frameid):this.disp=new g.GridDisplay(this.disp_frameid,this.disp_kind);this.disp&&(this.disp.CleanupFrame=this.CleanupFrame.bind(this));g.CallBack(a,this.disp)};l.prototype.enable_dragging=function(a,b){c(a).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};l.prototype.enable_dropping=function(a,
b){var d=this;c(a).droppable({hoverClass:"ui-state-active",accept:function(a){a=a.parent().parent().attr("item");return a!=b&&a?(a=d.Find(a))&&"_kind"in a?0==a._kind.indexOf("ROOT."):!1:!1},drop:function(a,b){return(a=b.draggable.parent().parent().attr("item"))?d.dropitem(a,c(this).attr("id")):!1}})};l.prototype.CreateBrowser=function(a,b,d){if(!this.gui_div||this.exclude_browser||!this.brlayout)return!1;var e=k.select("#"+this.gui_div+" .jsroot_browser"),f=c(e.node());if(e.empty())return!1;"float"===
a&&this.float_browser_disabled&&(a="fix");if(!e.select(".jsroot_browser_area").empty())return b&&this.brlayout.Toggle(a),g.CallBack(d),!0;var h="<p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+g.version+"</b></span></p>";if(this.is_online)h+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:flex;flex-direction:row;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';
else if(this.no_select)"file"==this.no_select&&(h+='<div style="display:flex;flex-direction:row">');else{var n=k.select("#"+this.gui_div),p=n.attr("files")||"../files/hsimple.root";n=g.GetUrlOption("path")||n.attr("path")||"";p=p.split(";");h+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';
for(var m in p)h+='<option value = "'+n+p[m]+'">'+p[m]+"</option>";h+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}if(this.is_online||
!this.no_select||"file"==this.no_select)h+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>';h+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';this.brlayout.SetBrowserContent(h);this.brlayout.SetBrowserTitle(this.is_online?"ROOT online server":"Read a ROOT file");var q=this,l=null;this.is_online||this.no_select||(this.ReadSelectedFile=function(){var a=e.select(".gui_urlToLoad").property("value").trim();a&&
(a.toLowerCase().lastIndexOf(".json")==a.length-5?this.OpenJsonFile(a):this.OpenRootFile(a))},f.find(".gui_selectFileName").val("").change(function(){f.find(".gui_urlToLoad").val(c(this).val())}),f.find(".gui_fileBtn").button().click(function(){f.find(".gui_localFile").click()}),f.find(".gui_ReadFileBtn").button().click(function(){q.ReadSelectedFile()}),f.find(".gui_ResetUIBtn").button().click(function(){q.clear(!0)}),f.find(".gui_urlToLoad").keyup(function(a){13==a.keyCode&&q.ReadSelectedFile()}),
f.find(".gui_localFile").change(function(a){a=a.target.files;for(var b=0;b<a.length;++b){var c=a[b];e.select(".gui_urlToLoad").property("value",c.name);q&&q.OpenRootFile(c,l)}l=null}),this.SelectLocalFile=function(a){l=a;c("#"+this.gui_div+" .jsroot_browser").find(".gui_localFile").click()});h=f.find(".gui_layout");if(h.length){m="simple;vert2;vert3;vert231;horiz2;horiz32;flex;grid 2x2;grid 1x3;grid 2x3;grid 3x3;grid 4x4;collapsible;tabs".split(";");for(p=0;p<m.length;++p)n=document.createElement("option"),
n.value=m[p],n.innerHTML=m[p],h.get(0).appendChild(n);h.change(function(){q.SetDisplay(c(this).val()||"collapsible",q.gui_div+"_drawing")})}this.SetDivId(this.gui_div+"_browser_hierarchy");b&&(this.RefreshHtml(),this.InitializeBrowser());this.brlayout.ToggleBrowserKind(a||"fix");g.CallBack(d);return!0};l.prototype.InitializeBrowser=function(){var a=k.select("#"+this.gui_div+" .jsroot_browser");if(!a.empty()&&this.brlayout){var b=c(a.node()),d=this;this.brlayout&&this.brlayout.AdjustBrowserSize();
if(a=a.select(".gui_layout").node()){var e=!1;for(h in a.options){var f=a.options[h].text;if("string"===typeof f&&(f==this.GetLayout()||f.replace(/ /g,"")==this.GetLayout())){a.selectedIndex=h;e=!0;break}}if(!e){var h=document.createElement("option");h.innerHTML=h.value=this.GetLayout();a.appendChild(h);a.selectedIndex=a.options.length-1}}if(this.is_online)this.h&&this.h._toptitle&&this.brlayout.SetBrowserTitle(this.h._toptitle),b.find(".gui_monitoring").prop("checked",this.IsMonitoring()).click(function(){d.EnableMonitoring(this.checked);
d.updateAll(!this.checked)});else if(!this.no_select){var g="";this.ForEachRootFile(function(a){g||(g=a._fullurl)});b.find(".gui_urlToLoad").val(g)}}};l.prototype.EnableMonitoring=function(a){this.SetMonitoring(void 0,a);var b=k.select("#"+this.gui_div+" .jsroot_browser .gui_monitoring");b.empty()||b.property("checked")===a||b.property("checked",a)};l.prototype.CreateStatusLine=function(a,b){return!this.status_disabled&&this.gui_div&&this.brlayout?this.brlayout.CreateStatusLine(a,b):""};g.BuildGUI=
function(){var a=k.select("#simpleGUI"),b=!1;if(a.empty()){a=k.select("#onlineGUI");if(a.empty())return alert("no div for gui found");b=!0}"true"===a.attr("ignoreurl")&&(g.gStyle.IgnoreUrlOptions=!0);if(null!==g.GetUrlOption("nobrowser")||a.attr("nobrowser")&&"false"!==a.attr("nobrowser"))return g.BuildNobrowserGUI();g.Painter.readStyleFromURL();var c=new g.HierarchyPainter("root",null);c.is_online=b;c.StartGUI(a,c.InitializeBrowser.bind(c))};r.prototype=Object.create(g.MDIDisplay.prototype);r.prototype.ForEachFrame=
function(a,b){var d=this.frameid+"_collapsible";null!=document.getElementById(d)&&"function"==typeof a&&c("#"+d+" .collapsible_draw").each(function(){b&&c(this).is(":hidden")||a(c(this).get(0))})};r.prototype.GetActiveFrame=function(){var a=g.MDIDisplay.prototype.GetActiveFrame.call(this);if(a&&!c(a).is(":hidden"))return a;a=null;this.ForEachFrame(function(b){a||(a=b)},!0);return a};r.prototype.ActivateFrame=function(a){c(a).is(":hidden")&&c(a).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0);
c(a).prev()[0].scrollIntoView();this.active_frame_title=k.select(a).attr("frame_title")};r.prototype.CreateFrame=function(a){this.BeforeCreateFrame(a);var b=this.frameid+"_collapsible";null==document.getElementById(b)&&c("#"+this.frameid).append('<div id="'+b+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>');var d=this,e=b+"_sub"+this.cnt++,f=e+"h",h='<h5 id="'+f+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+
a+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+e+"'></div>\n";c("#"+b).append(h);c("#"+f).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){c(this).toggleClass("ui-state-hover")}).click(function(){c(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
var a=c(this).next(),b=a.is(":hidden");a.css("display",b?"none":"");b||g.resize(a.get(0))}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();c("#"+f).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){d.CleanupFrame(c(this).parent().next().attr("id"));c(this).parent().next().remove();c(this).parent().remove()});c("#"+f).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);
return c("#"+e).attr("frame_title",a).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};t.prototype=Object.create(g.MDIDisplay.prototype);t.prototype.ForEachFrame=function(a,b){var d=this.frameid+"_tabs";if(null!=document.getElementById(d)&&"function"==typeof a){var e=-1,f=c("#"+d).tabs("option","active");c("#"+d+"> .tabs_draw").each(function(){e++;b&&e!=f||a(c(this).get(0))})}};t.prototype.GetActiveFrame=function(){var a=null;this.ForEachFrame(function(b){a||
(a=b)},!0);return a};t.prototype.ActivateFrame=function(a){var b=0,d=-1;this.ForEachFrame(function(e){c(e).attr("id")==c(a).attr("id")&&(d=b);b++});c("#"+this.frameid+"_tabs").tabs("option","active",d);this.active_frame_title=k.select(a).attr("frame_title")};t.prototype.CreateFrame=function(a){this.BeforeCreateFrame(a);var b=this,d=this.frameid+"_tabs",e=d+"_sub"+this.cnt++,f='<li><a href="#'+e+'">'+a+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',
h='<div class="tabs_draw" id="'+e+'"></div>';if(null==document.getElementById(d)){c("#"+this.frameid).append('<div id="'+d+'" class="jsroot"> <ul>'+f+" </ul>"+h+"</div>");var n=c("#"+d).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(a,b){c(b.newPanel).css("overflow","hidden");g.resize(c(b.newPanel).get(0))}});n.delegate("span.ui-icon-close","click",function(){var a=c(this).closest("li").remove().attr("aria-controls");b.CleanupFrame(a);c("#"+a).remove();n.tabs("refresh");0==c("#"+
d+"> .tabs_draw").length&&c("#"+d).remove()})}else c("#"+d).find("> .ui-tabs-nav").append(f),c("#"+d).append(h),c("#"+d).tabs("refresh"),c("#"+d).tabs("option","active",-1);c("#"+e).empty().css("overflow","hidden").attr("frame_title",a);return c("#"+e).get(0)};t.prototype.CheckMDIResize=function(a,b){c("#"+this.frameid+"_tabs").tabs("refresh");g.MDIDisplay.prototype.CheckMDIResize.call(this,a,b)};w.prototype=Object.create(g.MDIDisplay.prototype);w.prototype.ForEachFrame=function(a,b){var d=this.frameid+
"_flex";null!=document.getElementById(d)&&"function"==typeof a&&c("#"+d+" .flex_draw").each(function(){b&&c(this).is(":hidden")||a(c(this).get(0))})};w.prototype.GetActiveFrame=function(){var a=g.MDIDisplay.prototype.GetActiveFrame.call(this);if(a&&!c(a).is(":hidden"))return a;a=null;this.ForEachFrame(function(b){a||(a=b)},!0);return a};w.prototype.ActivateFrame=function(a){this.active_frame_title=k.select(a).attr("frame_title")};w.prototype.CreateFrame=function(a){function b(a){if("first"===a&&(a=
null,c("#"+e+" .flex_frame").each(function(){c(this).is(":hidden")||"minimal"==c(this).prop("state")||(a=c(this))}),!a))return;a.appendTo(a.parent());if("minimal"!=a.prop("state")){a=a.find(".flex_draw").get(0);var b=new g.TObjectPainter;b.SetDivId(a,-1);g.Painter.SelectActivePad({pp:b.canv_painter(),active:!0});g.resize(a)}}function d(a,c){var d=a.prop("state");d||(d="normal");a.prop("state",c);if(c!=d){"normal"==d&&(a.prop("original_height",a.height()),a.prop("original_width",a.width()),a.prop("original_top",
a.css("top")),a.prop("original_left",a.css("left")));a.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s","minimal"!=c).toggleClass("ui-icon-triangle-2-n-s","minimal"==c);a.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n","maximal"!=c).toggleClass("ui-icon-triangle-2-n-s","maximal"==c);switch(c){case "minimal":a.height(a.find(".flex_header").height()).width("auto");a.find(".flex_draw").css("display","none");a.find(".ui-resizable-handle").css("display",
"none");break;case "maximal":a.height("100%").width("100%").css("left","").css("top","");a.find(".flex_draw").css("display","");a.find(".ui-resizable-handle").css("display","none");break;default:a.find(".flex_draw").css("display",""),a.find(".ui-resizable-handle").css("display",""),a.height(a.prop("original_height")).width(a.prop("original_width")),"minimal"!=d&&a.css("left",a.prop("original_left")).css("top",a.prop("original_top"))}"minimal"!==c?b(a):b("first")}}this.BeforeCreateFrame(a);var e=this.frameid+
"_flex";null==document.getElementById(e)&&c("#"+this.frameid).append('<div id="'+e+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>');var f=this,h=c("#"+e),n=h.width(),k=h.height(),m=e+"_frame"+this.cnt;h.append('<div id="'+m+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+a+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+
m+'_cont" class="flex_draw"></div></div>');c("#"+m).css("left",parseInt(this.cnt%5*n/10)).css("top",parseInt(this.cnt%5*k/10)).width(Math.round(.58*n)).height(Math.round(.58*k)).resizable({helper:"jsroot-flex-resizable-helper",start:function(a,d){b(c(this))},stop:function(a,b){a={width:b.size.width-1,height:b.size.height-c(this).find(".flex_header").height()-1};g.resize(c(this).find(".flex_draw").get(0),a)}}).draggable({containment:"parent",start:function(a,d){b(c(this));var e=c(this).find(".flex_draw");
a=document.elementFromPoint(a.clientX,a.clientY);var f=!1;c(a).parents().map(function(){c(this).get(0)===e.get(0)&&(f=!0)});if(f)return!1}}).click(function(){b(c(this))}).find(".flex_header").click(function(){b(c(this).parent())}).dblclick(function(){var a=c(this).parent();"normal"==a.prop("state")?d(a,"maximal"):d(a,"normal")}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){var a=c(this).parent().parent();f.CleanupFrame(a.find(".flex_draw").get(0));
a.remove();b("first")}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},text:!1}).click(function(){var a=c(this).parent().parent(),b=c(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");d(a,b?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).click(function(){var a=c(this).parent().parent(),b=c(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");
d(a,b?"minimal":"normal")});c("#"+m).find(".ui-resizable-handle").css("z-index","");this.cnt++;return c("#"+m+"_cont").attr("frame_title",a).get(0)};g.GridDisplay.prototype.CreateSeparator=function(a,b,d){b=c(b.append("div").node());b.toggleClass("jsroot_separator",!0).toggleClass(a.vertical?"jsroot_hline":"jsroot_vline",!0).prop("handle",a).attr("separator-id",d.id).css("position","absolute").css(a.vertical?"top":"left","calc("+d.position+"% - 2px)").css(a.vertical?"width":"height",(a.size||100)+
"%").css(a.vertical?"height":"width","5px").css("cursor",a.vertical?"ns-resize":"ew-resize");b.bind("changePosition",function(a,b){function d(a,b){var c=e.vertical?"height":"width",d=e.groups[b].size+"%";a.children("[groupid='"+b+"']").css(c,d).children(".jsroot_separator").css(c,d)}var e=c(this).prop("handle");a=parseInt(c(this).attr("separator-id"));var f=e.groups[a].position;"restore"===b?f=e.groups[a].position0:b&&b.offset&&(f=e.vertical?Math.round((b.offset.top+2-c(this).parent().offset().top)/
c(this).parent().innerHeight()*100):Math.round((b.offset.left+2-c(this).parent().offset().left)/c(this).parent().innerWidth()*100));var g=e.groups[a].position-f;.3>Math.abs(g)||5>Math.min(e.groups[a-1].size-g,e.groups[a].size+g)||(e.groups[a-1].size-=g,e.groups[a].size+=g,e.groups[a].position=f,c(this).css(e.vertical?"top":"left","calc("+f+"% - 2px)"),d(c(this).parent(),a-1),d(c(this).parent(),a),"restore"===b&&(c(this).trigger("resizeGroup",a-1),c(this).trigger("resizeGroup",a)))});b.bind("resizeGroup",
function(a,b){a=c(this).parent().children("[groupid='"+b+"']");a.hasClass("jsroot_newgrid")||(a=a.find(".jsroot_newgrid"));a.each(function(){g.resize(c(this).get(0))})});b.dblclick(function(){c(this).trigger("changePosition","restore")});b.draggable({axis:a.vertical?"y":"x",cursor:a.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},start:function(a,b){a=c(this).prop("handle");b=parseInt(c(this).attr("separator-id"));a.groups[b].startpos=
a.groups[b].position},drag:function(a,b){c(this).trigger("changePosition",b)},stop:function(a,b){a=c(this).prop("handle");b=parseInt(c(this).attr("separator-id"));.5>Math.abs(a.groups[b].startpos-a.groups[b].position)||(c(this).trigger("resizeGroup",b-1),c(this).trigger("resizeGroup",b))}})};g.CreateTreePlayer=function(a){a.draw_first=!0;a.ConfigureOnline=function(a,c,e,f,g){this.SetItemName(a,"",this);this.url=c;this.root_version=f;this.askey=e;this.dflt_expr=g};a.ConfigureTree=function(a){this.local_tree=
a};a.KeyUp=function(a){13==a.keyCode&&this.PerformDraw()};a.ShowExtraButtons=function(a){var b=c(this.select_main().node());b.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");
var e=void 0,f=this;this.local_tree&&(e=this.local_tree.fEntries||0);b.find(".treedraw_cut").val(a&&a.parse_cut?a.parse_cut:"").keyup(this.keyup);b.find(".treedraw_opt").val(a&&a.drawopt?a.drawopt:"").keyup(this.keyup);b.find(".treedraw_number").val(a&&a.numentries?a.numentries:"").spinner({numberFormat:"n",min:0,page:1E3,max:e}).keyup(this.keyup);b.find(".treedraw_first").val(a&&a.firstentry?a.firstentry:"").spinner({numberFormat:"n",min:0,page:1E3,max:e}).keyup(this.keyup);b.find(".treedraw_clear").button().click(function(){g.cleanup(f.drawid)})};
a.Show=function(a,d){this.drawid=a+"_draw";this.keyup=this.KeyUp.bind(this);var b=d&&(d.parse_cut||d.numentries||d.firstentry),f=c("#"+a);f.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> "+(b?"":"<button class='treedraw_more'>More</button>")+"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");
this.SetDivId(a);var g=this;this.local_tree&&f.find(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName);f.find(".treedraw_exe").button().click(function(){g.PerformDraw()});f.find(".treedraw_varexp").val(d&&d.parse_expr?d.parse_expr:this.dflt_expr||"px:py").keyup(this.keyup);b?this.ShowExtraButtons(d):f.find(".treedraw_more").button().click(function(){c(this).remove();g.ShowExtraButtons()});this.CheckResize()};a.PerformLocalDraw=function(){if(this.local_tree){var a=c(this.select_main().node()),
d={expr:a.find(".treedraw_varexp").val()};0==a.find(".treedraw_more").length&&(d.cut=a.find(".treedraw_cut").val(),d.cut||delete d.cut,d.drawopt=a.find(".treedraw_opt").val(),"dump"===d.drawopt&&(d.dump=!0,d.drawopt=""),d.drawopt||delete d.drawopt,d.numentries=parseInt(a.find(".treedraw_number").val()),isNaN(d.numentries)&&delete d.numentries,d.firstentry=parseInt(a.find(".treedraw_first").val()),isNaN(d.firstentry)&&delete d.firstentry);var e=this;d.drawopt&&g.cleanup(e.drawid);e.local_tree.Draw(d,
function(a,b,c){g.redraw(e.drawid,a,b)})}};a.PerformDraw=function(){function a(){g.NewHttpRequest(e,"object",function(a){a&&(g.cleanup(r.drawid),g.draw(r.drawid,a,k))}).send()}if(this.local_tree)return this.PerformLocalDraw();var d=c(this.select_main().node()),e=this.url+"/exe.json.gz?compact=3&method=Draw",f=d.find(".treedraw_varexp").val(),h="h_tree_draw",k="",l=f.indexOf(">>");0>l?f+=">>"+h:(h=f.substr(l+2),"+"==h[0]&&(h=h.substr(1)),l=h.indexOf("("),0<l&&(h=h.substr(0,l)));if(0==d.find(".treedraw_more").length){l=
d.find(".treedraw_cut").val();var m=d.find(".treedraw_number").val(),q=d.find(".treedraw_first").val();k=d.find(".treedraw_opt").val();e+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+f+'"&selection="'+l+'"';""==m&&(m=394499<=this.root_version?"TTree::kMaxEntries":"1000000000");""==q&&(q="0");e+='&option="'+k+'"&nentries='+m+"&firstentry="+q}else e+='&prototype="Option_t*"&opt="'+f+'"';e+="&_ret_object_="+h;var r=this;this.askey?(this.askey=!1,g.NewHttpRequest(this.url+
"/root.json","text",a).send()):a()};a.CheckResize=function(a){var b=c(this.select_main().node());c("#"+this.drawid).width(b.width());a=b.height();var e=b.find(".treedraw_buttons").outerHeight(!0);b=b.find("hr").outerHeight(!0);c("#"+this.drawid).height(a-e-b-2);g.resize(this.drawid)};return a};g.drawTreePlayer=function(a,b,c,e){var d=a.Find(b),h=a.GetTopOnlineItem(d),l="",p=0;if(!d||!h)return null;if(e){for(l=d._name;d&&!d._ttree;)d=d._parent;if(!d)return null;b=a.itemFullName(d)}var m=a.GetOnlineItemUrl(b);
if(!m)return null;h=h._root_version?parseInt(h._root_version):396545;a=a.GetDisplay();if(!a)return null;a=a.FindFrame(b,!0);if(!a)return null;a=k.select(a).attr("id");var q=new g.TBasePainter;if(d._childs&&!e)for(e=0;e<d._childs.length;++e){var r=d._childs[e];r&&r._kind&&0==r._kind.indexOf("ROOT.TLeaf")&&2>p&&(0<p++&&(l+=":"),l+=r._name)}g.CreateTreePlayer(q);q.ConfigureOnline(b,m,c,h,l);q.Show(a);return q};g.drawTreePlayerKey=function(a,b){return g.drawTreePlayer(a,b,!0)};g.drawLeafPlayer=function(a,
b){return g.drawTreePlayer(a,b,!1,!0)};g.Painter.ConfigureVSeparator=function(a){};g.Painter.AdjustLayout=function(a,b,c){g.hpainter&&g.hpainter.brlayout&&g.hpainter.brlayout.AdjustSeparator(a,b,!0)};g.Painter.ConfigureHSeparator=function(a){return g.hpainter?g.hpainter.CreateStatusLine(a):""};return g});
