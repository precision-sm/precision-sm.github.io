(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery-ui","d3","JSRootPainter","JSRootPainter.hierarchy"],a)}else{if(typeof jQuery=="undefined"){throw new Error("jQuery not defined","JSRootPainter.jquery.js")}if(typeof jQuery.ui=="undefined"){throw new Error("jQuery-ui not defined","JSRootPainter.jquery.js")}if(typeof d3!="object"){throw new Error("This extension requires d3.v3.js","JSRootPainter.jquery.js")}if(typeof JSROOT=="undefined"){throw new Error("JSROOT is not defined","JSRootPainter.jquery.js")}if(typeof JSROOT.Painter!="object"){throw new Error("JSROOT.Painter not defined","JSRootPainter.jquery.js")}a(jQuery,jQuery.ui,d3,JSROOT)}}(function(f,h,i,d){d.sources.push("jq2d");if(typeof define==="function"&&define.amd){d.loadScript("$$$style/jquery-ui.css")}d.Painter.createMenu=function(j,k){var l="root_ctx_menu";if(!k&&typeof j==="function"){k=j;j=null}var m={painter:j,element:null,code:"",cnt:1,funcs:{},separ:false};m.add=function(o,n,s){if(o=="separator"){this.code+="<li>-</li>";this.separ=true;return}if(o.indexOf("header:")==0){this.code+="<li class='ui-widget-header' style='padding:3px; padding-left:5px;'>"+o.substr(7)+"</li>";return}if(o=="endsub:"){this.code+="</ul></li>";return}var r="</li>",p="";if(o.indexOf("sub:")==0){o=o.substr(4);r="<ul>"}if(typeof n=="function"){s=n;n=o}var q="";if(o.indexOf("chk:")==0){q="<span class='ui-icon ui-icon-check' style='margin:1px'></span>";o=o.substr(4)}else{if(o.indexOf("unk:")==0){q="<span class='ui-icon ui-icon-blank' style='margin:1px'></span>";o=o.substr(4)}}if((f.ui.version.indexOf("1.10")==0)||(f.ui.version.indexOf("1.9")==0)){q='<a href="#">'+q+o+"</a>"}else{if(f.ui.version.indexOf("1.11")==0){q+=o}else{q="<div>"+q+o+"</div>"}}this.code+="<li cnt='"+this.cnt+"' arg='"+n+"' style='"+p+"'>"+q+r;if(typeof s=="function"){this.funcs[this.cnt]=s}this.cnt++};m.addchk=function(o,p,n,q){return this.add((o?"chk:":"unk:")+p,n,q)};m.size=function(){return this.cnt-1};m.addDrawMenu=function(u,r,s){if(!r){r=[]}if(r.length==0){r.push("")}var n=false;if(u.indexOf("nosub:")==0){n=true;u=u.substr(6)}if(r.length===1){if(r[0]==="inspect"){u=u.replace("Draw","Inspect")}return this.add(u,r[0],s)}if(!n){this.add("sub:"+u,r[0],s)}for(var q=0;q<r.length;++q){var p=r[q];if(p==""){p="&lt;dflt&gt;"}var t=q+1;if((r.length>5)&&(p.length>0)){while((t<r.length)&&(r[t].indexOf(p)==0)){t++}}if(n){p=u+" "+p}if(t<q+2){this.add(p,r[q],s)}else{this.add("sub:"+p,r[q],s);for(var o=q+1;o<t;++o){this.add(r[o],r[o],s)}this.add("endsub:");q=t-1}}if(!n){this.add("endsub:")}};m.remove=function(){if(this.element!==null){this.element.remove();if(this.close_callback){this.close_callback()}document.body.removeEventListener("click",this.remove_bind)}this.element=null};m.remove_bind=m.remove.bind(m);m.show=function(p,r){this.remove();if(typeof r=="function"){this.close_callback=r}document.body.addEventListener("click",this.remove_bind);var o=document.getElementById(l);if(o){o.parentNode.removeChild(o)}f(document.body).append('<ul class="jsroot_ctxmenu">'+this.code+"</ul>");this.element=f(".jsroot_ctxmenu");var n=this;this.element.attr("id",l).css("left",p.clientX+window.pageXOffset).css("top",p.clientY+window.pageYOffset).css("position","absolute").menu({items:"> :not(.ui-widget-header)",select:function(w,x){var t=x.item.attr("arg"),u=x.item.attr("cnt"),v=u?n.funcs[u]:null;n.remove();if(typeof v=="function"){if("painter" in m){v.bind(n.painter)(t)}else{v(t)}}}});var s=null,q=null;if(p.clientX+this.element.width()>f(window).width()){s=f(window).width()-this.element.width()-20}if(p.clientY+this.element.height()>f(window).height()){q=f(window).height()-this.element.height()-20}if(s!==null){this.element.css("left",(s>0?s:0)+window.pageXOffset)}if(q!==null){this.element.css("top",(q>0?q:0)+window.pageYOffset)}};d.CallBack(k,m);return m};var c=d.BrowserLayout;c.prototype.SetBrowserTitle=function(k){var j=i.select("#"+this.gui_div+" .jsroot_browser");if(!j.empty()){j.select(".jsroot_browser_title").text(k)}};c.prototype.ToggleBrowserKind=function(m){if(!this.gui_div){return}if(!m){if(!this.browser_kind){return}m=(this.browser_kind==="float")?"fix":"float"}var j=i.select("#"+this.gui_div+" .jsroot_browser"),o=f(j.node()),n=o.find(".jsroot_browser_area"),l=this;if(this.browser_kind==="float"){n.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",false).resizable("destroy").draggable("destroy")}else{if(this.browser_kind==="fix"){j.select(".jsroot_v_separator").remove();n.css("left","0px");i.select("#"+this.gui_div+"_drawing").style("left","0px");j.select(".jsroot_h_separator").style("left","0px");i.select("#"+this.gui_div+"_status").style("left","0px");l.CheckResize()}}this.browser_kind=m;this.browser_visible=true;if(m==="float"){n.css("bottom","40px").toggleClass("jsroot_float_browser",true).resizable({containment:"parent",minWidth:100,resize:function(p,q){l.SetButtonsPosition()},stop:function(q,r){var p=f(this).parent().innerHeight()-r.position.top-r.size.height;if(p<7){f(this).css("height","").css("bottom",0)}}}).draggable({containment:"parent",handle:f("#"+this.gui_div).find(".jsroot_browser_title"),snap:true,snapMode:"inner",snapTolerance:10,drag:function(p,q){l.SetButtonsPosition()},stop:function(q,r){var p=f(this).parent().innerHeight()-f(this).offset().top-f(this).outerHeight();if(p<7){f(this).css("height","").css("bottom",0)}}});this.AdjustBrowserSize()}else{n.css("left",0).css("top",0).css("bottom",0).css("height","");var k=j.append("div").classed("jsroot_separator",true).classed("jsroot_v_separator",true).style("position","absolute").style("top",0).style("bottom",0);f(k.node()).draggable({axis:"x",cursor:"ew-resize",containment:"parent",helper:function(){return f(this).clone().css("background-color","grey")},drag:function(p,q){l.SetButtonsPosition();l.AdjustSeparator(q.position.left,null)},stop:function(p,q){l.CheckResize()}});this.AdjustSeparator(250,null,true,true)}this.SetButtonsPosition()};c.prototype.SetButtonsPosition=function(){if(!this.gui_div){return}var p=f("#"+this.gui_div+" .jsroot_browser"),k=p.find(".jsroot_browser_btns"),o=7,n=7;if(!k.length){return}if(this.browser_visible){var j=p.find(".jsroot_browser_area"),m=p.offset(),l=j.offset();o=l.top-m.top+7;n=l.left-m.left+j.innerWidth()-27}k.css("left",n+"px").css("top",o+"px")};c.prototype.AdjustBrowserSize=function(m){if(!this.gui_div||(this.browser_kind!=="float")){return}var p=f("#"+this.gui_div+" .jsroot_browser");if(!p.length){return}var n=p.find(".jsroot_browser_area"),j=p.find(".jsroot_browser_hierarchy"),o=j.children(":first");if(m){if(n.parent().innerHeight()-10<n.innerHeight()){n.css("bottom","0px").css("top","0px")}return}if(!o.length){return}var l=j.innerHeight(),k=o.innerHeight();if((k!==undefined)&&(k<l*0.7)){n.css("bottom","")}};c.prototype.ToggleBrowserVisisbility=function(m){if(!this.gui_div||(typeof this.browser_visible==="string")){return}var o=i.select("#"+this.gui_div+" .jsroot_browser"),k=o.select(".jsroot_browser_area");if(k.empty()){return}var q=o.select(".jsroot_v_separator"),s=i.select("#"+this.gui_div+"_drawing"),n=k.property("last_left"),l=k.property("last_vsepar"),t=k.property("last_drawing");if(!this.browser_visible){if(m){return}k.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}else{k.property("last_left",k.style("left"));if(!q.empty()){k.property("last_vsepar",q.style("left"));k.property("last_drawing",s.style("left"))}n=(-f(k.node()).outerWidth(true)-10).toString()+"px";var r=f(o.node()).outerWidth(true);if(q.empty()&&(f(k.node()).offset().left>r/2)){n=(r+10)+"px"}l="-10px";t="0px"}var j=this,u=!this.browser_visible,p=m?0:700;this.browser_visible="changing";k.transition().style("left",n).duration(p).on("end",function(){if(m){return}j.browser_visible=u;if(u){j.SetButtonsPosition()}});if(!u){o.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(p)}if(!q.empty()){q.transition().style("left",l).duration(p);s.transition().style("left",t).duration(p).on("end",this.CheckResize.bind(this))}if(this.status_layout&&(this.browser_kind=="fix")){o.select(".jsroot_h_separator").transition().style("left",t).duration(p);o.select(".jsroot_status_area").transition().style("left",t).duration(p)}};c.prototype.Toggle=function(j){if(this.browser_visible!=="changing"){if(j===this.browser_kind){this.ToggleBrowserVisisbility()}else{this.ToggleBrowserKind(j)}}};c.prototype.DeleteContent=function(){var j=i.select("#"+this.gui_div+" .jsroot_browser");if(j.empty()){return}this.CreateStatusLine("delete");var k=j.select(".jsroot_v_separator");if(!k.empty()){f(k.node()).draggable("destroy")}this.ToggleBrowserVisisbility(true);j.selectAll("*").remove();delete this.browser_visible;delete this.browser_kind;this.CheckResize()};c.prototype.CreateStatusLine=function(u,s){var p=i.select("#"+this.gui_div+" .jsroot_browser");if(p.empty()){return""}var l=this.gui_div+"_status",v=i.select("#"+l),q=false,t=!v.empty();if(s==="toggle"){s=!t;q=(u===this.last_hsepar_height)}else{if(u==="delete"){s=false;u=0;delete this.status_layout}else{if(s===undefined){s=true;this.status_layout="app"}}}if(t){if((s===true)||(this.status_layout==="app")){return l}var m=p.select(".jsroot_h_separator");f(m.node()).draggable("destroy");m.remove();v.remove();delete this.status_layout;if(this.status_handler&&(d.Painter.ShowStatus===this.status_handler)){delete d.Painter.ShowStatus;delete this.status_handler}this.AdjustSeparator(null,0,true);return""}if(s===false){return""}var r=i.select("#"+this.gui_div+"_drawing").style("left");v=p.insert("div",".jsroot_browser_area").attr("id",l).classed("jsroot_status_area",true).style("position","absolute").style("left",r).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);var m=p.insert("div",".jsroot_browser_area").classed("jsroot_separator",true).classed("jsroot_h_separator",true).style("position","absolute").style("left",r).style("right",0).style("bottom","20px").style("height","5px");var j=this;f(m.node()).draggable({axis:"y",cursor:"ns-resize",containment:"parent",helper:function(){return f(this).clone().css("background-color","grey")},drag:function(k,w){j.AdjustSeparator(null,-w.position.top)},stop:function(k,w){j.CheckResize()}});if(!u||(typeof u==="string")){u=this.last_hsepar_height||20}this.AdjustSeparator(null,u,true);if(this.status_layout=="app"){return l}this.status_layout=new d.GridDisplay(l,"horizx4_1213");var n=["object name","object title","mouse coordinates","object info"];for(var o=0;o<4;++o){i.select(this.status_layout.GetFrame(o)).attr("title",n[o]).style("overflow","hidden").append("label").attr("class","jsroot_status_label")}this.status_handler=this.ShowStatus.bind(this);d.Painter.ShowStatus=this.status_handler;return l};c.prototype.AdjustSeparator=function(l,m,q,p){if(!this.gui_div){return}var j=i.select("#"+this.gui_div+" .jsroot_browser"),k=5;if((m===null)&&p&&!j.select(".jsroot_h_separator").empty()){m=j.select(".jsroot_h_separator").style("bottom");if((typeof m=="string")&&(m.indexOf("px")==m.length-2)){m=m.substr(0,m.length-2)}else{m=null}}if(m!==null){m=parseInt(m);var n=j.select(".jsroot_h_separator"),o=0;if(!n.empty()){if(m<0){m+=(f(j.node()).outerHeight(true)-k)}if(m<5){m=5}this.last_hsepar_height=m;n.style("bottom",m+"px").style("height",k+"px");i.select("#"+this.gui_div+"_status").style("height",m+"px");o=(m+k)+"px"}i.select("#"+this.gui_div+"_drawing").style("bottom",o)}if(l!==null){l=parseInt(l);if(l<50){l=50}j.select(".jsroot_browser_area").style("width",(l-5)+"px");i.select("#"+this.gui_div+"_drawing").style("left",(l+k)+"px");j.select(".jsroot_h_separator").style("left",(l+k)+"px");i.select("#"+this.gui_div+"_status").style("left",(l+k)+"px");j.select(".jsroot_v_separator").style("left",l+"px").style("width",k+"px")}if(q){this.CheckResize()}};c.prototype.ShowStatus=function(k,o,l,m){if(!this.status_layout){return}f(this.status_layout.GetFrame(0)).children("label").text(k||"");f(this.status_layout.GetFrame(1)).children("label").text(o||"");f(this.status_layout.GetFrame(2)).children("label").text(m||"");f(this.status_layout.GetFrame(3)).children("label").text(l||"");if(!this.status_layout.first_check){this.status_layout.first_check=true;var j=0;for(var p=0;p<4;++p){j=Math.max(j,f(this.status_layout.GetFrame(p)).children("label").outerHeight())}if((j>5)&&((j>this.last_hsepar_height)||(j<this.last_hsepar_height+5))){this.AdjustSeparator(null,j,true)}}};var b=d.HierarchyPainter;b.prototype.isLastSibling=function(k){if(!k||!k._parent||!k._parent._childs){return false}var j=k._parent._childs,l=j.indexOf(k);if(l<0){return false}while(++l<j.length){if(!("_hidden" in j[l])){return false}}return true};b.prototype.addItemHtml=function(j,q,n){if(!j||("_hidden" in j)){return true}var s=(j===this.h),m=("_childs" in j),G=d.getDrawHandle(j._kind),K="",J="",z=false,y=false,D,u=this.itemFullName(j);if(G!==null){if("icon" in G){K=G.icon}if("icon2" in G){J=G.icon2}if((K.length==0)&&(typeof G.icon_get=="function")){K=G.icon_get(j,this)}if(("func" in G)||("execute" in G)||("aslink" in G)||(("expand" in G)&&(j._more!==false))){z=true}}if("_icon" in j){K=j._icon}if("_icon2" in j){J=j._icon2}if((K.length==0)&&("_online" in j)){j._icon=K="img_globe"}if((K.length==0)&&s){j._icon=K="img_base"}if(j._more||("_expand" in j)||("_player" in j)){z=true}var F=z;if(!F&&(typeof j._kind=="string")&&(j._kind.indexOf("ROOT.")==0)){F=z=true}if(J.length==0){J=K}if(K.length==0){K=(m||j._more)?"img_folder":"img_page"}if(J.length==0){J=(m||j._more)?"img_folderopen":"img_page"}if(n==="update"){q.selectAll("*").remove();D=q}else{D=q.append("div");if(n&&(n>=(j._parent._show_limit||d.gStyle.HierarchyLimit))){y=true}}j._d3cont=D.node();D.attr("item",u);var l=D.append("div").attr("class","h_line");var A=s?null:j._parent;while(A&&(A!==this.h)){l.insert("div",":first-child").attr("class",this.isLastSibling(A)?"img_empty":"img_line");A=A._parent}var k="",r=false;if(s){}else{if(m&&!y){k=j._isopen?"img_minus":"img_plus";r=true}else{k="img_join"}}var C=this;if(k.length>0){if(y||this.isLastSibling(j)){k+="bottom"}var t=l.append("div").attr("class",k);if(r){t.style("cursor","pointer").on("click",function(){C.tree_click(this,"plusminus")})}}if(this.with_icons&&!y){var E=j._isopen?J:K;var p;if(E.indexOf("img_")==0){p=l.append("div").attr("class",E).attr("title",j._kind)}else{p=l.append("img").attr("src",E).attr("alt","").attr("title",j._kind).style("vertical-align","top").style("width","18px").style("height","18px")}if(("_icon_click" in j)||(G&&("icon_click" in G))){p.on("click",function(){C.tree_click(this,"icon")})}}var w=l.append("a");if(z||m||y){w.attr("class","h_item").on("click",function(){C.tree_click(this)})}if(y){j._break_point=true;w.attr("title","there are "+(j._parent._childs.length-n)+" more items").text("...more...");return false}if("disp_kind" in C){if(d.gStyle.DragAndDrop&&z){this.enable_dragging(w.node(),u)}if(d.gStyle.ContextMenu&&F){w.on("contextmenu",function(){C.tree_contextmenu(this)})}w.on("mouseover",function(){C.tree_mouseover(true,this)}).on("mouseleave",function(){C.tree_mouseover(false,this)})}else{if(j._direct_context&&d.gStyle.ContextMenu){w.on("contextmenu",function(){C.direct_contextmenu(this)})}}var v=j._name,x="";if("_realname" in j){v=j._realname}if("_title" in j){x=j._title}if("_fullname" in j){x+="  fullname: "+j._fullname}if(!x){x=v}w.attr("title",x).text(v+("_value" in j?":":"")).style("background",j._background?j._background:null);if("_value" in j){var o=l.append("p");if("_vclass" in j){o.attr("class",j._vclass)}if(!j._isopen){o.html(j._value)}}if(m&&(s||j._isopen)){var I=D.append("div").attr("class","h_childs");for(var B=0;B<j._childs.length;++B){var H=j._childs[B];H._parent=j;if(!this.addItemHtml(H,I,B)){break}}}return true};b.prototype.toggleOpenState=function(m,l){var j=l?l:this.h;if(!("_childs" in j)){if(!m||this.with_icons||(!j._expand&&(j._more!==true))){return false}this.expand(this.itemFullName(j));if(j._childs){j._isopen=true}return true}if((j!=this.h)&&m&&!j._isopen){j._isopen=true;return true}var n=false;for(var k=0;k<j._childs.length;++k){if(this.toggleOpenState(m,j._childs[k])){n=true}}if((j!=this.h)&&!m&&j._isopen&&!n){delete j._isopen;return true}if(!l){this.RefreshHtml()}return false};b.prototype.RefreshHtml=function(t){if(!this.divid){return d.CallBack(t)}var q=this.select_main();q.html("").style("overflow","hidden").style("display","flex").style("flex-direction","column");var p=this,s=[],j=null;this.ForEach(function(n){delete n._d3cont;if(("_fastcmd" in n)&&(n._kind=="Command")){s.push(n)}if(("_status" in n)&&!j){j=n}});if(!this.h||q.empty()){return d.CallBack(t)}if(s.length){var u=q.append("div").attr("class","jsroot");for(var m=0;m<s.length;++m){var l=u.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(s[m])).attr("title",s[m]._title).on("click",function(){p.ExecuteCommand(i.select(this).attr("item"),this)});if("_icon" in s[m]){l.append("img").attr("src",s[m]._icon)}}}var r=q.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);r.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",p.toggleOpenState.bind(p,true));r.append("text").text(" | ");r.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",p.toggleOpenState.bind(p,false));if("_online" in this.h){r.append("text").text(" | ");r.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",p.reload.bind(p))}if("disp_kind" in this){r.append("text").text(" | ");r.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",p.clear.bind(p,false))}var k=q.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");if(this.background){k.style("background-color",this.background).style("margin","2px").style("padding","2px")}this.addItemHtml(this.h,k.append("div").attr("class","h_tree"));if(j&&!this.status_disabled&&(d.GetUrlOption("nostatus")===null)){var o=d.findFunction(j._status);var v=(typeof o=="function")?this.CreateStatusLine():null;if(v){o(v,this.itemFullName(j))}}d.CallBack(t)};b.prototype.UpdateTreeNode=function(k,l){if((l===undefined)||l.empty()){l=i.select(k._d3cont?k._d3cont:null);var j=this.itemFullName(k);if(l.empty()){l=this.select_main().select("[item='"+j+"']")}if(l.empty()&&("_cycle" in k)){l=this.select_main().select("[item='"+j+";"+k._cycle+"']")}if(l.empty()){return}}this.addItemHtml(k,l,"update");if(this.brlayout){this.brlayout.AdjustBrowserSize(true)}};b.prototype.UpdateBackground=function(k,l){if(!k||!k._d3cont){return}var m=i.select(k._d3cont);if(m.empty()){return}var j=m.select(".h_item");j.style("background",k._background?k._background:null);if(l&&k._background){j.node().scrollIntoView(false)}};b.prototype.tree_click=function(u,p){if(!u){return}var x=i.select(u.parentNode.parentNode);var r=x.attr("item");if(!r){return}var k=this.Find(r);if(!k){return}if(k._break_point){delete k._break_point;this.addItemHtml(k,x,"update");var w=k._parent,C=w._childs.indexOf(k),A=i.select(x.node().parentNode);if(C<0){return console.error("internal error")}w._show_limit=(w._show_limit||d.gStyle.HierarchyLimit)*2;for(var t=C+1;t<w._childs.length;++t){var z=w._childs[t];z._parent=w;if(!this.addItemHtml(z,A,t)){break}}return}var w=k,s=undefined;while(w){if((s=w._click_action)!==undefined){break}w=w._parent}if(!p||(p=="")){p="item"}var j=d.getDrawSettings(k._kind),y=j.handle;if(p=="icon"){var m=null;if(typeof k._icon_click=="function"){m=k._icon_click}else{if(y&&typeof y.icon_click=="function"){m=y.icon_click}}if(m&&m(k,this)){this.UpdateTreeNode(k,x)}return}if((p=="item")&&("_expand" in k)&&!i.event.ctrlKey&&!i.event.shiftKey){p="plusminus"}if(((p=="plusminus")&&!("_childs" in k)&&k._more)||((p=="item")&&(s==="expand"))){return this.expand(r,null,x)}if(p=="item"){if("_player" in k){return this.player(r)}if(y&&y.aslink){return window.open(r+"/")}if(y&&y.execute){return this.ExecuteCommand(r,u.parentNode)}if(y&&y.ignore_online&&this.isOnlineItem(k)){return}var l=k._can_draw,q=k._more,o=(this.default_by_click==="expand"),v="";if(i.event.shiftKey){v=(y&&y.shift)?y.shift:"inspect";if((v==="inspect")&&y&&y.noinspect){v=""}}if(y&&y.ctrl&&i.event.ctrlKey){v=y.ctrl}if(!v){for(var B=k._parent;B;B=B._parent){if(B._painter){l=false;if(q===undefined){q=false}break}}}if(k._childs){q=false}if(l===undefined){l=j.draw}if(q===undefined){q=j.expand}if(l&&q&&!v){if(o||(y&&(y.dflt==="expand"))){l=false}else{if(this.isItemDisplayed(r)){l=false}}}if(l){return this.display(r,v)}if(q||o){return this.expand(r,null,x)}if((typeof k._kind==="string")&&(k._kind.indexOf("ROOT.")===0)&&j.inspect&&(l!==false)){return this.display(r,"inspect")}if(!k._childs||(k===this.h)){return}}if(k._isopen){delete k._isopen}else{k._isopen=true}this.UpdateTreeNode(k,x)};b.prototype.tree_mouseover=function(k,n){var o=i.select(n.parentNode.parentNode).attr("item");var l=this.Find(o);if(!l){return}var j,m=l;while(m&&!j){j=m._painter;m=m._parent}if(j&&typeof j.MouseOverHierarchy==="function"){j.MouseOverHierarchy(k,o,l)}};b.prototype.direct_contextmenu=function(k){i.event.preventDefault();var l=i.select(k.parentNode.parentNode).attr("item");var j=this.Find(l);if(!j){return}if(typeof this.fill_context!=="function"){return}d.Painter.createMenu(this,function(m){m.painter.fill_context(m,j);if(m.size()>0){m.tree_node=k.parentNode;m.show(i.event)}})};b.prototype.tree_contextmenu=function(l){i.event.preventDefault();var p=i.select(l.parentNode.parentNode).attr("item");var k=this.Find(p);if(!k){return}var j=this,o=j.GetOnlineProp(p),n=j.GetFileProp(p);function m(q){function s(t){return t.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}var r=document.createElement("div");r.innerHTML='<a href="'+s(q)+'">x</a>';return r.firstChild.href}d.Painter.createMenu(j,function(s){if((p=="")&&!("_jsonfile" in k)){var x="",t=0;function u(){return t++>0?"&":"?"}var r=[];j.ForEachRootFile(function(z){r.push(z._file.fFullURL)});if(!j.GetTopOnlineItem()){x=d.source_dir+"index.htm"}if(j.IsMonitoring()){x+=u()+"monitoring="+j.MonitoringInterval()}if(r.length==1){x+=u()+"file="+r[0]}else{if(r.length>1){x+=u()+"files="+JSON.stringify(r)}}if(j.disp_kind){x+=u()+"layout="+j.disp_kind.replace(/ /g,"")}var w=[];if(j.disp){j.disp.ForEachPainter(function(z){if(z.GetItemName()!=null){w.push(z.GetItemName())}})}if(w.length==1){x+=u()+"item="+w[0]}else{if(w.length>1){x+=u()+"items="+JSON.stringify(w)}}s.add("Direct link",function(){window.open(x)});s.add("Only items",function(){window.open(x+"&nobrowser")})}else{if(o){j.FillOnlineMenu(s,o,p)}else{var v=d.getDrawSettings(k._kind,"nosame");if(k._can_draw){if(!v.opts){v.opts=[""]}if(v.opts.indexOf("")<0){v.opts.unshift("")}}if(v.opts){s.addDrawMenu("Draw",v.opts,function(z){this.display(p,z)})}if(n&&v.opts&&!n.localfile){var y=m(n.fileurl);if(y.indexOf(d.source_dir)==0){y=y.slice(d.source_dir.length)}y=n.kind+"="+y;if(n.itemname.length>0){var q=n.itemname;if(q.search(/\+| |\,/)>=0){q="'"+q+"'"}y+="&item="+q}s.addDrawMenu("Draw in new tab",v.opts,function(z){window.open(d.source_dir+"index.htm?nobrowser&"+y+"&opt="+z)})}if(v.expand&&!("_childs" in k)&&(k._more||!("_more" in k))){s.add("Expand",function(){j.expand(p)})}if(k._kind==="ROOT.TStyle"){s.add("Apply",function(){j.ApplyStyle(p)})}}}if(typeof k._menu=="function"){k._menu(s,k,j)}if(s.size()>0){s.tree_node=l.parentNode;if(s.separ){s.add("separator")}s.add("Close");s.show(i.event)}});return false};b.prototype.CreateDisplay=function(j){if("disp" in this){if(this.disp.NumDraw()>0){return d.CallBack(j,this.disp)}this.disp.Reset();delete this.disp}if(document.getElementById(this.disp_frameid)==null){return d.CallBack(j,null)}if(this.disp_kind=="tabs"){this.disp=new a(this.disp_frameid)}else{if(this.disp_kind.indexOf("flex")==0){this.disp=new e(this.disp_frameid)}else{if(this.disp_kind.indexOf("coll")==0){this.disp=new g(this.disp_frameid)}else{this.disp=new d.GridDisplay(this.disp_frameid,this.disp_kind)}}}if(this.disp){this.disp.CleanupFrame=this.CleanupFrame.bind(this)}d.CallBack(j,this.disp)};b.prototype.enable_dragging=function(j,k){f(j).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};b.prototype.enable_dropping=function(k,l){var j=this;f(k).droppable({hoverClass:"ui-state-active",accept:function(o){var n=o.parent().parent().attr("item");if((n==l)||!n){return false}var m=j.Find(n);if(!m||(!("_kind" in m))){return false}return m._kind.indexOf("ROOT.")==0},drop:function(n,o){var m=o.draggable.parent().parent().attr("item");if(!m){return false}return j.dropitem(m,f(this).attr("id"))}})};b.prototype.CreateBrowser=function(m,u,t){if(!this.gui_div||this.exclude_browser||!this.brlayout){return false}var x=i.select("#"+this.gui_div+" .jsroot_browser"),p=f(x.node());if(x.empty()){return false}if((m==="float")&&this.float_browser_disabled){m="fix"}if(!x.select(".jsroot_browser_area").empty()){if(u){this.brlayout.Toggle(m)}d.CallBack(t);return true}var q="<p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+d.version+"</b></span></p>";if(this.is_online){q+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:flex;flex-direction:row;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>'}else{if(!this.no_select){var n=i.select("#"+this.gui_div),l=n.attr("files")||"../files/hsimple.root",A=d.GetUrlOption("path")||n.attr("path")||"",s=l.split(";");q+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';for(var z in s){q+='<option value = "'+A+s[z]+'">'+s[z]+"</option>"}q+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}else{if(this.no_select=="file"){q+='<div style="display:flex;flex-direction:row">'}}}if(this.is_online||!this.no_select||this.no_select=="file"){q+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>'}q+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';this.brlayout.SetBrowserContent(q);this.brlayout.SetBrowserTitle(this.is_online?"ROOT online server":"Read a ROOT file");var r=this,w=null;if(!this.is_online&&!this.no_select){this.ReadSelectedFile=function(){var k=x.select(".gui_urlToLoad").property("value").trim();if(!k){return}if((k.toLowerCase().lastIndexOf(".json")==k.length-5)){this.OpenJsonFile(k)}else{this.OpenRootFile(k)}};p.find(".gui_selectFileName").val("").change(function(){p.find(".gui_urlToLoad").val(f(this).val())});p.find(".gui_fileBtn").button().click(function(){p.find(".gui_localFile").click()});p.find(".gui_ReadFileBtn").button().click(function(){r.ReadSelectedFile()});p.find(".gui_ResetUIBtn").button().click(function(){r.clear(true)});p.find(".gui_urlToLoad").keyup(function(k){if(k.keyCode==13){r.ReadSelectedFile()}});p.find(".gui_localFile").change(function(D){var k=D.target.files;for(var C=0;C<k.length;++C){var B=k[C];x.select(".gui_urlToLoad").property("value",B.name);if(r){r.OpenRootFile(B,w)}}w=null});this.SelectLocalFile=function(k){w=k;f("#"+this.gui_div+" .jsroot_browser").find(".gui_localFile").click()}}var j=p.find(".gui_layout");if(j.length){var y=["simple","vert2","vert3","vert231","horiz2","horiz32","flex","grid 2x2","grid 1x3","grid 2x3","grid 3x3","grid 4x4","collapsible","tabs"];for(var v=0;v<y.length;++v){var o=document.createElement("option");o.value=y[v];o.innerHTML=y[v];j.get(0).appendChild(o)}j.change(function(){r.SetDisplay(f(this).val()||"collapsible",r.gui_div+"_drawing")})}this.SetDivId(this.gui_div+"_browser_hierarchy");if(u){this.RefreshHtml();this.InitializeBrowser()}this.brlayout.ToggleBrowserKind(m||"fix");d.CallBack(t);return true};b.prototype.InitializeBrowser=function(){var n=i.select("#"+this.gui_div+" .jsroot_browser");if(n.empty()||!this.brlayout){return}var j=f(n.node()),m=this;if(this.brlayout){this.brlayout.AdjustBrowserSize()}var p=n.select(".gui_layout").node();if(p){var q=false;for(var o in p.options){var r=p.options[o].text;if(typeof r!=="string"){continue}if((r==this.GetLayout())||(r.replace(/ /g,"")==this.GetLayout())){p.selectedIndex=o;q=true;break}}if(!q){var k=document.createElement("option");k.innerHTML=k.value=this.GetLayout();p.appendChild(k);p.selectedIndex=p.options.length-1}}if(this.is_online){if(this.h&&this.h._toptitle){this.brlayout.SetBrowserTitle(this.h._toptitle)}j.find(".gui_monitoring").prop("checked",this.IsMonitoring()).click(function(){m.EnableMonitoring(this.checked);m.updateAll(!this.checked)})}else{if(!this.no_select){var l="";this.ForEachRootFile(function(s){if(!l){l=s._fullurl}});j.find(".gui_urlToLoad").val(l)}}};b.prototype.EnableMonitoring=function(j){this._monitoring_on=j;var k=i.select("#"+this.gui_div+" .jsroot_browser .gui_monitoring");if(!k.empty()&&(k.property("checked")!==j)){k.property("checked",j)}};b.prototype.CreateStatusLine=function(j,k){if(this.status_disabled||!this.gui_div||!this.brlayout){return""}return this.brlayout.CreateStatusLine(j,k)};d.BuildGUI=function(){var j=i.select("#simpleGUI"),k=false;if(j.empty()){j=i.select("#onlineGUI");if(j.empty()){return alert("no div for gui found")}k=true}if(j.attr("ignoreurl")==="true"){d.gStyle.IgnoreUrlOptions=true}if((d.GetUrlOption("nobrowser")!==null)||(j.attr("nobrowser")&&j.attr("nobrowser")!=="false")){return d.BuildNobrowserGUI()}d.Painter.readStyleFromURL();var l=new d.HierarchyPainter("root",null);l.is_online=k;l.StartGUI(j,l.InitializeBrowser.bind(l))};function g(j){d.MDIDisplay.call(this,j);this.cnt=0}g.prototype=Object.create(d.MDIDisplay.prototype);g.prototype.ForEachFrame=function(k,l){var j=this.frameid+"_collapsible";if(document.getElementById(j)==null){return}if(typeof k!="function"){return}f("#"+j+" .collapsible_draw").each(function(){if(l&&f(this).is(":hidden")){return}k(f(this).get(0))})};g.prototype.GetActiveFrame=function(){var j=d.MDIDisplay.prototype.GetActiveFrame.call(this);if(j&&!f(j).is(":hidden")){return j}j=null;this.ForEachFrame(function(k){if(!j){j=k}},true);return j};g.prototype.ActivateFrame=function(j){if(f(j).is(":hidden")){f(j).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0)}f(j).prev()[0].scrollIntoView();this.active_frame_title=i.select(j).attr("frame_title")};g.prototype.CreateFrame=function(n){this.BeforeCreateFrame(n);var l=this.frameid+"_collapsible";if(document.getElementById(l)==null){f("#"+this.frameid).append('<div id="'+l+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>')}var o=this,k=l+"_sub"+this.cnt++,m=k+"h",j='<h5 id="'+m+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+n+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+k+"'></div>\n";f("#"+l).append(j);f("#"+m).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){f(this).toggleClass("ui-state-hover")}).click(function(){f(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);var q=f(this).next(),p=q.is(":hidden");q.attr("frame_active",p?"false":"true").css("display",p?"none":"");if(!p){d.resize(q.attr("id"))}}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();f("#"+m).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){o.CleanupFrame(f(this).parent().next().attr("id"));f(this).parent().next().remove();f(this).parent().remove()});f("#"+m).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);return f("#"+k).attr("frame_title",n).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};function a(j){d.MDIDisplay.call(this,j);this.cnt=0}a.prototype=Object.create(d.MDIDisplay.prototype);a.prototype.ForEachFrame=function(k,n){var j=this.frameid+"_tabs";if(document.getElementById(j)==null){return}if(typeof k!="function"){return}var l=-1;var m=f("#"+j).tabs("option","active");f("#"+j+"> .tabs_draw").each(function(){l++;if(!n||(l==m)){k(f(this).get(0))}})};a.prototype.GetActiveFrame=function(){var j=null;this.ForEachFrame(function(k){if(!j){j=k}},true);return j};a.prototype.ActivateFrame=function(k){var j=0,l=-1;this.ForEachFrame(function(m){if(f(m).attr("id")==f(k).attr("id")){l=j}j++});f("#"+this.frameid+"_tabs").tabs("option","active",l);this.active_frame_title=i.select(k).attr("frame_title")};a.prototype.CreateFrame=function(o){this.BeforeCreateFrame(o);var p=this,m=this.frameid+"_tabs",l=m+"_sub"+this.cnt++,k='<li><a href="#'+l+'">'+o+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',j='<div class="tabs_draw" id="'+l+'"></div>';if(document.getElementById(m)==null){f("#"+this.frameid).append('<div id="'+m+'" class="jsroot"> <ul>'+k+" </ul>"+j+"</div>");var n=f("#"+m).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(q,r){console.log("tabs activate");f(r.oldPanel).attr("frame_active","false");f(r.newPanel).css("overflow","hidden").attr("frame_active","true");d.resize(f(r.newPanel).attr("id"))}});n.delegate("span.ui-icon-close","click",function(){var q=f(this).closest("li").remove().attr("aria-controls");p.CleanupFrame(q);f("#"+q).remove();n.tabs("refresh");if(f("#"+m+"> .tabs_draw").length==0){f("#"+m).remove()}})}else{f("#"+m).find("> .ui-tabs-nav").append(k);f("#"+m).append(j);f("#"+m).tabs("refresh");f("#"+m).tabs("option","active",-1)}f("#"+l).empty().css("overflow","hidden").attr("frame_active","true").attr("frame_title",o);return f("#"+l).get(0)};a.prototype.CheckMDIResize=function(k,j){f("#"+this.frameid+"_tabs").tabs("refresh");d.MDIDisplay.prototype.CheckMDIResize.call(this,k,j)};function e(j){d.MDIDisplay.call(this,j);this.cnt=0}e.prototype=Object.create(d.MDIDisplay.prototype);e.prototype.ForEachFrame=function(k,l){var j=this.frameid+"_flex";if(document.getElementById(j)==null){return}if(typeof k!="function"){return}f("#"+j+" .flex_draw").each(function(){if(l&&f(this).is(":hidden")){return}k(f(this).get(0))})};e.prototype.GetActiveFrame=function(){var j=d.MDIDisplay.prototype.GetActiveFrame.call(this);if(j&&!f(j).is(":hidden")){return j}j=null;this.ForEachFrame(function(k){if(!j){j=k}},true);return j};e.prototype.ActivateFrame=function(j){this.active_frame_title=i.select(j).attr("frame_title")};e.prototype.CreateFrame=function(n){this.BeforeCreateFrame(n);var k=this.frameid+"_flex";if(document.getElementById(k)==null){f("#"+this.frameid).append('<div id="'+k+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>')}var j=this,m=f("#"+k),q=m.width(),l=m.height(),r=k+"_frame"+this.cnt;var p='<div id="'+r+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+n+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+r+'_cont" class="flex_draw"></div></div>';m.append(p);function o(s,t){var u=s.prop("state");if(!u){u="normal"}s.prop("state",t);if(t==u){return}if(u=="normal"){s.prop("original_height",s.height());s.prop("original_width",s.width());s.prop("original_top",s.css("top"));s.prop("original_left",s.css("left"))}s.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s",t!="minimal").toggleClass("ui-icon-triangle-2-n-s",t=="minimal");s.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n",t!="maximal").toggleClass("ui-icon-triangle-2-n-s",t=="maximal");switch(t){case"minimal":s.height(s.find(".flex_header").height()).width("auto");s.find(".flex_draw").css("display","none");s.find(".ui-resizable-handle").css("display","none");break;case"maximal":s.height("100%").width("100%").css("left","").css("top","");s.find(".flex_draw").css("display","");s.find(".ui-resizable-handle").css("display","none");break;default:s.find(".flex_draw").css("display","");s.find(".ui-resizable-handle").css("display","");s.height(s.prop("original_height")).width(s.prop("original_width"));if(u!="minimal"){s.css("left",s.prop("original_left")).css("top",s.prop("original_top"))}}s.find(".flex_draw").attr("frame_active",t!=="minimal"?"true":"false");if(t!=="minimal"){d.resize(s.find(".flex_draw").get(0))}}f("#"+r).css("left",parseInt(q*(this.cnt%5)/10)).css("top",parseInt(l*(this.cnt%5)/10)).width(Math.round(q*0.58)).height(Math.round(l*0.58)).resizable({helper:"jsroot-flex-resizable-helper",start:function(s,t){f(this).appendTo(f(this).parent())},stop:function(t,u){var s={width:u.size.width-1,height:u.size.height-f(this).find(".flex_header").height()-1};d.resize(f(this).find(".flex_draw").get(0),s)}}).draggable({containment:"parent",start:function(t,v){f(this).appendTo(f(this).parent());var u=f(this).find(".flex_draw");var w=document.elementFromPoint(t.clientX,t.clientY);var s=false;f(w).parents().map(function(){if(f(this).get(0)===u.get(0)){s=true}});if(s){return false}}}).find(".flex_header").click(function(){var s=f(this).parent();s.appendTo(s.parent())}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){var s=f(this).parent().parent();j.CleanupFrame(s.find(".flex_draw").get(0));s.remove()}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},text:false}).click(function(){var s=f(this).parent().parent();var t=f(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");o(s,t?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).click(function(){var s=f(this).parent().parent();var t=f(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");o(s,t?"minimal":"normal")});f("#"+r).find(".ui-resizable-handle").css("z-index","");this.cnt++;return f("#"+r+"_cont").attr("frame_title",n).get(0)};d.GridDisplay.prototype.CreateSeparator=function(l,j,m){var k=f(j.append("div").node());k.toggleClass("jsroot_separator",true).toggleClass(l.vertical?"jsroot_hline":"jsroot_vline",true).prop("handle",l).attr("separator-id",m.id).css("position","absolute").css(l.vertical?"top":"left","calc("+m.position+"% - 2px)").css(l.vertical?"width":"height",(l.size||100)+"%").css(l.vertical?"height":"width","5px").css("cursor",l.vertical?"ns-resize":"ew-resize");k.bind("changePosition",function(r,o){var p=f(this).prop("handle"),t=parseInt(f(this).attr("separator-id")),s=p.groups[t].position;if(o==="restore"){s=p.groups[t].position0}else{if(o&&o.offset){if(p.vertical){s=Math.round((o.offset.top+2-f(this).parent().offset().top)/f(this).parent().innerHeight()*100)}else{s=Math.round((o.offset.left+2-f(this).parent().offset().left)/f(this).parent().innerWidth()*100)}}}var q=p.groups[t].position-s;if(Math.abs(q)<0.3){return}if(Math.min(p.groups[t-1].size-q,p.groups[t].size+q)<5){return}p.groups[t-1].size-=q;p.groups[t].size+=q;p.groups[t].position=s;function n(x,w){var u=p.vertical?"height":"width",v=p.groups[w].size+"%";x.children("[groupid='"+w+"']").css(u,v).children(".jsroot_separator").css(u,v)}f(this).css(p.vertical?"top":"left","calc("+s+"% - 2px)");n(f(this).parent(),t-1);n(f(this).parent(),t);if(o==="restore"){f(this).trigger("resizeGroup",t-1);f(this).trigger("resizeGroup",t)}});k.bind("resizeGroup",function(p,n){var o=f(this).parent().children("[groupid='"+n+"']");if(!o.hasClass("jsroot_newgrid")){o=o.find(".jsroot_newgrid")}o.each(function(){d.resize(f(this).get(0))})});k.dblclick(function(){f(this).trigger("changePosition","restore")});k.draggable({axis:l.vertical?"y":"x",cursor:l.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return f(this).clone().css("background-color","grey")},start:function(n,p){var o=f(this).prop("handle"),q=parseInt(f(this).attr("separator-id"));o.groups[q].startpos=o.groups[q].position},drag:function(n,o){f(this).trigger("changePosition",o)},stop:function(n,p){var o=f(this).prop("handle"),q=parseInt(f(this).attr("separator-id"));if(Math.abs(o.groups[q].startpos-o.groups[q].position)<0.5){return}f(this).trigger("resizeGroup",q-1);f(this).trigger("resizeGroup",q)}})};d.CreateTreePlayer=function(j){j.draw_first=true;j.ConfigureOnline=function(o,m,n,k,l){this.SetItemName(o,"",this);this.url=m;this.root_version=k;this.askey=n;this.dflt_expr=l};j.ConfigureTree=function(k){this.local_tree=k};j.KeyUp=function(k){if(k.keyCode==13){this.PerformDraw()}};j.ShowExtraButtons=function(m){var k=f("#"+this.divid);k.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");var n=1000,l=undefined,o=this;if(this.local_tree){l=this.local_tree.fEntries||0}k.find(".treedraw_cut").val(m&&m.parse_cut?m.parse_cut:"").keyup(this.keyup);k.find(".treedraw_opt").val(m&&m.drawopt?m.drawopt:"").keyup(this.keyup);k.find(".treedraw_number").val(m&&m.numentries?m.numentries:"").spinner({numberFormat:"n",min:0,page:1000,max:l}).keyup(this.keyup);k.find(".treedraw_first").val(m&&m.firstentry?m.firstentry:"").spinner({numberFormat:"n",min:0,page:1000,max:l}).keyup(this.keyup);k.find(".treedraw_clear").button().click(function(){d.cleanup(o.drawid)})};j.Show=function(o,l){this.drawid=o+"_draw";this.keyup=this.KeyUp.bind(this);var m=l&&(l.parse_cut||l.numentries||l.firstentry);var k=f("#"+o);k.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> "+(m?"":"<button class='treedraw_more'>More</button>")+"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");this.SetDivId(o);var n=this;if(this.local_tree){k.find(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName)}k.find(".treedraw_exe").button().click(function(){n.PerformDraw()});k.find(".treedraw_varexp").val(l&&l.parse_expr?l.parse_expr:(this.dflt_expr||"px:py")).keyup(this.keyup);if(m){this.ShowExtraButtons(l)}else{k.find(".treedraw_more").button().click(function(){f(this).remove();n.ShowExtraButtons()})}this.CheckResize()};j.PerformLocalDraw=function(){if(!this.local_tree){return}var m=f(this.select_main().node()),k={expr:m.find(".treedraw_varexp").val()};if(m.find(".treedraw_more").length==0){k.cut=m.find(".treedraw_cut").val();if(!k.cut){delete k.cut}k.drawopt=m.find(".treedraw_opt").val();if(k.drawopt==="dump"){k.dump=true;k.drawopt=""}if(!k.drawopt){delete k.drawopt}k.numentries=parseInt(m.find(".treedraw_number").val());if(isNaN(k.numentries)){delete k.numentries}k.firstentry=parseInt(m.find(".treedraw_first").val());if(isNaN(k.firstentry)){delete k.firstentry}}var l=this;if(k.drawopt){d.cleanup(l.drawid)}l.local_tree.Draw(k,function(o,n,p){d.redraw(l.drawid,o,n)})};j.PerformDraw=function(){if(this.local_tree){return this.PerformLocalDraw()}var m=f(this.select_main().node()),l=this.url+"/exe.json.gz?compact=3&method=Draw",u=m.find(".treedraw_varexp").val(),k="h_tree_draw",n="",r=u.indexOf(">>");if(r<0){u+=">>"+k}else{k=u.substr(r+2);if(k[0]=="+"){k=k.substr(1)}var s=k.indexOf("(");if(s>0){k=k.substr(0,s)}}if(m.find(".treedraw_more").length==0){var t=m.find(".treedraw_cut").val(),q=m.find(".treedraw_number").val(),p=m.find(".treedraw_first").val();n=m.find(".treedraw_opt").val();l+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+u+'"&selection="'+t+'"';if(q==""){q=(this.root_version>=394499)?"TTree::kMaxEntries":"1000000000"}if(p==""){p="0"}l+='&option="'+n+'"&nentries='+q+"&firstentry="+p}else{l+='&prototype="Option_t*"&opt="'+u+'"'}l+="&_ret_object_="+k;var v=this;function o(){d.NewHttpRequest(l,"object",function(w){if(!w){return}d.cleanup(v.drawid);d.draw(v.drawid,w,n)}).send()}if(this.askey){this.askey=false;d.NewHttpRequest(this.url+"/root.json","text",o).send()}else{o()}};j.CheckResize=function(l){var k=f(this.select_main().node());f("#"+this.drawid).width(k.width());var o=k.height(),n=k.find(".treedraw_buttons").outerHeight(true),m=k.find("hr").outerHeight(true);f("#"+this.drawid).height(o-n-m-2);d.resize(this.drawid)};return j};d.drawTreePlayer=function(o,u,r,q){var z=o.Find(u),x=o.GetTopOnlineItem(z),t="",v=0;if(!z||!x){return null}if(q){t=z._name;while(z&&!z._ttree){z=z._parent}if(!z){return null}u=o.itemFullName(z)}var j=o.GetOnlineItemUrl(u);if(!j){return null}var k=x._root_version?parseInt(x._root_version):396545;var p=o.GetDisplay();if(!p){return null}var l=p.FindFrame(u,true);if(!l){return null}var w=i.select(l).attr("id"),y=new d.TBasePainter();if(z._childs&&!q){for(var m=0;m<z._childs.length;++m){var s=z._childs[m];if(s&&s._kind&&(s._kind.indexOf("ROOT.TLeaf")==0)&&(v<2)){if(v++>0){t+=":"}t+=s._name}}}d.CreateTreePlayer(y);y.ConfigureOnline(u,j,r,k,t);y.Show(w);return y};d.drawTreePlayerKey=function(j,k){return d.drawTreePlayer(j,k,true)};d.drawLeafPlayer=function(j,k){return d.drawTreePlayer(j,k,false,true)};d.Painter.ConfigureVSeparator=function(j){};d.Painter.AdjustLayout=function(l,j,k){if(d.hpainter&&d.hpainter.brlayout){d.hpainter.brlayout.AdjustSeparator(l,j,true)}};d.Painter.ConfigureHSeparator=function(j){if(!d.hpainter){return""}return d.hpainter.CreateStatusLine(j)};return d}));