(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery-ui","d3","JSRootPainter","JSRootPainter.hierarchy","JSRootPainter.jquery"],a)}else{if(typeof jQuery=="undefined"){throw new Error("jQuery not defined","JSRootPainter.openui5.js")}if(typeof jQuery.ui=="undefined"){throw new Error("jQuery-ui not defined","JSRootPainter.openui5.js")}if(typeof d3!="object"){throw new Error("This extension requires d3.v3.js","JSRootPainter.openui5.js")}if(typeof JSROOT=="undefined"){throw new Error("JSROOT is not defined","JSRootPainter.openui5.js")}if(typeof JSROOT.Painter!="object"){throw new Error("JSROOT.Painter not defined","JSRootPainter.openui5.js")}a(jQuery,jQuery.ui,d3,JSROOT)}}(function(e,g,d,a){a.sources.push("openui5");var c=a.complete_script_load;delete a.complete_script_load;a.completeUI5Loading=function(){a.sap=sap;a.CallBack(c);c=null};var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("id","sap-ui-bootstrap");var f="https://openui5.hana.ondemand.com/";if(a.openui5src=="jsroot"){f=a.source_dir+"openui5dist/"}else{if(typeof a.openui5src=="string"){f=a.openui5src}}console.log("Use openui5 from ",f);b.setAttribute("src",f+"resources/sap-ui-core-nojQuery.js");b.setAttribute("data-sap-ui-libs",a.openui5libs||"sap.m, sap.ui.layout, sap.ui.unified, sap.ui.commons");b.setAttribute("data-sap-ui-theme","sap_belize");b.setAttribute("data-sap-ui-compatVersion","edge");b.setAttribute("data-sap-ui-preload","async");b.setAttribute("data-sap-ui-resourceroots",'{ "sap.ui.jsroot": "'+a.source_dir+'openui5/" }');b.setAttribute("data-sap-ui-evt-oninit","JSROOT.completeUI5Loading()");document.getElementsByTagName("head")[0].appendChild(b);a.Painter.createMenuNew=function(i,j){var k={painter:i,element:null,cnt:1,stack:[],items:[],separ:false};function h(o,p,n,m){var l=p.getSubmenu();o.write("<li ");var q="sapUiMnuItm";if(m.iItemNo==1){q+=" sapUiMnuItmFirst"}else{if(m.iItemNo==m.iTotalItems){q+=" sapUiMnuItmLast"}}if(!n.checkEnabled(p)){q+=" sapUiMnuItmDsbl"}if(p.getStartsSection()){q+=" sapUiMnuItmSepBefore"}o.writeAttribute("class",q);if(p.getTooltip_AsString()){o.writeAttributeEscaped("title",p.getTooltip_AsString())}o.writeElementData(p);if(m.bAccessible){o.writeAccessibilityState(p,{role:"menuitem",disabled:!n.checkEnabled(p),posinset:m.iItemNo,setsize:m.iTotalItems,labelledby:{value:this.getId()+"-txt "+this.getId()+"-scuttxt",append:true}});if(l){o.writeAttribute("aria-haspopup",true);o.writeAttribute("aria-owns",l.getId())}}o.write('><div class="sapUiMnuItmL"></div>');o.write('<div class="sapUiMnuItmIco">');if(p.getIcon()){o.writeIcon(p.getIcon(),null,{title:null})}o.write("</div>");o.write('<div id="'+this.getId()+'-txt" class="sapUiMnuItmTxt">');o.write(p.custom_html);o.write("</div>");o.write('<div id="'+this.getId()+'-scuttxt" class="sapUiMnuItmSCut"></div>');o.write('<div class="sapUiMnuItmSbMnu">');if(l){o.write('<div class="sapUiIconMirrorInRTL"></div>')}o.write("</div>");o.write('<div class="sapUiMnuItmR"></div>');o.write("</li>")}a.sap.ui.define(["sap/ui/unified/Menu","sap/ui/unified/MenuItem","sap/ui/unified/MenuItemBase"],function(m,n,l){k.add=function(p,o,u){if(p=="separator"){this.separ=true;return}if(p.indexOf("header:")==0){return this.items.push(new n("",{text:p.substr(7),enabled:false}))}if(p=="endsub:"){var t=this.stack.pop();t._item.setSubmenu(new m("",{items:this.items}));this.items=t._items;return}var q=false,s=null;if(p.indexOf("sub:")==0){p=p.substr(4);q=true}if(typeof o=="function"){u=o;o=p}if(p.indexOf("chk:")==0){p=p.substr(4);s=true}else{if(p.indexOf("unk:")==0){p=p.substr(4);s=false}}var r=new n("",{});if(!q&&(p.indexOf("<svg")==0)){r.custom_html=p;r.render=h}else{r.setText(p);if(this.separ){r.setStartsSection(true)}this.separ=false}if(s){r.setIcon("sap-icon://accept")}this.items.push(r);if(q){this.stack.push({_items:this.items,_item:r});this.items=[]}if(typeof u=="function"){r.menu_func=u;r.menu_arg=o}this.cnt++};k.addchk=function(p,q,o,r){return this.add((p?"chk:":"unk:")+q,o,r)};k.size=function(){return this.cnt-1};k.addDrawMenu=function(v,s,t){if(!s){s=[]}if(s.length==0){s.push("")}var o=false;if(v.indexOf("nosub:")==0){o=true;v=v.substr(6)}if(s.length===1){if(s[0]==="inspect"){v=v.replace("Draw","Inspect")}return this.add(v,s[0],t)}if(!o){this.add("sub:"+v,s[0],t)}for(var r=0;r<s.length;++r){var q=s[r];if(q==""){q="&lt;dflt&gt;"}var u=r+1;if((s.length>5)&&(q.length>0)){while((u<s.length)&&(s[u].indexOf(q)==0)){u++}}if(o){q=v+" "+q}if(u<r+2){this.add(q,s[r],t)}else{this.add("sub:"+q,s[r],t);for(var p=r+1;p<u;++p){this.add(s[p],s[p],t)}this.add("endsub:");r=u-1}}if(!o){this.add("endsub:")}};k.remove=function(){if(this.remove_bind){document.body.removeEventListener("click",this.remove_bind);this.remove_bind=null}if(this.element){this.element.destroy();if(this.close_callback){this.close_callback()}}this.element=null};k.remove_bind=k.remove.bind(k);k.show=function(q,r){this.remove();if(typeof r=="function"){this.close_callback=r}var o=sap.ui.getCore().byId("root_context_menu");if(o){o.destroy()}document.body.addEventListener("click",this.remove_bind);this.element=new m("root_context_menu",{items:this.items});this.element.attachItemSelect(null,this.menu_item_select,this);var p=sap.ui.core.Popup.Dock;this.element.open(false,null,p.BeginTop,p.BeginTop,null,q.clientX+" "+q.clientY)};k.menu_item_select=function(o){var p=o.getParameter("item");if(!p||!p.menu_func){return}if(this.painter){p.menu_func.bind(this.painter)(p.menu_arg)}else{p.menu_func(p.menu_arg)}};a.CallBack(j,k)});return k};a.TObjectPainter.prototype.ShowInpsector=function(){var i={};i.closeObjectInspector=function(){this.dialog.close();this.dialog.destroy()};i.dialog=a.sap.ui.xmlfragment("sap.ui.jsroot.view.Inspector",i);var h=sap.ui.getCore().byId("object_inspector");h.getController().setObject(this.GetObject());i.dialog.open()};a.TCanvasPainter.prototype.ShowGed=function(j){d.select("#ged_placeholder").text("");var h="CanvasGedId";var k=new a.sap.ui.model.json.JSONModel({handle:null});sap.ui.getCore().setModel(k,h);var i=sap.ui.getCore().byId(h);if(!i){i=a.sap.ui.xmlview({id:h,viewName:"sap.ui.jsroot.view.Ged"})}i.placeAt("ged_placeholder");this.RegisterForPadEvents(i.getController().padEventsReceiver.bind(i.getController()));this.SelectObjectPainter(j)};a.TCanvasPainter.prototype.CleanupGed=function(){this.RegisterForPadEvents(null);sap.ui.getCore().byId("CanvasGedId").getController().cleanupGed()};a.TCanvasPainter.prototype.openuiHasGed=function(){var h=a.sap.ui.getCore().byId("TopCanvasId");return h?h.getController().isGedEditor():false};a.TCanvasPainter.prototype.openuiActivateGed=function(i,j,k){var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().showGeEditor(true)}this.SelectObjectPainter(i);if(typeof this.ProcessChanges=="function"){this.ProcessChanges("sbits",this)}};a.TCanvasPainter.prototype.ActivateFitPanel=function(i){if(!this.use_openui){return}var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().showLeftArea("FitPanel")}};a.TCanvasPainter.prototype.openuiHasEventStatus=function(){var h=a.sap.ui.getCore().byId("TopCanvasId");return h?h.getController().isStatusShown():false};a.TCanvasPainter.prototype.openuiToggleEventStatus=function(){var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().toggleShowStatus()}};a.TCanvasPainter.prototype.fullShowStatus=function(i,l,k,j){var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().ShowCanvasStatus(i,l,k,j)}};a.TCanvasPainter.prototype.ShowUI5ProjectionArea=function(i,j){var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().showProjectionArea(i,j)}};a.TCanvasPainter.prototype.DrawInUI5ProjectionArea=function(k,i,j){var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().drawInProjectionArea(k,i,j)}};a.TCanvasPainter.prototype.ShowMessage=function(i){if(!this.use_openui){return a.progress(i,7000)}var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().showMessage(i)}};a.TCanvasPainter.prototype.fullShowSection=function(j,i){var h=a.sap.ui.getCore().byId("TopCanvasId");if(h){h.getController().showSection(j,i)}};a.TCanvasPainter.prototype.MethodsDialog=function(j,l,i){var h=a.sap.ui.getCore().byId("TopCanvasId");if(!h){return}var k=this;l.fClassName=j.GetClassName();if((i.indexOf("#x")>0)||(i.indexOf("#y")>0)||(i.indexOf("#z")>0)){l.fClassName="TAxis"}h.getController().showMethodsDialog(l,function(n){if(j.ExecuteMenuCommand(l,n)){return}var m=l.fExec;if(n){m=m.substr(0,m.length-1)+n+")"}console.log("execute method for object "+i+" exec= "+m);k.SendWebsocket("OBJEXEC:"+i+":"+m)})};if(a.v7&&a.v7.TCanvasPainter){a.v7.TCanvasPainter.prototype.ActivatePanel=function(i,j,k){var h=a.sap.ui.getCore().byId("TopCanvasId");if(!h){return a.CallBack(k,false)}h.getController().showPanelInLeftArea(i,j,k)}}return a}));