(function(f){if("function"===typeof define&&define.amd)define(["JSRootPainter","d3","JSRootMath"],f);else if("object"===typeof exports&&"undefined"!==typeof module)f(require("./JSRootCore.js"),require("d3"),require("./JSRootMath.js"));else{if("object"!=typeof d3)throw Error("This extension requires d3.js","JSRootPainter.more.js");if("undefined"==typeof JSROOT)throw Error("JSROOT is not defined","JSRootPainter.more.js");if("object"!=typeof JSROOT.Painter)throw Error("JSROOT.Painter not defined","JSRootPainter.more.js");
f(JSROOT,d3)}})(function(f,r){function y(a){f.TObjectPainter.call(this,a);this.bins=null}function p(a){f.TObjectPainter.call(this,a);this.axes_draw=!1;this.bins=null;this.xmin=this.ymin=this.xmax=this.ymax=0;this.wheel_zoomy=!0;this.is_bent="TGraphBentErrors"==a._typename;this.has_errors="TGraphErrors"==a._typename||"TGraphAsymmErrors"==a._typename||this.is_bent||a._typename.match(/^RooHist/)}function z(a){f.TooltipHandler.call(this,a);this.$polargram=!0;this.zoom_rmin=this.zoom_rmax=0}function w(a){f.TObjectPainter.call(this,
a)}function v(a){f.TObjectPainter.call(this,a);this.bins=null}function A(a){f.TObjectPainter.call(this,a)}function B(a){f.TObjectPainter.call(this,a);this.fBoundary="Normal"}function x(a){f.TObjectPainter.call(this,a);this.firstpainter=null;this.autorange=!1;this.painters=[]}function t(a,b){f.TObjectPainter.call(this,a,b);this.wheel_zoomy=!0}f.sources.push("more2d");y.prototype=Object.create(f.TObjectPainter.prototype);y.prototype.Eval=function(a){return this.GetObject().evalPar(a)};y.prototype.CreateBins=
function(a){var b=this.frame_painter(),c=0,d=0,e=this.GetObject();b&&!a&&(b.zoom_xmin!==b.zoom_xmax?(c=b.zoom_xmin,d=b.zoom_xmax):(c=b.xmin,d=b.xmax));if(0<e.fSave.length&&!this.nosave){b=e.fSave.length-2;a=e.fSave[b];var g=e.fSave[b+1];g=(g-a)/(b-1);for(var k=[],h=0;h<b;++h){var f=a+g*h;if(c===d||!(f+2*g<c||f-2*g>d)){var l=e.fSave[h];isNaN(l)||k.push({x:f,y:l})}}return k}a=e.fXmin;g=e.fXmax;var n=!1;c!==d&&(c>a&&(a=c),d<g&&(g=d));b&&b.logx&&0<a&&0<g&&(n=!0,a=Math.log(a),g=Math.log(g));b=Math.max(e.fNpx,
101);g=(g-a)/(b-1);k=[];for(h=0;h<b;h++)f=a+h*g,n&&(f=Math.exp(f)),l=this.Eval(f),isNaN(l)||k.push({x:f,y:l});return k};y.prototype.CreateDummyHisto=function(){var a=0,b=1,c=0,d=1,e=this.CreateBins(!0);e&&0<e.length&&(a=b=e[0].x,c=d=e[0].y,e.forEach(function(e){a=Math.min(e.x,a);b=Math.max(e.x,b);c=Math.min(e.y,c);d=Math.max(e.y,d)}),0<d&&(d*=1.05),0>c&&(c*=1.05));e=f.Create("TH1I");var g=this.GetObject();e.fName=g.fName+"_hist";e.fTitle=g.fTitle;e.fXaxis.fXmin=a;e.fXaxis.fXmax=b;e.fYaxis.fXmin=c;
e.fYaxis.fXmax=d;return e};y.prototype.ProcessTooltip=function(a){var b=!1;if(null===a||null===this.bins)b=!0;else if(0==this.bins.length||a.x<this.bins[0].grx||a.x>this.bins[this.bins.length-1].grx)b=!0;if(b)return null!==this.draw_g&&this.draw_g.select(".tooltip_bin").remove(),null;for(var c=1E5,d=-1,e=0;e<this.bins.length;++e)b=this.bins[e],b=Math.abs(b.grx-a.x),b<c&&(c=b,d=e);b=this.bins[d];e=this.draw_g.select(".tooltip_bin");c=this.lineatt.width+3;e.empty()&&(e=this.draw_g.append("svg:circle").attr("class",
"tooltip_bin").style("pointer-events","none").attr("r",c).call(this.lineatt.func).call(this.fillatt.func));c={name:this.GetObject().fName,title:this.GetObject().fTitle,x:b.grx,y:b.gry,color1:this.lineatt.color,color2:this.fillatt.fillcolor(),lines:[],exact:Math.abs(b.grx-a.x)<c&&Math.abs(b.gry-a.y)<c};c.changed=e.property("current_bin")!==d;c.menu=c.exact;c.menu_dist=Math.sqrt((b.grx-a.x)*(b.grx-a.x)+(b.gry-a.y)*(b.gry-a.y));c.changed&&e.attr("cx",b.grx).attr("cy",b.gry).property("current_bin",d);
a=this.GetTipName();0<a.length&&c.lines.push(a);(a=this.frame_painter())&&c.lines.push("x = "+a.AxisAsText("x",b.x)+" y = "+a.AxisAsText("y",b.y));return c};y.prototype.Redraw=function(){this.frame_width();var a=this.frame_height(),b=this.GetObject(),c=this.frame_painter(),d=this.main_painter();this.GetTipName("\n");this.CreateG(!0);this.bins=this.CreateBins(!1);this.createAttLine({attr:b});this.lineatt.used=!1;this.createAttFill({attr:b,kind:1});this.fillatt.used=!1;for(b=0;b<this.bins.length;++b){var e=
this.bins[b];e.grx=c.grx(e.x);e.gry=c.gry(e.y)}2<this.bins.length&&(b=a,void 0!==d.hmin&&0<=d.hmin&&(b=Math.round(c.gry(0)),b>a||0>b)&&(b=a),a=f.Painter.BuildSvgPath("bezier",this.bins,b,2),"none"!=this.lineatt.color&&this.draw_g.append("svg:path").attr("class","line").attr("d",a.path).style("fill","none").call(this.lineatt.func),this.fillatt.empty()||this.draw_g.append("svg:path").attr("class","area").attr("d",a.path+a.close).style("stroke","none").call(this.fillatt.func))};y.prototype.CanZoomIn=
function(a,b,c){if("x"!==a)return!1;a=this.GetObject();if(0<a.fSave.length){var d=a.fNpx;return Math.abs(a.fSave[d+1]-a.fSave[d+2])/d<Math.abs(b-c)}return!0};y.prototype.PerformDraw=function(){if(null===this.main_painter()){var a=this.CreateDummyHisto(),b=this;f.draw(this.divid,a,"AXIS",function(a){b.SetDivId(b.divid);b.Redraw();return b.DrawingReady()});return b}this.SetDivId(this.divid);this.Redraw();return this.DrawingReady()};p.prototype=Object.create(f.TObjectPainter.prototype);p.prototype.Redraw=
function(){this.DrawBins()};p.prototype.Cleanup=function(){delete this.interactive_bin;delete this.bins;f.TObjectPainter.prototype.Cleanup.call(this)};p.prototype.DecodeOptions=function(a){a||(a=this.main_painter()?"lp":"alp");"string"==typeof a&&0==a.indexOf("same ")&&(a=a.substr(5));var b=this.GetObject(),c=new f.DrawOptions(a);this.options||(this.options={});f.extend(this.options,{Line:0,Curve:0,Rect:0,Mark:0,Bar:0,OutRange:0,EF:0,Fill:0,NoOpt:0,MainError:1,Ends:1,Axis:"",PadStats:!1,PadTitle:!1,
original:a});a=this.options;a.PadStats=c.check("USE_PAD_STATS");a.PadTitle=c.check("USE_PAD_TITLE");a._pfc=c.check("PFC");a._plc=c.check("PLC");a._pmc=c.check("PMC");c.check("NOOPT")&&(a.NoOpt=1);c.check("L")&&(a.Line=1);c.check("F")&&(a.Fill=1);c.check("A")&&(a.Axis=c.check("I")?"A":"AXIS");c.check("X+")&&(a.Axis+="X+");c.check("Y+")&&(a.Axis+="Y+");c.check("RX")&&(a.Axis+="RX");c.check("RY")&&(a.Axis+="RY");c.check("C")&&(a.Curve=a.Line=1);c.check("*")&&(a.Mark=103);c.check("P0")&&(a.Mark=104);
c.check("P")&&(a.Mark=1);c.check("B")&&(a.Bar=1,a.Errors=0);c.check("Z")&&(a.Errors=1,a.Ends=0);c.check("||")&&(a.Errors=1,a.MainError=0,a.Ends=1);c.check("[]")&&(a.Errors=1,a.MainError=0,a.Ends=2);c.check("|>")&&(a.Errors=1,a.Ends=3);c.check(">")&&(a.Errors=1,a.Ends=4);c.check("0")&&(a.Mark=1,a.Errors=1,a.OutRange=1);c.check("1")&&1==a.Bar&&(a.Bar=2);c.check("2")&&(a.Rect=1,a.Errors=0);c.check("3")&&(a.EF=1,a.Errors=0);c.check("4")&&(a.EF=2,a.Errors=0);c.check("5")&&(a.Rect=2,a.Errors=0);c.check("X")&&
(a.Errors=0);void 0===a.Errors&&(a.Errors=this.has_errors?1:0);1==a.Mark&&1==b.fMarkerStyle&&(a.Mark=101);0==a.Line+a.Fill+a.Mark+a.Bar+a.EF+a.Rect+a.Errors&&c.empty()&&(a.Line=1);"TGraphErrors"==b._typename&&1E-300>r.max(b.fEX)&&1E-300>r.max(b.fEY)&&(a.Errors=0);if(a.Axis)0>a.Axis.indexOf("A")&&(a.Axis="AXIS,"+a.Axis);else if(c=this.root_pad(),!c||c.fPrimitives&&c.fPrimitives.arr[0]===b)a.Axis="AXIS";a.PadTitle&&(a.Axis+=";USE_PAD_TITLE");a.HOptions=a.Axis};p.prototype.CreateBins=function(){var a=
this.GetObject();if(a){var b=0,c=a.fNpoints;"TCutG"===a._typename&&3<c&&c--;if("TGraphErrors"==a._typename)b=1;else if("TGraphAsymmErrors"==a._typename||"TGraphBentErrors"==a._typename||a._typename.match(/^RooHist/))b=2;this.bins=[];for(var d=0;d<c;++d){var e={x:a.fX[d],y:a.fY[d],indx:d};switch(b){case 1:e.exlow=e.exhigh=a.fEX[d];e.eylow=e.eyhigh=a.fEY[d];break;case 2:e.exlow=a.fEXlow[d],e.exhigh=a.fEXhigh[d],e.eylow=a.fEYlow[d],e.eyhigh=a.fEYhigh[d]}this.bins.push(e);0===d&&(this.xmin=this.xmax=
e.x,this.ymin=this.ymax=e.y);0<b?(this.xmin=Math.min(this.xmin,e.x-e.exlow,e.x+e.exhigh),this.xmax=Math.max(this.xmax,e.x-e.exlow,e.x+e.exhigh),this.ymin=Math.min(this.ymin,e.y-e.eylow,e.y+e.eyhigh),this.ymax=Math.max(this.ymax,e.y-e.eylow,e.y+e.eyhigh)):(this.xmin=Math.min(this.xmin,e.x),this.xmax=Math.max(this.xmax,e.x),this.ymin=Math.min(this.ymin,e.y),this.ymax=Math.max(this.ymax,e.y))}}};p.prototype.CreateHistogram=function(a){var b=this.xmin,c=this.xmax,d=this.ymin,e=this.ymax,g=!0,k=!0;b>=
c&&(c=b+1);d>=e&&(e=d+1);var h=.1*(c-b),m=.1*(e-d),l=b-h;h=c+h;var n=d-m;e+=m;this.options.HOptions=this.options.Axis+";ymin:"+n+";ymax:"+e;0>l&&0<=b&&(l=.9*b);0<h&&0>=c&&(h=0);b=this.GetObject();-1111!=b.fMinimum&&(n=d=b.fMinimum);-1111!=b.fMaximum&&(e=b.fMaximum);0>n&&0<=d&&(n=.9*d);d=f.BIT(17);c=b.fHistogram;if(a)g=0<=a.indexOf("x"),k=0<=a.indexOf("y");else if(c){if(!b.TestBit(d))return c;b.InvertBit(d)}else b.fHistogram=c=f.CreateHistogram("TH1F",100),c.fName=b.fName+"_h",c.fTitle=b.fTitle,c.fBits|=
f.TH1StatusBits.kNoStats,this._own_histogram=!0;g&&(c.fXaxis.fXmin=l,c.fXaxis.fXmax=h);k&&(c.fYaxis.fXmin=n,c.fYaxis.fXmax=e,c.fMinimum=n,c.fMaximum=e);return c};p.prototype.UnzoomUserRange=function(a,b,c){c=this.GetObject();if(this._own_histogram||!c)return!1;c=c.fHistogram;if(!c)return!1;var d="";if(a&&c.fXaxis.fXmin>this.xmin||c.fXaxis.fXmax<this.xmax)d+="x";if(b&&c.fYaxis.fXmin>this.ymin||c.fYaxis.fXmax<this.ymax)d+="y";if(!d)return!1;this.CreateHistogram(d);(a=this.main_painter())&&a.CreateAxisFuncs(!1);
return!0};p.prototype.CanOptimize=function(){return 0<f.gStyle.OptimizeDraw&&!this.options.NoOpt};p.prototype.OptimizeBins=function(a,b){if(30>this.bins.length&&!b)return this.bins;var c=null;if("function"==typeof b)for(var d=0;d<this.bins.length;++d)b(this.bins[d],d)?c||(c=0==d?[]:this.bins.slice(0,d)):c&&c.push(this.bins[d]);c||(c=this.bins);a||(a=5E5);if(c.length<a||!this.CanOptimize())return c;a=Math.floor(c.length/a);2>a&&(a=2);b=[];for(d=0;d<c.length;d+=a)b.push(c[d]);return b};p.prototype.TooltipText=
function(a){var b=this.frame_painter(),c=[];c.push(this.GetTipName());a&&b&&(c.push("x = "+b.AxisAsText("x",a.x)),c.push("y = "+b.AxisAsText("y",a.y)),this.options.Errors&&"normal"==b.x_kind&&"exlow"in a&&(0!=a.exlow||0!=a.exhigh)&&c.push("error x = -"+b.AxisAsText("x",a.exlow)+"/+"+b.AxisAsText("x",a.exhigh)),(this.options.Errors||0<this.options.EF)&&"normal"==b.y_kind&&"eylow"in a&&(0!=a.eylow||0!=a.eyhigh)&&c.push("error y = -"+b.AxisAsText("y",a.eylow)+"/+"+b.AxisAsText("y",a.eyhigh)));return c};
p.prototype.get_main=function(){var a=this.frame_painter();if(a&&a.grx&&a.gry)return a;a={pad_layer:!0,pad:this.root_pad(),pw:this.pad_width(),ph:this.pad_height(),grx:function(a){a=this.pad.fLogx?0<a?f.log10(a):this.pad.fUxmin:(a-this.pad.fX1)/(this.pad.fX2-this.pad.fX1);return a*this.pw},gry:function(a){a=this.pad.fLogy?0<a?f.log10(a):this.pad.fUymin:(a-this.pad.fY1)/(this.pad.fY2-this.pad.fY1);return(1-a)*this.ph}};return a.pad?a:null};p.prototype.DrawBins=function(){var a=this,b=this.get_main(),
c=this.frame_width(),d=this.frame_height(),e=this.GetObject(),g=0,k=this.pad_painter();if(b){this.CreateG(!b.pad_layer);k&&(this.options._pfc||this.options._plc||this.options._pmc)&&(k=k.CreateAutoColor(this),this.options._pfc&&(e.fFillColor=k,delete this.fillatt),this.options._plc&&(e.fLineColor=k,delete this.lineatt),this.options._pmc&&(e.fMarkerColor=k,delete this.markeratt),this.options._pfc=this.options._plc=this.options._pmc=!1);this.createAttLine({attr:e,can_excl:!0});this.createAttFill({attr:e,
kind:1});this.fillatt.used=!1;this.draw_kind="none";this.marker_size=0;0!=this.lineatt.excl_side&&(g=this.lineatt.excl_width,0<this.lineatt.width&&(this.options.Line=1));k=null;if(this.options.EF){k=this.OptimizeBins(1<this.options.EF?5E3:0);for(var h=0;h<k.length;++h){var m=k[h];m.grx=b.grx(m.x);m.gry=b.gry(m.y-m.eylow)}var l=f.Painter.BuildSvgPath(1<this.options.EF?"bezier":"line",k),n=[];for(h=k.length-1;0<=h;--h)m=k[h],m.gry=b.gry(m.y+m.eyhigh),n.push(m);h=f.Painter.BuildSvgPath(1<this.options.EF?
"Lbezier":"Lline",n);this.draw_g.append("svg:path").attr("d",l.path+h.path+"Z").style("stroke","none").call(this.fillatt.func);this.draw_kind="lines"}if(1==this.options.Line||1==this.options.Fill||0!==g){n="";"TCutG"==e._typename&&(this.options.Fill=1);1==this.options.Fill&&(n="Z",g=0);k||(k=this.OptimizeBins(this.options.Curve?5E3:0));for(h=0;h<k.length;++h)m=k[h],m.grx=b.grx(m.x),m.gry=b.gry(m.y);h="line";1===this.options.Curve?h="bezier":0!==g&&(h+="calc");l=f.Painter.BuildSvgPath(h,k);if(0!==
g){var u=[];for(h=k.length-1;0<=h;--h){m=k[h];var D=Math.sqrt(m.dgrx*m.dgrx+m.dgry*m.dgry);m.grx+=g*m.dgry/D;m.gry-=g*m.dgrx/D;u.push(m)}h=f.Painter.BuildSvgPath("L"+(1===this.options.Curve?"bezier":"line"),u);this.draw_g.append("svg:path").attr("d",l.path+h.path+"Z").style("stroke","none").call(this.fillatt.func).style("opacity",.75)}if(this.options.Line||this.options.Fill)h=this.draw_g.append("svg:path").attr("d",l.path+n),this.options.Line?h.call(this.lineatt.func):h.style("stroke","none"),this.options.Fill?
h.call(this.fillatt.func):h.style("fill","none");this.draw_kind="lines"}g=null;if(this.options.Errors||this.options.Rect||this.options.Bar)k=this.OptimizeBins(5E3,function(g,k){var h=b.grx(g.x);if(!a.options.Bar&&(0>h||h>c))return!0;var f=b.gry(g.y);if(!a.options.Bar&&!a.options.OutRange&&(0>f||f>d))return!0;g.grx1=Math.round(h);g.gry1=Math.round(f);a.has_errors&&(g.grx0=Math.round(b.grx(g.x-g.exlow)-h),g.grx2=Math.round(b.grx(g.x+g.exhigh)-h),g.gry0=Math.round(b.gry(g.y-g.eylow)-f),g.gry2=Math.round(b.gry(g.y+
g.eyhigh)-f),a.is_bent?(g.grdx0=Math.round(b.gry(g.y+e.fEXlowd[k])-f),g.grdx2=Math.round(b.gry(g.y+e.fEXhighd[k])-f),g.grdy0=Math.round(b.grx(g.x+e.fEYlowd[k])-h),g.grdy2=Math.round(b.grx(g.x+e.fEYhighd[k])-h)):g.grdx0=g.grdx2=g.grdy0=g.grdy2=0);return!1}),this.draw_kind="nodes",g=this.draw_g.selectAll(".grpoint").data(k).enter().append("svg:g").attr("class","grpoint").attr("transform",function(a){return"translate("+a.grx1+","+a.gry1+")"});if(this.options.Bar){for(h=1;h<k.length-1;++h)k[h].width=
Math.max(2,(k[h+1].grx1-k[h-1].grx1)/2-2);switch(k.length){case 0:break;case 1:k[0].width=c/4;break;case 2:k[0].width=k[1].width=(k[1].grx1-k[0].grx1)/2;break;default:k[0].width=k[1].width,k[k.length-1].width=k[k.length-2].width}var C=Math.round(b.gry(0));g.append("svg:rect").attr("x",function(a){return Math.round(-a.width/2)}).attr("y",function(b){b.bar=!0;return 1!==a.options.Bar?0:b.gry1>C?C-b.gry1:0}).attr("width",function(a){return Math.round(a.width)}).attr("height",function(b){return 1!==a.options.Bar?
d>b.gry1?d-b.gry1:0:Math.abs(C-b.gry1)}).call(this.fillatt.func)}this.options.Rect&&g.filter(function(a){return 0<a.exlow&&0<a.exhigh&&0<a.eylow&&0<a.eyhigh}).append("svg:rect").attr("x",function(a){a.rect=!0;return a.grx0}).attr("y",function(a){return a.gry2}).attr("width",function(a){return a.grx2-a.grx0}).attr("height",function(a){return a.gry0-a.gry2}).call(this.fillatt.func).call(2===this.options.Rect?this.lineatt.func:function(){});this.error_size=0;if(this.options.Errors){var q=this.lineatt.width+
f.gStyle.fEndErrorSize;h=0;h=this.options.Ends?"m0,"+q+"v-"+2*q:"";l=this.options.Ends?"m"+q+",0h-"+2*q:"";var p=h,r=h,t=l,v=l,w=this.options.MainError?"M0,0L":"M";switch(this.options.Ends){case 2:h=Math.max(this.lineatt.width+1,Math.round(.66*q));p="m"+h+","+q+"h-"+h+"v-"+2*q+"h"+h;r="m-"+h+","+q+"h"+h+"v-"+2*q+"h-"+h;t="m-"+q+","+h+"v-"+h+"h"+2*q+"v"+h;v="m-"+q+",-"+h+"v"+h+"h"+2*q+"v-"+h;break;case 3:q=Math.max(q,Math.round(5.28*e.fMarkerSize));h=Math.max(this.lineatt.width+1,Math.round(.66*q));
p="l"+h+","+q+"v-"+2*q+"l-"+h+","+q;r="l-"+h+","+q+"v-"+2*q+"l"+h+","+q;t="l-"+q+","+h+"h"+2*q+"l-"+q+",-"+h;v="l-"+q+",-"+h+"h"+2*q+"l-"+q+","+h;break;case 4:q=Math.max(q,Math.round(5.28*e.fMarkerSize)),h=Math.max(this.lineatt.width+1,Math.round(.66*q)),p="l"+h+","+q+"m0,-"+2*q+"l-"+h+","+q,r="l-"+h+","+q+"m0,-"+2*q+"l"+h+","+q,t="l-"+q+","+h+"m"+2*q+",0l-"+q+",-"+h,v="l-"+q+",-"+h+"m"+2*q+",0l-"+q+","+h}this.error_size=q;q=Math.floor((this.lineatt.width-1)/2);h=g.filter(function(a){return 0<a.exlow||
0<a.exhigh||0<a.eylow||0<a.eyhigh});!f.BatchMode&&0<f.gStyle.Tooltip&&h.append("svg:path").style("stroke","none").style("fill","none").style("pointer-events","visibleFill").attr("d",function(a){return"M"+a.grx0+","+a.gry0+"h"+(a.grx2-a.grx0)+"v"+(a.gry2-a.gry0)+"h"+(a.grx0-a.grx2)+"z"});h.append("svg:path").call(this.lineatt.func).style("fill","none").attr("d",function(a){a.error=!0;return(0<a.exlow?w+(a.grx0+q)+","+a.grdx0+p:"")+(0<a.exhigh?w+(a.grx2-q)+","+a.grdx2+r:"")+(0<a.eylow?w+a.grdy0+","+
(a.gry0-q)+v:"")+(0<a.eyhigh?w+a.grdy2+","+(a.gry2+q)+t:"")})}if(this.options.Mark){l="";this.createAttMarker({attr:e,style:this.options.Mark-100});this.marker_size=this.markeratt.GetFullSize();this.markeratt.reset_pos();h=1E6/(this.markeratt.MarkerLength()+7);m=1;k?this.CanOptimize()&&k.length>1.5*h&&(m=Math.min(2,Math.round(k.length/h))):k=this.OptimizeBins(h);for(h=0;h<k.length;h+=m)u=k[h],n=b.grx(u.x),n>-this.marker_size&&n<c+this.marker_size&&(u=b.gry(u.y),u>-this.marker_size&&u<d+this.marker_size&&
(l+=this.markeratt.create(n,u)));0<l.length&&(this.draw_g.append("svg:path").attr("d",l).call(this.markeratt.func),null===g&&"none"==this.draw_kind&&(this.draw_kind=101==this.options.Mark?"path":"mark"))}}};p.prototype.ExtractTooltip=function(a){if(!a)return null;if("lines"==this.draw_kind||"path"==this.draw_kind||"mark"==this.draw_kind)return this.ExtractTooltipForPath(a);if("nodes"!=this.draw_kind)return null;this.frame_width();var b=this.frame_height(),c=this.frame_painter(),d=this,e=null,g=1E10,
k=null,h=this.marker_size?Math.round(this.marker_size/2+1.5):0;this.draw_g.selectAll(".grpoint").each(function(){var f=r.select(this).datum();if(void 0!==f){var m=Math.pow(a.x-f.grx1,2);1===a.nproc&&(m+=Math.pow(a.y-f.gry1,2));if(!(m>=g)){if(f.error||f.rect||f.marker)var l={x1:Math.min(-d.error_size,f.grx0,-h),x2:Math.max(d.error_size,f.grx2,h),y1:Math.min(-d.error_size,f.gry2,-h),y2:Math.max(d.error_size,f.gry0,h)};else if(f.bar){if(l={x1:-f.width/2,x2:f.width/2,y1:0,y2:b-f.gry1},1===d.options.Bar){var p=
c.gry(0);l.y1=f.gry1>p?p-f.gry1:0;l.y2=f.gry1>p?0:p-f.gry1}}else l={x1:-5,x2:5,y1:-5,y2:5};p=a.x>=f.grx1+l.x1&&a.x<=f.grx1+l.x2;f=a.y>=f.gry1+l.y1&&a.y<=f.gry1+l.y2;p&&(f||1<a.nproc)&&(g=m,e=this,k=l,k.exact=p&&f)}}});if(null===e)return null;var f=r.select(e).datum(),l={name:this.GetObject().fName,title:this.GetObject().fTitle,x:f.grx1,y:f.gry1,color1:this.lineatt.color,lines:this.TooltipText(f),rect:k,d3bin:e};this.fillatt&&this.fillatt.used&&!this.fillatt.empty()&&(l.color2=this.fillatt.fillcolor());
k.exact&&(l.exact=!0);l.menu=l.exact;l.menu_dist=3;l.bin=f;l.binindx=f.indx;return l};p.prototype.ShowTooltip=function(a){if(a){if(a.usepath)return this.ShowTooltipForPath(a);var b=r.select(a.d3bin).datum(),c=this.draw_g.select(".tooltip_bin");c.empty()&&(c=this.draw_g.append("svg:rect").attr("class","tooltip_bin h1bin").style("pointer-events","none"));a.changed=c.property("current_bin")!==a.d3bin;a.changed&&c.attr("x",b.grx1+a.rect.x1).attr("width",a.rect.x2-a.rect.x1).attr("y",b.gry1+a.rect.y1).attr("height",
a.rect.y2-a.rect.y1).style("opacity","0.3").property("current_bin",a.d3bin)}else this.draw_g&&this.draw_g.select(".tooltip_bin").remove()};p.prototype.ProcessTooltip=function(a){var b=this.ExtractTooltip(a);a&&a.disabled||this.ShowTooltip(b);return b};p.prototype.FindBestBin=function(a){if(!this.bins)return null;var b="lines"==this.draw_kind,c=-1,d=null,e=1E10,g=this.frame_painter(),k;for(k=0;k<this.bins.length;++k){var h=this.bins[k];var f=g.grx(h.x);var l=g.gry(h.y);l=(a.x-f)*(a.x-f)+(a.y-l)*(a.y-
l);l<e&&(e=l,d=h,c=k)}100<e&&b&&(d=null);var n=Math.max(this.lineatt.width+3,4);0<this.marker_size&&(n=Math.max(this.marker_size,n));d&&(e=Math.sqrt(Math.pow(a.x-g.grx(d.x),2)+Math.pow(a.y-g.gry(d.y),2)));!b&&e>n&&(d=null);d||(c=-1);c={bin:d,indx:c,dist:e,radius:Math.round(n)};if(!d&&b){b=function(a,b,c){return b>=a&&a>=c||b<=a&&a<=c};e=1E4;l=this.bins[0];var u=g.grx(l.x);d=0;for(k=1;k<this.bins.length;++k){h=this.bins[k];f=g.grx(h.x);if(b(a.x,u,f)){var p=g.gry(l.y);l=g.gry(h.y);1>Math.abs(f-u)?(d=
a.y,l=b(a.y,p,l)?0:Math.min(Math.abs(a.y-p),Math.abs(a.y-l))):(d=p+(a.x-u)/(f-u)*(l-p),l=Math.abs(d-a.y));l<e&&(e=l,c.linex=a.x,c.liney=d)}l=h;u=f}e<.5*n&&(c.linedist=e,c.closeline=!0)}return c};p.prototype.TestEditable=function(a){var b=this.GetObject(),c=f.BIT(18);if(!b)return!1;a&&b.InvertBit(c);return!b.TestBit(c)};p.prototype.ExtractTooltipForPath=function(a){if(null===this.bins)return null;var b=this.FindBestBin(a);if(!b||!b.bin&&!b.closeline)return null;var c="lines"==this.draw_kind,d="mark"==
this.draw_kind,e=this.frame_painter(),g=this.GetObject(),k={name:g.fName,title:g.fTitle,x:b.bin?e.grx(b.bin.x):b.linex,y:b.bin?e.gry(b.bin.y):b.liney,color1:this.lineatt.color,lines:this.TooltipText(b.bin),usepath:!0};k.ismark=d;k.islines=c;b.closeline?(k.menu=k.exact=!0,k.menu_dist=b.linedist):b.bin&&(this.options.EF&&c?(k.gry1=e.gry(b.bin.y-b.bin.eylow),k.gry2=e.gry(b.bin.y+b.bin.eyhigh)):k.gry1=k.gry2=e.gry(b.bin.y),k.binindx=b.indx,k.bin=b.bin,k.radius=b.radius,k.exact=Math.abs(a.x-k.x)<=b.radius&&
(Math.abs(a.y-k.gry1)<=b.radius||Math.abs(a.y-k.gry2)<=b.radius),k.menu=k.exact,k.menu_dist=Math.sqrt((a.x-k.x)*(a.x-k.x)+Math.pow(Math.min(Math.abs(a.y-k.gry1),Math.abs(a.y-k.gry2)),2)));this.fillatt&&this.fillatt.used&&!this.fillatt.empty()&&(k.color2=this.fillatt.fillcolor());c||(k.color1=this.get_color(g.fMarkerColor),k.color2||(k.color2=k.color1));return k};p.prototype.ShowTooltipForPath=function(a){var b=this.draw_g.select(".tooltip_bin");a&&a.bin?(b.empty()&&(b=this.draw_g.append("svg:g").attr("class",
"tooltip_bin")),a.changed=b.property("current_bin")!==a.bin,a.changed&&(b.selectAll("*").remove(),b.property("current_bin",a.bin),a.ismark?b.append("svg:rect").attr("class","h1bin").style("pointer-events","none").style("opacity","0.3").attr("x",Math.round(a.x-a.radius)).attr("y",Math.round(a.y-a.radius)).attr("width",2*a.radius).attr("height",2*a.radius):(b.append("svg:circle").attr("cy",Math.round(a.gry1)),1<Math.abs(a.gry1-a.gry2)&&b.append("svg:circle").attr("cy",Math.round(a.gry2)),b=b.selectAll("circle").attr("r",
a.radius).attr("cx",Math.round(a.x)),a.islines?(this.options.Line?b.call(this.lineatt.func):b.style("stroke","black"),this.options.Fill?b.call(this.fillatt.func):b.style("fill","none")):b.style("stroke","black"==a.color1?"green":"black").style("fill","none")))):b.remove()};p.prototype.moveStart=function(a,b){this.pos_dx=this.pos_dy=0;var c=this.ExtractTooltip({x:a,y:b});c&&c.exact&&void 0!==c.binindx?(this.move_binindx=c.binindx,this.move_bin=c.bin,this.move_x0=(c=this.frame_painter())?c.grx(this.move_bin.x):
a,this.move_y0=c?c.gry(this.move_bin.y):b):delete this.move_binindx};p.prototype.moveDrag=function(a,b){this.pos_dx+=a;this.pos_dy+=b;void 0===this.move_binindx?this.draw_g.attr("transform","translate("+this.pos_dx+","+this.pos_dy+")"):(a=this.frame_painter())&&this.move_bin&&(this.move_bin.x=a.RevertX(this.move_x0+this.pos_dx),this.move_bin.y=a.RevertY(this.move_y0+this.pos_dy),this.DrawBins())};p.prototype.moveEnd=function(a){var b="";if(void 0===this.move_binindx){this.draw_g.attr("transform",
null);var c=this.frame_painter();if(c&&this.bins&&!a){for(var d=0;d<this.bins.length;++d){var e=this.bins[d];e.x=c.RevertX(c.grx(e.x)+this.pos_dx);e.y=c.RevertY(c.gry(e.y)+this.pos_dy);b+="SetPoint("+e.indx+","+e.x+","+e.y+");;";0==e.indx&&this.MatchObjectType("TCutG")&&(b+="SetPoint("+(this.GetObject().fNpoints-1)+","+e.x+","+e.y+");;")}this.DrawBins()}}else b="SetPoint("+this.move_bin.indx+","+this.move_bin.x+","+this.move_bin.y+")",0==this.move_bin.indx&&this.MatchObjectType("TCutG")&&(b+=";;SetPoint("+
(this.GetObject().fNpoints-1)+","+this.move_bin.x+","+this.move_bin.y+")"),delete this.move_binindx;b&&!a&&this.WebCanvasExec(b)};p.prototype.FillContextMenu=function(a){f.TObjectPainter.prototype.FillContextMenu.call(this,a);this.snapid||a.addchk(this.TestEditable(),"Editable",this.TestEditable.bind(this,!0));return 0<a.size()};p.prototype.ExecuteMenuCommand=function(a,b){if(f.TObjectPainter.prototype.ExecuteMenuCommand.call(this,a,b))return!0;b=this.canv_painter();var c=this.frame_painter();if("RemovePoint"==
a.fName||"InsertPoint"==a.fName){var d=c?c.GetLastEventPos():null;if(!b||b._readonly||!c||!d)return!0;c=this.ExtractTooltip(d);"InsertPoint"==a.fName?(a=(c=this.frame_painter())&&c.RevertX?c.RevertX(d.x):0,d=c&&c.RevertY?c.RevertY(d.y):0,b.ShowMessage("InsertPoint("+a.toFixed(3)+","+d.toFixed(3)+") not yet implemented")):this.args_menu_id&&c&&void 0!==c.binindx&&this.WebCanvasExec("RemovePoint("+c.binindx+")",this.args_menu_id);return!0}return!1};p.prototype.UpdateObject=function(a,b){if(!this.MatchObjectType(a))return!1;
void 0!==b&&b!=this.options.original&&this.DecodeOptions(b);b=this.GetObject();b.fBits=a.fBits;b.fTitle=a.fTitle;b.fX=a.fX;b.fY=a.fY;b.fNpoints=a.fNpoints;this.CreateBins();if(this.axes_draw){var c=this.main_painter();this.frame_painter().zoom_changed_interactive||c.UpdateObject(a.fHistogram||this.CreateHistogram());c.GetObject().fTitle=b.fTitle}return!0};p.prototype.CanZoomIn=function(a,b,c){var d=this.GetObject();if(null===d||"x"!==a)return!1;for(a=0;a<d.fNpoints;++a)if(b<d.fX[a]&&d.fX[a]<c)return!0;
return!1};p.prototype.ButtonClick=function(a){if("ToggleZoom"!==a)return!1;a=this.frame_painter();if(!a||this.xmin===this.xmax&&this.ymin===this.ymax)return!1;a.Zoom(this.xmin,this.xmax,this.ymin,this.ymax);return!0};p.prototype.FindFunc=function(){var a=this.GetObject();if(a&&a.fFunctions)for(var b=0;b<a.fFunctions.arr.length;++b){var c=a.fFunctions.arr[b];if("TF1"==c._typename||"TF2"==c._typename)return c}return null};p.prototype.FindStat=function(){var a=this.GetObject();if(a&&a.fFunctions)for(var b=
0;b<a.fFunctions.arr.length;++b){var c=a.fFunctions.arr[b];if("TPaveStats"==c._typename&&"stats"==c.fName)return c}return null};p.prototype.CreateStat=function(){var a=this.FindFunc();if(!a)return null;var b=this.FindStat();if(b)return b;if((b=this.canv_painter())&&b.normal_canvas||this.options.PadStats)return null;this.create_stats=!0;var c=f.gStyle;b=f.Create("TPaveStats");f.extend(b,{fName:"stats",fOptStat:0,fOptFit:c.fOptFit||111,fBorderSize:1});b.fX1NDC=c.fStatX-c.fStatW;b.fY1NDC=c.fStatY-c.fStatH;
b.fX2NDC=c.fStatX;b.fY2NDC=c.fStatY;b.fFillColor=c.fStatColor;b.fFillStyle=c.fStatStyle;b.fTextAngle=0;b.fTextSize=c.fStatFontSize;b.fTextAlign=12;b.fTextColor=c.fStatTextColor;b.fTextFont=c.fStatFont;b.AddText(a.fName);this.GetObject().fFunctions.Add(b);return b};p.prototype.FillStatistic=function(a,b,c){b=this.FindFunc();if(!b||!c||!this.create_stats)return!1;a.ClearPave();a.FillFunctionStat(b,c);return!0};p.prototype.DrawNextFunction=function(a,b){var c=this.GetObject();if(!c.fFunctions||a>=c.fFunctions.arr.length)return f.CallBack(b);
var d=c.fFunctions.arr[a];c=c.fFunctions.opt[a];d.$main_painter=this;f.draw(this.divid,d,c,this.DrawNextFunction.bind(this,a+1,b))};p.prototype.PerformDrawing=function(a,b){b&&(this.axes_draw=!0,this._own_histogram||(this.$primary=!0),b.$secondary=!0);this.SetDivId(a);this.DrawBins();this.TestEditable()&&this.AddMove();this.DrawNextFunction(0,this.DrawingReady.bind(this));return this};z.prototype=Object.create(f.TooltipHandler.prototype);z.prototype.translate=function(a,b,c){b=this.r(b);var d=b/this.szx*
this.szy;a={x:b*Math.cos(-a-this.angle),y:d*Math.sin(-a-this.angle),rx:b,ry:d};c||(a.x=Math.round(a.x),a.y=Math.round(a.y),a.rx=Math.round(a.rx),a.ry=Math.round(a.ry));return a};z.prototype.format=function(a){return a===Math.round(a)?a.toString():10<this.ndig?a.toExponential(4):a.toFixed(0<this.ndig?this.ndig:0)};z.prototype.AxisAsText=function(a,b){if("r"==a)return b===Math.round(b)?b.toString():10<this.ndig?b.toExponential(4):b.toFixed(this.ndig+2);b*=180/Math.PI;return b===Math.round(b)?b.toString():
b.toFixed(1)};z.prototype.MouseEvent=function(a){var b=this.svg_layer("primitives_layer").select(".interactive_ellipse");if(!b.empty()){var c=null;"leave"!==a&&(a=r.mouse(b.node()),c={x:a[0],y:a[1],touch:!1});this.ProcessTooltipEvent(c)}};z.prototype.GetFrameRect=function(){var a=this.root_pad(),b=this.pad_width(),c=this.pad_height(),d={};d.szx=Math.round(Math.max(.1,.5-Math.max(a.fLeftMargin,a.fRightMargin))*b);d.szy=Math.round(Math.max(.1,.5-Math.max(a.fBottomMargin,a.fTopMargin))*c);d.width=2*
d.szx;d.height=2*d.szy;d.midx=Math.round(b/2);d.midy=Math.round(c/2);d.x=d.midx-d.szx;d.y=d.midy-d.szy;d.hint_delta_x=d.szx;d.hint_delta_y=d.szy;d.transform="translate("+d.x+","+d.y+")";return d};z.prototype.MouseWheel=function(){r.event.stopPropagation();r.event.preventDefault();this.ProcessTooltipEvent(null);var a=this.GetObject();if(r.event&&a){var b=r.event.wheelDelta?-r.event.wheelDelta:r.event.deltaY||r.event.detail;if(b){var c=this.scale_rmin,d=this.scale_rmax;d+=(0>b?-.2:.2)*(d-c);if(c<a.fRwrmin||
d>a.fRwrmax)c=d=0;if(this.zoom_rmin!=c||this.zoom_rmax!=d)this.zoom_rmin=c,this.zoom_rmax=d,this.RedrawPad()}}};z.prototype.Redraw=function(){if(this.is_main_painter()){this.root_pad();var a=this.GetObject(),b=this.GetFrameRect();this.CreateG();this.draw_g.attr("transform","translate("+b.midx+","+b.midy+")");this.szx=b.szx;this.szy=b.szy;this.scale_rmin=a.fRwrmin;this.scale_rmax=a.fRwrmax;this.zoom_rmin!=this.zoom_rmax&&(this.scale_rmin=this.zoom_rmin,this.scale_rmax=this.zoom_rmax);this.r=r.scaleLinear().domain([this.scale_rmin,
this.scale_rmax]).range([0,this.szx]);this.angle=a.fAxisAngle||0;var c=this.r.ticks(5);b=Math.floor(a.fNdivRad%1E4/100);this.createAttLine({attr:a});this.gridatt||(this.gridatt=new f.TAttLineHandler({color:a.fLineColor,style:2,width:1}));var d=Math.abs(a.fRwrmax-a.fRwrmin);this.ndig=0>=d?-3:Math.round(f.log10(c.length/d));var e=[];for(d=0;d<c.length;){var g=this.format(c[d]);if(0<=e.indexOf(g)){if(10<++this.ndig)break;e=[];d=0}else e.push(g),d++}e=!1;c[c.length-1]<a.fRwrmax&&this.zoom_rmin==this.zoom_rmax&&
(c.push(a.fRwrmax),e=!0);this.StartTextDrawing(a.fRadialLabelFont,Math.round(a.fRadialTextSize*this.szy*2));for(d=0;d<c.length;++d){var k=this.r(c[d]),h=k/this.szx*this.szy;this.draw_g.append("ellipse").attr("cx",0).attr("cy",0).attr("rx",Math.round(k)).attr("ry",Math.round(h)).style("fill","none").call(this.lineatt.func);(d<c.length-1||!e)&&this.DrawText({align:23,x:Math.round(k),y:Math.round(a.fRadialTextSize*this.szy*.5),text:this.format(c[d]),color:this.get_color[a.fRadialLabelColor],latex:0});
if(1<b&&(d<c.length-1||!e)){g=(c[1]-c[0])/b;for(var m=1;m<b;++m){k=c[d]+g*m;if(k>this.scale_rmax)break;k=this.r(k);h=k/this.szx*this.szy;this.draw_g.append("ellipse").attr("cx",0).attr("cy",0).attr("rx",Math.round(k)).attr("ry",Math.round(h)).style("fill","none").call(this.gridatt.func)}}}this.FinishTextDrawing();b=Math.round(a.fPolarTextSize*this.szy*2);this.StartTextDrawing(a.fPolarLabelFont,b);c=a.fNdivPol%100;8!==c&&3!==c&&(c=8);e=8==c?"0 #frac{#pi}{4} #frac{#pi}{2} #frac{3#pi}{4} #pi #frac{5#pi}{4} #frac{3#pi}{2} #frac{7#pi}{4}".split(" "):
["0","#frac{2#pi}{3}","#frac{4#pi}{3}"];m=[12,11,21,31,32,33,23,13];for(d=0;d<c;++d)g=2*-d*Math.PI/c-this.angle,this.draw_g.append("line").attr("x1",0).attr("y1",0).attr("x2",Math.round(this.szx*Math.cos(g))).attr("y2",Math.round(this.szy*Math.sin(g))).call(this.lineatt.func),this.DrawText({align:m[Math.round(16-g/Math.PI*4)%8],x:Math.round((this.szx+b)*Math.cos(g)),y:Math.round((this.szy+b/this.szx*this.szy)*Math.sin(g)),text:e[d],color:this.get_color[a.fPolarLabelColor],latex:1});this.FinishTextDrawing();
b=Math.floor(a.fNdivPol%1E4/100);if(1<b)for(d=0;d<c*b;++d)0!==d%b&&(g=2*-d*Math.PI/c/b-this.angle,this.draw_g.append("line").attr("x1",0).attr("y1",0).attr("x2",Math.round(this.szx*Math.cos(g))).attr("y2",Math.round(this.szy*Math.sin(g))).call(this.gridatt.func));if(!f.BatchMode&&(a=this.svg_layer("primitives_layer"),b=a.select(".interactive_ellipse"),b.empty()&&(b=a.append("g").classed("most_upper_primitives",!0).append("ellipse").classed("interactive_ellipse",!0).attr("cx",0).attr("cy",0).style("fill",
"none").style("pointer-events","visibleFill").on("mouseenter",this.MouseEvent.bind(this,"enter")).on("mousemove",this.MouseEvent.bind(this,"move")).on("mouseleave",this.MouseEvent.bind(this,"leave"))),b.attr("rx",this.szx).attr("ry",this.szy),r.select(b.node().parentNode).attr("transform",this.draw_g.attr("transform")),f.gStyle.Zooming&&f.gStyle.ZoomWheel))b.on("wheel",this.MouseWheel.bind(this))}};w.prototype=Object.create(f.TObjectPainter.prototype);w.prototype.Redraw=function(){this.DrawBins()};
w.prototype.DecodeOptions=function(a){var b=new f.DrawOptions(a||"L");this.options||(this.options={});f.extend(this.options,{mark:b.check("P"),err:b.check("E"),fill:b.check("F"),line:b.check("L"),curve:b.check("C")});this.OptionsStore(a)};w.prototype.DrawBins=function(){var a=this.GetObject(),b=this.main_painter();if(a&&b&&b.$polargram){this.options.mark&&this.createAttMarker({attr:a});(this.options.err||this.options.line||this.options.curve)&&this.createAttLine({attr:a});this.options.fill&&this.createAttFill({attr:a});
this.CreateG();this.draw_g.attr("transform",b.draw_g.attr("transform"));for(var c="",d="",e="",g=[],k=0;k<a.fNpoints;++k)if(!(a.fY[k]>b.scale_rmax)){if(this.options.err){var h=b.translate(a.fX[k],a.fY[k]-a.fEY[k]),m=b.translate(a.fX[k],a.fY[k]+a.fEY[k]);d+="M"+h.x+","+h.y+"L"+m.x+","+m.y;h=b.translate(a.fX[k]+a.fEX[k],a.fY[k]);m=b.translate(a.fX[k]-a.fEX[k],a.fY[k]);d+="M"+h.x+","+h.y+"A"+m.rx+","+m.ry+",0,0,1,"+m.x+","+m.y}h=b.translate(a.fX[k],a.fY[k]);this.options.mark&&(c+=this.markeratt.create(h.x,
h.y));if(this.options.line||this.options.fill)e+=(e?"L":"M")+h.x+","+h.y;this.options.curve&&(h.grx=h.x,h.gry=h.y,g.push(h))}this.options.fill&&e&&this.draw_g.append("svg:path").attr("d",e+"Z").style("stroke","none").call(this.fillatt.func);this.options.line&&e&&this.draw_g.append("svg:path").attr("d",e).style("fill","none").call(this.lineatt.func);this.options.curve&&g.length&&this.draw_g.append("svg:path").attr("d",f.Painter.BuildSvgPath("bezier",g).path).style("fill","none").call(this.lineatt.func);
d&&this.draw_g.append("svg:path").attr("d",d).style("fill","none").call(this.lineatt.func);c&&this.draw_g.append("svg:path").attr("d",c).call(this.markeratt.func)}};w.prototype.CreatePolargram=function(){for(var a=f.Create("TGraphPolargram"),b=this.GetObject(),c=b.fY[0]||0,d=c,e=0;e<b.fNpoints;++e)c=Math.min(c,b.fY[e]-b.fEY[e]),d=Math.max(d,b.fY[e]+b.fEY[e]);a.fRwrmin=c-.1*(d-c);a.fRwrmax=d+.1*(d-c);return a};w.prototype.ExtractTooltip=function(a){if(!a)return null;for(var b=this.GetObject(),c=this.main_painter(),
d=1E10,e=-1,g=null,k=0;k<b.fNpoints;++k){var h=c.translate(b.fX[k],b.fY[k]),f=(h.x-a.x)*(h.x-a.x)+(h.y-a.y)*(h.y-a.y);f<d&&(d=f,e=k,g=h)}a=5;this.markeratt&&this.markeratt.used&&(a=this.markeratt.GetFullSize());if(Math.sqrt(d)>a)return null;d={name:this.GetObject().fName,title:this.GetObject().fTitle,x:g.x,y:g.y,color1:this.markeratt&&this.markeratt.used?this.markeratt.color:this.lineatt.color,exact:4>Math.sqrt(d),lines:[this.GetTipName()],binindx:e,menu_dist:a,radius:a};d.lines.push("r = "+c.AxisAsText("r",
b.fY[e]));d.lines.push("phi = "+c.AxisAsText("phi",b.fX[e]));b.fEY&&b.fEY[e]&&d.lines.push("error r = "+c.AxisAsText("r",b.fEY[e]));b.fEX&&b.fEX[e]&&d.lines.push("error phi = "+c.AxisAsText("phi",b.fEX[e]));return d};w.prototype.ShowTooltip=function(a){if(this.draw_g){var b=this.draw_g.select(".tooltip_bin");a?(b.empty()&&(b=this.draw_g.append("svg:ellipse").attr("class","tooltip_bin").style("pointer-events","none")),a.changed=b.property("current_bin")!==a.binindx,a.changed&&b.attr("cx",a.x).attr("cy",
a.y).attr("rx",Math.round(a.radius)).attr("ry",Math.round(a.radius)).style("fill","none").style("stroke",a.color1).property("current_bin",a.binindx)):b.remove()}};w.prototype.ProcessTooltip=function(a){var b=this.ExtractTooltip(a);a&&a.disabled||this.ShowTooltip(b);return b};w.prototype.PerformDrawing=function(a){this.SetDivId(a);this.DrawBins();this.DrawingReady()};v.prototype=Object.create(f.TObjectPainter.prototype);v.prototype.UpdateObject=function(a,b){var c=this.GetObject();if(c._typename!=
a._typename)return!1;c!==a&&f.extend(c,a);void 0!==b&&this.DecodeOptions(b);return!0};v.prototype.Eval=function(a,b){b-=a.fX;return"TSplinePoly3"==a._typename?a.fY+b*(a.fB+b*(a.fC+b*a.fD)):"TSplinePoly5"==a._typename?a.fY+b*(a.fB+b*(a.fC+b*(a.fD+b*(a.fE+b*a.fF)))):a.fY+b};v.prototype.FindX=function(a){var b=this.GetObject(),c=0,d=b.fNp-1;if(a<=b.fXmin)return 0;if(a>=b.fXmax)return d;if(b.fKstep)c=Math.round((a-b.fXmin)/b.fDelta),a<b.fPoly[c].fX?c=Math.max(c-1,0):c<d&&a>b.fPoly[c+1].fX&&++c;else for(;1<
d-c;){var e=Math.round((c+d)/2);a>b.fPoly[e].fX?c=e:d=e}return c};v.prototype.CreateDummyHisto=function(){var a=0,b=1,c=0,d=1,e=this.GetObject();e&&e.fPoly&&(a=b=e.fPoly[0].fX,c=d=e.fPoly[0].fY,e.fPoly.forEach(function(e){a=Math.min(e.fX,a);b=Math.max(e.fX,b);c=Math.min(e.fY,c);d=Math.max(e.fY,d)}),0<d&&(d*=1.05),0>c&&(c*=1.05));var g=f.Create("TH1I");g.fName=e.fName+"_hist";g.fTitle=e.fTitle;g.fXaxis.fXmin=a;g.fXaxis.fXmax=b;g.fYaxis.fXmin=c;g.fYaxis.fXmax=d;return g};v.prototype.ProcessTooltip=
function(a){var b=!1,c=this.GetObject(),d=this.frame_painter(),e=null,g=0;if(null!==a&&c&&d){var k=d.RevertX(a.x);g=this.FindX(k);e=c.fPoly[g];var h=this.Eval(e,k);g<c.fN-1&&Math.abs(c.fPoly[g+1].fX-k)<Math.abs(k-e.fX)&&(e=c.fPoly[++g]);if(Math.abs(d.grx(e.fX)-a.x)<.5*this.knot_size)k=e.fX,h=e.fY;else if(e=null,k<c.fXmin||k>c.fXmax)b=!0}else b=!0;if(b)return null!==this.draw_g&&this.draw_g.select(".tooltip_bin").remove(),null;b=this.draw_g.select(".tooltip_bin");c=this.lineatt.width+3;b.empty()&&
(b=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").attr("r",c).style("fill","none").call(this.lineatt.func));c={name:this.GetObject().fName,title:this.GetObject().fTitle,x:d.grx(k),y:d.gry(h),color1:this.lineatt.color,lines:[],exact:null!==e||Math.abs(d.gry(h)-a.y)<c};c.changed=b.property("current_xx")!==k;c.menu=c.exact;c.menu_dist=Math.sqrt((c.x-a.x)*(c.x-a.x)+(c.y-a.y)*(c.y-a.y));c.changed&&b.attr("cx",Math.round(c.x)).attr("cy",Math.round(c.y)).property("current_xx",
k);a=this.GetTipName();0<a.length&&c.lines.push(a);c.lines.push("x = "+d.AxisAsText("x",k));c.lines.push("y = "+d.AxisAsText("y",h));null!==e&&(c.lines.push("knot = "+g),c.lines.push("B = "+f.FFormat(e.fB,f.gStyle.fStatFormat)),c.lines.push("C = "+f.FFormat(e.fC,f.gStyle.fStatFormat)),c.lines.push("D = "+f.FFormat(e.fD,f.gStyle.fStatFormat)),void 0!==e.fE&&void 0!==e.fF&&(c.lines.push("E = "+f.FFormat(e.fE,f.gStyle.fStatFormat)),c.lines.push("F = "+f.FFormat(e.fF,f.gStyle.fStatFormat))));return c};
v.prototype.Redraw=function(){var a=this.frame_width(),b=this.frame_height(),c=this.GetObject(),d=this.frame_painter();this.GetTipName("\n");this.CreateG(!0);this.knot_size=5;this.createAttLine({attr:c});if(this.options.Line||this.options.Curve){var e=Math.max(10,c.fNpx),g=Math.max(d.scale_xmin,c.fXmin),k=Math.min(d.scale_xmax,c.fXmax),h=this.FindX(g),m=[];d.logx&&(g=Math.log(g),k=Math.log(k));for(var l=0;l<e;++l){var n=g+(k-g)/e*(l-1);for(d.logx&&(n=Math.exp(n));h<c.fNp-1&&n>c.fPoly[h+1].fX;)++h;
var u=this.Eval(c.fPoly[h],n);m.push({x:n,y:u,grx:d.grx(n),gry:d.gry(u)})}l=b;void 0!==d.hmin&&0<=d.hmin&&(l=Math.round(d.gry(0)),l>b||0>l)&&(l=b);m=f.Painter.BuildSvgPath("bezier",m,l,2);this.draw_g.append("svg:path").attr("class","line").attr("d",m.path).style("fill","none").call(this.lineatt.func)}if(this.options.Mark){m="";this.createAttMarker({attr:c});this.markeratt.reset_pos();this.knot_size=this.markeratt.GetFullSize();for(l=0;l<c.fPoly.length;l++)g=c.fPoly[l],e=d.grx(g.fX),e>-this.knot_size&&
e<a+this.knot_size&&(g=d.gry(g.fY),g>-this.knot_size&&g<b+this.knot_size&&(m+=this.markeratt.create(e,g)));m&&this.draw_g.append("svg:path").attr("d",m).call(this.markeratt.func)}};v.prototype.CanZoomIn=function(a,b,c){return"x"===a&&this.GetObject()?!0:!1};v.prototype.DecodeOptions=function(a){var b=new f.DrawOptions(a);this.options||(this.options={});f.extend(this.options,{Same:b.check("SAME"),Line:b.check("L"),Curve:b.check("C"),Mark:b.check("P")});this.OptionsStore(a)};v.prototype.FirstDraw=function(){this.SetDivId(this.divid);
this.Redraw();return this.DrawingReady()};f.Painter.drawSpline=function(a,b,c){b=new v(b);b.SetDivId(a,-1);b.DecodeOptions(c);if(!b.main_painter()){if(b.options.Same)return console.warn("TSpline painter requires histogram to be drawn"),null;c=b.CreateDummyHisto();f.draw(a,c,"AXIS",b.FirstDraw.bind(b));return b}return b.FirstDraw()};A.prototype=Object.create(f.TObjectPainter.prototype);A.prototype.Redraw=function(){void 0===this.step&&this.StartDrawing(!1)};A.prototype.DecodeOptions=function(a){var b=
new f.DrawOptions(a||"REPEAT");this.options||(this.options={});f.extend(this.options,{once:b.check("ONCE"),repeat:b.check("REPEAT"),first:b.check("FIRST")});this.OptionsStore(a)};A.prototype.DrawPrimitives=function(a,b,c){0===a&&(this._doing_primitives=!0);for(var d=this.GetObject().fSteps.arr[this.step];;){c&&(c.$grtimeid=this.selfid);if(!d||a>=d.arr.length)return delete this._doing_primitives,f.CallBack(b);var e={func:this.DrawPrimitives.bind(this,a+1,b)};c=f.draw(this.divid,d.arr[a],d.opt[a],e);
if(!e.completed)break;a++}};A.prototype.Selector=function(a){return a&&a.$grtimeid===this.selfid};A.prototype.ContineDrawing=function(){if(this.options){var a=this.GetObject();this.ready_called||(this.ready_called=!0,this.DrawingReady());if(this.options.first)delete this.step;else if(this.wait_animation_frame)delete this.wait_animation_frame,(a=this.pad_painter())?(a.CleanPrimitives(this.Selector.bind(this)),this.DrawPrimitives(0,this.ContineDrawing.bind(this))):delete this.step;else if(this.running_timeout)clearTimeout(this.running_timeout),
delete this.running_timeout,this.wait_animation_frame=!0,requestAnimationFrame(this.ContineDrawing.bind(this));else{var b=a.fSleepTime;if(!b||100>b)b=10;if(++this.step>a.fSteps.arr.length)if(this.options.repeat)this.step=0,b=Math.max(5E3,5*b);else{delete this.step;return}this.running_timeout=setTimeout(this.ContineDrawing.bind(this),b)}}};A.prototype.StartDrawing=function(a){!1!==a&&this.SetDivId(this.divid);this.step=0;this.DrawPrimitives(0,this.ContineDrawing.bind(this))};f.Painter.drawGraphTime=
function(a,b,c){var d=new A(b);d.SetDivId(a,-1);if(d.main_painter())return console.error("Cannot draw graph time on top of other histograms"),null;if(!b.fFrame)return console.error("Frame histogram not exists"),null;d.DecodeOptions(c);!b.fFrame.fTitle&&b.fTitle&&(b.fFrame.fTitle=b.fTitle);d.selfid="grtime"+f.id_counter++;f.draw(a,b.fFrame,"AXIS",d.StartDrawing.bind(d));return d};B.prototype=Object.create(f.TObjectPainter.prototype);B.prototype.GetEfficiency=function(a){var b=this.GetObject(),c=b.fTotalHistogram.getBinContent(a);
a=b.fPassedHistogram.getBinContent(a);return c?a/c:0};B.prototype.Normal=function(a,b,c,d){if(0==a)return d?1:0;b/=a;a=f.Math.normal_quantile(1-(1-c)/2,Math.sqrt(b*(1-b)/a));return d?1<b+a?1:b+a:0>b-a?0:b-a};B.prototype.GetEfficiencyErrorLow=function(a){var b=this.GetObject(),c=b.fTotalHistogram.getBinContent(a),d=b.fPassedHistogram.getBinContent(a);return this.GetEfficiency(a)-this[this.fBoundary](c,d,b.fConfLevel,!1)};B.prototype.GetEfficiencyErrorUp=function(a){var b=this.GetObject(),c=b.fTotalHistogram.getBinContent(a),
d=b.fPassedHistogram.getBinContent(a);a=this.GetEfficiency(a);return this[this.fBoundary](c,d,b.fConfLevel,!0)-a};B.prototype.CreateGraph=function(){var a=f.Create("TGraphAsymmErrors");a.fName="eff_graph";return a};B.prototype.FillGraph=function(a,b){var c=this.GetObject(),d=c.fTotalHistogram.fXaxis.fNbins,e=!1,g=0;0<=b.toLowerCase().indexOf("e0")&&(e=!0);for(b=0;b<d;++b)if(e||0!==c.fTotalHistogram.getBinContent(b+1))a.fX[g]=c.fTotalHistogram.fXaxis.GetBinCenter(b+1),a.fY[g]=this.GetEfficiency(b+
1),a.fEXlow[g]=c.fTotalHistogram.fXaxis.GetBinCenter(b+1)-c.fTotalHistogram.fXaxis.GetBinLowEdge(b+1),a.fEXhigh[g]=c.fTotalHistogram.fXaxis.GetBinLowEdge(b+2)-c.fTotalHistogram.fXaxis.GetBinCenter(b+1),a.fEYlow[g]=this.GetEfficiencyErrorLow(b+1),a.fEYhigh[g]=this.GetEfficiencyErrorUp(b+1),++g;a.fNpoints=g};f.Painter.drawEfficiency=function(a,b,c){if(!b||!b.fTotalHistogram||0!=b.fTotalHistogram._typename.indexOf("TH1"))return null;var d=new B(b);d.options=c;b=d.CreateGraph();d.FillGraph(b,c);f.draw(a,
b,c,function(){d.SetDivId(a);d.DrawingReady()});return d};x.prototype=Object.create(f.TObjectPainter.prototype);x.prototype.Cleanup=function(){this.painters=[];f.TObjectPainter.prototype.Cleanup.call(this)};x.prototype.UpdateObject=function(a){if(!this.MatchObjectType(a))return!1;var b=this.GetObject(),c=a.fGraphs;b.fTitle=a.fTitle;b=!1;if(this.firstpainter){var d=a.fHistogram;this.autorange&&!d&&(d=this.ScanGraphsRange(c));this.firstpainter.UpdateObject(d)&&(b=!0)}for(d=0;d<c.arr.length;++d)d<this.painters.length&&
this.painters[d].UpdateObject(c.arr[d])&&(b=!0);if(a.fFunctions)for(d=0;d<a.fFunctions.arr.length;++d)if((c=a.fFunctions.arr[d])&&c._typename&&c.fName){var e=this.FindPainterFor(null,c.fName,c._typename);e&&e.UpdateObject(c)}return b};x.prototype.ComputeGraphRange=function(a,b){if(0!=b.fNpoints){a.first&&(a.xmin=a.xmax=b.fX[0],a.ymin=a.ymax=b.fY[0],a.first=!1);for(var c=0;c<b.fNpoints;++c)a.xmin=Math.min(a.xmin,b.fX[c]),a.xmax=Math.max(a.xmax,b.fX[c]),a.ymin=Math.min(a.ymin,b.fY[c]),a.ymax=Math.max(a.ymax,
b.fY[c]);return a}};x.prototype.padtoX=function(a,b){return a.fLogx&&50>b?Math.exp(2.302585092994*b):b};x.prototype.ScanGraphsRange=function(a,b,c){var d=this.GetObject(),e=0;var g=0;var k=!1,h=!1,m=!1,l="",n={xmin:0,xmax:0,ymin:0,ymax:0,first:!0};c&&(k=c.fLogx,h=c.fLogy,n.xmin=c.fUxmin,n.xmax=c.fUxmax,n.ymin=c.fUymin,n.ymax=c.fUymax,n.first=!1);if(b){a=b.fYaxis.fXmin;var u=b.fYaxis.fXmax;c&&(e=this.padtoX(c,n.xmin),g=this.padtoX(c,n.xmax))}else{this.autorange=!0;for(e=0;e<a.arr.length;++e)this.ComputeGraphRange(n,
a.arr[e]);a.arr[0]&&a.arr[0].fHistogram&&a.arr[0].fHistogram.fXaxis.fTimeDisplay&&(m=!0,l=a.arr[0].fHistogram.fXaxis.fTimeFormat);n.xmin==n.xmax&&(n.xmax+=1);n.ymin==n.ymax&&(n.ymax+=1);g=.05*(n.xmax-n.xmin);c=.05*(n.ymax-n.ymin);e=n.xmin-g;g=n.xmax+g;h?(0>=n.ymin&&(n.ymin=.001*n.ymax),a=n.ymin/(1+.5*f.log10(n.ymax/n.ymin)),u=n.ymax*(1+.2*f.log10(n.ymax/n.ymin))):(a=n.ymin-c,u=n.ymax+c);0>a&&0<=n.ymin&&(a=0);0<u&&0>=n.ymax&&(u=0)}0>e&&0<=n.xmin&&(e=k?.9*n.xmin:0);0<g&&0>=n.xmax&&(g=k?1.1*n.xmax:0);
-1111!=d.fMinimum&&(n.ymin=a=d.fMinimum);-1111!=d.fMaximum&&(n.ymax=u=d.fMaximum);0>a&&0<=n.ymin&&h&&(a=.9*n.ymin);0<u&&0>=n.ymax&&h&&(u=1.1*n.ymax);0>=a&&h&&(a=.001*u);!h&&0<a&&a<.05*u&&(a=0);0>=e&&k&&(e=1E3<g?1:.001*g);!b&&(b=f.Create("TH1I"),b.fTitle=d.fTitle,b.fXaxis.fXmin=e,b.fXaxis.fXmax=g,b.fXaxis.fTimeDisplay=m)&&(b.fXaxis.fTimeFormat=l);b.fYaxis.fXmin=a;b.fYaxis.fXmax=u;return b};x.prototype.DrawAxis=function(a){var b=this.GetObject();b=this.ScanGraphsRange(b.fGraphs,b.fHistogram,this.root_pad());
f.draw(this.divid,b,"AXIS",a)};x.prototype.DrawNextFunction=function(a,b){var c=this.GetObject();if(!c.fFunctions||a>=c.fFunctions.arr.length)return f.CallBack(b);f.draw(this.divid,c.fFunctions.arr[a],c.fFunctions.opt[a],this.DrawNextFunction.bind(this,a+1,b))};x.prototype.DrawNextGraph=function(a,b,c,d){c&&this.painters.push(c);c=this.GetObject().fGraphs;if(a>=c.arr.length)return this._pfc=this._plc=this._pmc=!1,this.DrawNextFunction(0,this.DrawingReady.bind(this));if(499===a%500&&!d)return setTimeout(this.DrawNextGraph.bind(this,
a,b,null,!0),0);if(this._pfc||this._plc||this._pmc)!this.palette&&f.Painter.GetColorPalette&&(this.palette=f.Painter.GetColorPalette()),this.palette&&(d=this.palette.calcColor(a,c.arr.length+1),d=this.add_color(d),this._pfc&&(c.arr[a].fFillColor=d),this._plc&&(c.arr[a].fLineColor=d),this._pmc&&(c.arr[a].fMarkerColor=d));f.draw(this.divid,c.arr[a],c.opt[a]||b,this.DrawNextGraph.bind(this,a+1,b))};f.Painter.drawMultiGraph=function(a,b,c){var d=new x(b);d.SetDivId(a,-1);var e=new f.DrawOptions(c);e.check("3D");
e.check("FB");d._pfc=e.check("PFC");d._plc=e.check("PLC");d._pmc=e.check("PMC");e.check("A")||!d.main_painter()?d.DrawAxis(function(b){d.firstpainter=b;d.SetDivId(a);d.DrawNextGraph(0,e.remain())}):(d.SetDivId(a),d.DrawNextGraph(0,e.remain()));return d};t.prototype=Object.create(f.TObjectPainter.prototype);t.prototype.DecodeOptions=function(a){this.options={Zscale:!1};a&&0<=a.indexOf("z")&&(this.options.Zscale=!0)};t.prototype.CreateRGBA=function(a){var b=this.GetObject();if(!b||!b.fPalette)return null;
var c=Array(4*(a+1)),d=1;b=b.fPalette;for(var e=0;e<=a;++e){for(var g=1*e/a;b.fPoints[d]<g&&d<b.fPoints.length-1;)d++;var f=(b.fPoints[d]-g)/(b.fPoints[d]-b.fPoints[d-1]);g=(g-b.fPoints[d-1])/(b.fPoints[d]-b.fPoints[d-1]);c[4*e]=Math.min(255,Math.round((b.fColorRed[d-1]*f+b.fColorRed[d]*g)/256));c[4*e+1]=Math.min(255,Math.round((b.fColorGreen[d-1]*f+b.fColorGreen[d]*g)/256));c[4*e+2]=Math.min(255,Math.round((b.fColorBlue[d-1]*f+b.fColorBlue[d]*g)/256));c[4*e+3]=Math.min(255,Math.round((b.fColorAlpha[d-
1]*f+b.fColorAlpha[d]*g)/256))}return c};t.prototype.getContourColor=function(a){if(!this.fContour||!this.rgba)return"white";a=4*Math.round((a-this.fContour[0])/(this.fContour[this.fContour.length-1]-this.fContour[0])*(this.rgba.length-4)/4);return"rgba("+this.rgba[a]+","+this.rgba[a+1]+","+this.rgba[a+2]+","+this.rgba[a+3]+")"};t.prototype.CreateImage=function(){var a=this.GetObject(),b=!1,c=this.frame_painter();if(a._blob){if(15!=a._blob.length||a._blob[0])3==a._blob.length&&a._blob[0]?(a.fPngBuf=
a._blob[2],a.fPngBuf&&a.fPngBuf.length==a._blob[1]||(console.error("TASImage with png buffer _blob error",a._blob[1],"!=",a.fPngBuf?a.fPngBuf.length:-1),delete a.fPngBuf)):console.error("TASImage _blob len",a._blob.length,"not recognized");else if(a.fImageQuality=a._blob[1],a.fImageCompression=a._blob[2],a.fConstRatio=a._blob[3],a.fPalette={_typename:"TImagePalette",fUniqueID:a._blob[4],fBits:a._blob[5],fNumPoints:a._blob[6],fPoints:a._blob[7],fColorRed:a._blob[8],fColorGreen:a._blob[9],fColorBlue:a._blob[10],
fColorAlpha:a._blob[11]},a.fWidth=a._blob[12],a.fHeight=a._blob[13],a.fImgBuf=a._blob[14],a.fWidth*a.fHeight!=a.fImgBuf.length||a.fPalette.fNumPoints!=a.fPalette.fPoints.length)console.error("TASImage _blob decoding error",a.fWidth*a.fHeight,"!=",a.fImgBuf.length,a.fPalette.fNumPoints,"!=",a.fPalette.fPoints.length),delete a.fImgBuf,delete a.fPalette;delete a._blob}var d=!0;if(a.fImgBuf&&a.fPalette){b=!0;this.rgba=this.CreateRGBA(1E3);d=a.fImgBuf[0];var e=a.fImgBuf[0];for(var g=1;g<a.fImgBuf.length;++g){var k=
a.fImgBuf[g];d=Math.min(k,d);e=Math.max(k,e)}this.fContour=Array(200);for(g=0;200>g;g++)this.fContour[g]=d+(e-d)/199*g;d>=e&&(e=d+1);g=0;k=a.fWidth;var h=0,m=a.fHeight;c&&c.zoom_xmin!=c.zoom_xmax&&(g=Math.round(c.zoom_xmin*a.fWidth),k=Math.round(c.zoom_xmax*a.fWidth));c&&c.zoom_ymin!=c.zoom_ymax&&(h=Math.round(c.zoom_ymin*a.fHeight),m=Math.round(c.zoom_ymax*a.fHeight));if(f.nodejs)try{require("canvas");var l=createCanvas(k-g,m-h)}catch(E){console.log("canvas is not installed, most probably due to SoftwareRenderer, see https://github.com/root-project/jsroot/issues/201")}else l=
document.createElement("canvas"),l.width=k-g,l.height=m-h;if(!l)return;for(var n=l.getContext("2d"),u=n.getImageData(0,0,l.width,l.height),p=u.data;h<m;++h)for(var C=(m-h-1)*(k-g)*4,q=h*a.fWidth,r=g;r<k;++r){var t=4*Math.round((a.fImgBuf[q+r]-d)/(e-d)*1E3);p[C++]=this.rgba[t++];p[C++]=this.rgba[t++];p[C++]=this.rgba[t++];p[C++]=this.rgba[t++]}n.putImageData(u,0,0);e=l.toDataURL();d=a.fConstRatio}else if(a.fPngBuf){l="";if("string"==typeof a.fPngBuf)l=a.fPngBuf;else for(g=0;g<a.fPngBuf.length;++g)l+=
String.fromCharCode(0>a.fPngBuf[g]?256+a.fPngBuf[g]:a.fPngBuf[g]);e="data:image/png;base64,"+(f.nodejs?require("btoa"):window.btoa)(l)}e&&this.CreateG(!0).append("image").attr("href",e).attr("width",this.frame_width()).attr("height",this.frame_height()).attr("preserveAspectRatio",d?null:"none");e&&this.is_main_painter()&&b&&c&&(this.DrawColorPalette(this.options.Zscale,!1,!0),c.SetAxesRanges(f.Create("TAxis"),0,1,f.Create("TAxis"),0,1,null,0,0),c.CreateXY({ndim:2,check_pad_range:!1,create_canvas:!1}),
c.AddInteractive())};t.prototype.CanZoomIn=function(a,b,c){var d=this.GetObject();return d&&d.fImgBuf?"x"==a&&3<(c-b)*d.fWidth||"y"==a&&3<(c-b)*d.fHeight?!0:!1:!1};t.prototype.DrawColorPalette=function(a,b,c){if(!this.is_main_painter())return null;this.draw_palette||(b=f.Create("TPave"),f.extend(b,{_typename:"TPaletteAxis",fName:"TPave",fH:null,fAxis:f.Create("TGaxis"),fX1NDC:.91,fX2NDC:.95,fY1NDC:.1,fY2NDC:.9,fInit:1}),b.fAxis.fChopt="+",this.draw_palette=b);var d=this.FindPainterFor(this.draw_palette);
a?(a=this.frame_painter(),c&&a&&(b=this.draw_palette,b.fX2NDC=a.fX2NDC+.01+(b.fX2NDC-b.fX1NDC),b.fX1NDC=a.fX2NDC+.01,b.fY1NDC=a.fY1NDC,b.fY2NDC=a.fY2NDC),d?(d.Enabled=!0,d.DrawPave("")):f.draw(this.divid,this.draw_palette,"onpad:"+this.pad_name,function(a){a.$secondary=!0;a.Redraw=function(){}})):d&&(d.Enabled=!1,d.RemoveDrawG())};t.prototype.ToggleColz=function(){var a=this.GetObject();a&&a.fPalette&&(this.options.Zscale=!this.options.Zscale,this.DrawColorPalette(this.options.Zscale,!1,!0))};t.prototype.Redraw=
function(a){var b=null;this.draw_g&&(b=this.draw_g.select("image"));if(b&&!b.empty()&&"zoom"!==a){a=this.frame_width();var c=this.frame_height();b.attr("width",a).attr("height",c)}else this.CreateImage()};t.prototype.ButtonClick=function(a){if(this!==this.main_painter())return!1;switch(a){case "ToggleColorZ":this.ToggleColz();break;default:return!1}return!0};t.prototype.FillToolbar=function(){var a=this.pad_painter(),b=this.GetObject();a&&b&&b.fPalette&&(a.AddButton(f.ToolbarIcons.th2colorz,"Toggle color palette",
"ToggleColorZ"),a.ShowButtons())};f.Painter.drawJSImage=function(a,b,c){var d=new f.TBasePainter;d.SetDivId(a,-1);var e=d.select_main();b=e.append("img").attr("src",b.fName).attr("title",b.fTitle||b.fName);c&&0<=c.indexOf("scale")?b.style("width","100%").style("height","100%"):c&&0<=c.indexOf("center")&&(e.style("position","relative"),b.attr("style","margin: 0; position: absolute;  top: 50%; left: 50%; transform: translate(-50%, -50%);"));d.SetDivId(a);return d.DrawingReady()};f.Painter.CreateBranchItem=
function(a,b,c,d){function e(a){var b=a.indexOf("[");0<b&&(a=a.substr(0,b));d&&0==a.indexOf(d.fName)&&(a=a.substr(d.fName.length),"."===a[0]&&(a=a.substr(1)));return a}if(!a||!b)return!1;var g=b.fBranches?b.fBranches.arr.length:0,k=b.fLeaves?b.fLeaves.arr.length:0;b.$tree=c;c={_name:e(b.fName),_kind:"ROOT."+b._typename,_title:b.fTitle,_obj:b};a._childs||(a._childs=[]);a._childs.push(c);"TBranchElement"===b._typename&&(c._title+=" from "+b.fClassName+";"+b.fClassVersion);if(0<g)c._more=!0,c._expand=
function(a,b){if(!b)return!1;a._childs||(a._childs=[]);!b.fLeaves||1!==b.fLeaves.arr.length||b.fType!==f.BranchType.kClonesNode&&b.fType!==f.BranchType.kSTLNode||(b.fLeaves.arr[0].$branch=b,a._childs.push({_name:"@size",_title:"container size",_kind:"ROOT.TLeafElement",_icon:"img_leaf",_obj:b.fLeaves.arr[0],_more:!1}));for(var c=0;c<b.fBranches.arr.length;++c)f.Painter.CreateBranchItem(a,b.fBranches.arr[c],b.$tree,b);var d=(c=f.IO.GetBranchObjectClass(b,b.$tree,!0))?f.getMethods(c):null;if(d&&0<b.fBranches.arr.length)for(var e in d)if("function"===
typeof d[e]){var g=d[e].toString();0<g.indexOf("return")&&0==g.indexOf("function ()")&&a._childs.push({_name:e+"()",_title:"function "+e+" of class "+c,_kind:"ROOT.TBranchFunc",_obj:{_typename:"TBranchFunc",branch:b,func:e},_more:!1})}return!0};else if(1===k)c._icon="img_leaf",c._more=!1;else if(1<k)for(c._childs=[],a=0;a<k;++a)b.fLeaves.arr[a].$branch=b,g={_name:e(b.fLeaves.arr[a].fName),_kind:"ROOT."+b.fLeaves.arr[a]._typename,_obj:b.fLeaves.arr[a]},c._childs.push(g);return!0};f.Painter.TreeHierarchy=
function(a,b){if("TTree"!=b._typename&&"TNtuple"!=b._typename&&"TNtupleD"!=b._typename)return!1;a._childs=[];a._tree=b;for(var c=0;c<b.fBranches.arr.length;++c)f.Painter.CreateBranchItem(a,b.fBranches.arr[c],b);return!0};f.Painter.drawTree=function(a,b,c){var d=new f.TObjectPainter(b),e=b,g=c;if("TBranchFunc"==b._typename)g={expr:"."+b.func+"()",branch:b.branch},c&&0==c.indexOf("dump")?g.expr+=">>"+c:c&&(g.expr+=c),e=b.branch.$tree;else if(b.$branch){g={expr:"."+b.fName+(c||""),branch:b.$branch};
if(g.branch.fType===f.BranchType.kClonesNode||g.branch.fType===f.BranchType.kSTLNode)g.expr=c,g.direct_branch=!0;e=b.$branch.$tree}else if(b.$tree)!c&&b.fStreamerType&&b.fStreamerType!==f.IO.kTString&&b.fStreamerType>=f.IO.kObject&&b.fStreamerType<=f.IO.kAnyP&&(c="dump"),g={expr:c,branch:b},e=b.$tree;else{if("player"===g||!g)return f.AssertPrerequisites("jq2d",function(){f.CreateTreePlayer(d);d.ConfigureTree(e);d.Show(a);d.DrawingReady()}),d;"string"===typeof g&&(g={expr:g})}if(!e)return console.error("No TTree object available for TTree::Draw"),
d.DrawingReady();var k=d.DrawingReady.bind(d);d._return_res_painter=!0;f.cleanup(a);e.Draw(g,function(b,c,l){var h="";g.player?2===g.create_player&&(h=d.drawid):h=a;if(h)return f.redraw(h,b,c,l?null:k);1===g.create_player?g.player_intermediate=l:(g.player_create=1,g.player_intermediate=l,f.AssertPrerequisites("jq2d",function(){f.CreateTreePlayer(d);d.ConfigureTree(e);d.Show(a,g);g.create_player=2;f.redraw(d.drawid,b,c,g.player_intermediate?null:k);d.SetItemName("TreePlayer")}))});return d};f.Painter.drawText=
function(){var a=this.GetObject(),b=this.pad_width(),c=this.pad_height(),d=a.fX,e=a.fY,g=this.get_color(a.fTextColor),k=!1,h=1,m=a.fTextSize||.05,l=this.frame_painter();a.TestBit(f.BIT(14))?this.isndc=!0:l&&!l.mode3d?(b=this.frame_width(),c=this.frame_height(),k="upper_layer"):null===this.root_pad()&&(this.isndc=!0,d=e=.5,a.fTextAlign=22,g||(g="black"));this.CreateG(k);this.draw_g.attr("transform",null);this.pos_x=this.AxisToSvg("x",d,this.isndc);this.pos_y=this.AxisToSvg("y",e,this.isndc);d={align:a.fTextAlign,
x:this.pos_x,y:this.pos_y,text:a.fTitle,color:g,latex:0};a.fTextAngle&&(d.rotate=-a.fTextAngle);"TLatex"==a._typename?(d.latex=1,h=.9):"TMathText"==a._typename&&(d.latex=2,h=.8);this.StartTextDrawing(a.fTextFont,Math.round(1<m?m:m*Math.min(b,c)*h));this.DrawText(d);this.FinishTextDrawing();this.pos_dx=this.pos_dy=0;this.moveDrag||(this.moveDrag=function(a,b){this.pos_dx+=a;this.pos_dy+=b;this.draw_g.attr("transform","translate("+this.pos_dx+","+this.pos_dy+")")});this.moveEnd||(this.moveEnd=function(a){a||
(a=this.GetObject(),a.fX=this.SvgToAxis("x",this.pos_x+this.pos_dx,this.isndc),a.fY=this.SvgToAxis("y",this.pos_y+this.pos_dy,this.isndc),this.WebCanvasExec("SetX("+a.fX+");;SetY("+a.fY+");;"))});this.AddMove()};f.Painter.drawLine=function(){var a=this.GetObject(),b=new f.TAttLineHandler(a),c=f.BIT(14);c=a.TestBit(c);this.CreateG();this.draw_g.append("svg:line").attr("x1",this.AxisToSvg("x",a.fX1,c)).attr("y1",this.AxisToSvg("y",a.fY1,c)).attr("x2",this.AxisToSvg("x",a.fX2,c)).attr("y2",this.AxisToSvg("y",
a.fY2,c)).call(b.func)};f.Painter.drawPolyLine=function(){this.CreateG();var a=this.GetObject(),b=new f.TAttLineHandler(a),c=this.createAttFill(a),d=f.BIT(14),e=a.TestBit(d);d="";e=this.AxisToSvgFunc(e);for(var g=0;g<=a.fLastPoint;++g)d+=(0<g?"L":"M")+e.x(a.fX[g])+","+e.y(a.fY[g]);"TPolyLine"!=a._typename&&c.SetSolidColor("none");c.empty()||(d+="Z");this.draw_g.append("svg:path").attr("d",d).call(b.func).call(c.func)};f.Painter.drawArrow=function(){var a=this.GetObject(),b=f.BIT(14),c=a.fOption;this.wsize=
Math.max(3,Math.round(Math.max(this.pad_width(),this.pad_height())*a.fArrowSize*.8));this.isndc=a.TestBit(b);this.angle2=a.fAngle/2/180*Math.PI;this.beg=this.mid=this.end=0;0==c.indexOf("<")&&(this.beg=0==c.indexOf("<|")?12:2);0<=c.indexOf("->-")?this.mid=1:0<=c.indexOf("-|>-")?this.mid=11:0<=c.indexOf("-<-")?this.mid=2:0<=c.indexOf("-<|-")&&(this.mid=12);c.lastIndexOf(">")==c.length-1&&(this.end=c.lastIndexOf("|>")==c.length-2&&1<c.length?11:1);this.createAttLine({attr:a});this.CreateG();this.x1=
this.AxisToSvg("x",a.fX1,this.isndc,!0);this.y1=this.AxisToSvg("y",a.fY1,this.isndc,!0);this.x2=this.AxisToSvg("x",a.fX2,this.isndc,!0);this.y2=this.AxisToSvg("y",a.fY2,this.isndc,!0);this.rotate=function(a,b,c){var d=this.wsize*Math.cos(a);a=this.wsize*Math.sin(a);var e="";void 0!==b&&void 0!==c?e="M"+Math.round(b-d)+","+Math.round(c-a):(d=-d,a=-a);e+="l"+Math.round(d)+","+Math.round(a);b&&void 0===c&&(e+="z");return e};this.createPath=function(){var a=Math.atan2(this.y2-this.y1,this.x2-this.x1),
b=this.wsize*Math.cos(this.angle2),c=b*Math.cos(a);b*=Math.sin(a);var f="";this.beg&&(f+=this.rotate(a-Math.PI-this.angle2,this.x1,this.y1)+this.rotate(a-Math.PI+this.angle2,10<this.beg));2==this.mid%10&&(f+=this.rotate(a-Math.PI-this.angle2,(this.x1+this.x2-c)/2,(this.y1+this.y2-b)/2)+this.rotate(a-Math.PI+this.angle2,10<this.mid));1==this.mid%10&&(f+=this.rotate(a-this.angle2,(this.x1+this.x2+c)/2,(this.y1+this.y2+b)/2)+this.rotate(a+this.angle2,10<this.mid));this.end&&(f+=this.rotate(a-this.angle2,
this.x2,this.y2)+this.rotate(a+this.angle2,10<this.end));return"M"+Math.round(this.x1+(10<this.beg?c:0))+","+Math.round(this.y1+(10<this.beg?b:0))+"L"+Math.round(this.x2-(10<this.end?c:0))+","+Math.round(this.y2-(10<this.end?b:0))+f};b=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);10<this.beg||10<this.end?(this.createAttFill({attr:a}),b.call(this.fillatt.func)):b.style("fill","none");this.moveStart||(this.moveStart=function(a,b){var c=Math.sqrt(Math.pow(this.x1-
this.x2,2)+Math.pow(this.y1-this.y2,2)),d=Math.sqrt(Math.pow(a-this.x2,2)+Math.pow(b-this.y2,2))/c;this.side=.9<Math.sqrt(Math.pow(a-this.x1,2)+Math.pow(b-this.y1,2))/c?1:.9<d?-1:0});this.moveDrag||(this.moveDrag=function(a,b){1!=this.side&&(this.x1+=a,this.y1+=b);-1!=this.side&&(this.x2+=a,this.y2+=b);this.draw_g.select("path").attr("d",this.createPath())});this.moveEnd||(this.moveEnd=function(a){if(!a){a=this.GetObject();var b="";a.fX1=this.SvgToAxis("x",this.x1,this.isndc);a.fX2=this.SvgToAxis("x",
this.x2,this.isndc);a.fY1=this.SvgToAxis("y",this.y1,this.isndc);a.fY2=this.SvgToAxis("y",this.y2,this.isndc);1!=this.side&&(b+="SetX1("+a.fX1+");;SetY1("+a.fY1+");;");-1!=this.side&&(b+="SetX2("+a.fX2+");;SetY2("+a.fY2+");;");this.WebCanvasExec(b+"Notify();;")}});this.AddMove()};f.Painter.drawEllipse=function(){var a=this.GetObject();this.createAttLine({attr:a});this.createAttFill({attr:a});this.CreateG();var b=this.AxisToSvg("x",a.fX1),c=this.AxisToSvg("y",a.fY1),d=this.AxisToSvg("x",a.fX1+a.fR1)-
b,e=c-this.AxisToSvg("y",a.fY1+a.fR2);if("TCrown"==a._typename)if(0>=a.fR1)d=this.AxisToSvg("x",a.fX1+a.fR2)-b;else{var g=c-this.AxisToSvg("y",a.fY1+a.fR1),f=this.AxisToSvg("x",a.fX1+a.fR2)-b;b=this.draw_g.attr("transform","translate("+b+","+c+")").append("svg:path").call(this.lineatt.func).call(this.fillatt.func);if(0==a.fPhimin&&360==a.fPhimax)b.attr("d","M-"+d+",0A"+d+","+g+",0,1,0,"+d+",0A"+d+","+g+",0,1,0,-"+d+",0M-"+f+",0A"+f+","+e+",0,1,0,"+f+",0A"+f+","+e+",0,1,0,-"+f+",0");else{c=180<=a.fPhimax-
a.fPhimin?1:0;var h=a.fPhimin*Math.PI/180;a=a.fPhimax*Math.PI/180;var m=Math.round(d*Math.cos(h)),l=Math.round(g*Math.sin(h)),n=Math.round(d*Math.cos(a)),p=Math.round(g*Math.sin(a));b.attr("d","M"+n+","+p+"A"+d+","+g+",0,"+c+",0,"+m+","+l+"L"+Math.round(f*Math.cos(h))+","+Math.round(e*Math.sin(h))+"A"+f+","+e+",0,"+c+",1,"+Math.round(f*Math.cos(a))+","+Math.round(e*Math.sin(a))+"Z")}return}0==a.fPhimin&&360==a.fPhimax&&0==a.fTheta?this.draw_g.append("svg:ellipse").attr("cx",b).attr("cy",c).attr("rx",
d).attr("ry",e).call(this.lineatt.func).call(this.fillatt.func):(f=Math.cos(a.fTheta*Math.PI/180),h=Math.sin(a.fTheta*Math.PI/180),m=d*Math.cos(a.fPhimin*Math.PI/180),l=e*Math.sin(a.fPhimin*Math.PI/180),g=m*f-l*h,m=-m*h-l*f,n=d*Math.cos(a.fPhimax*Math.PI/180),p=e*Math.sin(a.fPhimax*Math.PI/180),l=n*f-p*h,n=-n*h-p*f,this.draw_g.attr("transform","translate("+b+","+c+")").append("svg:path").attr("d","M0,0L"+Math.round(g)+","+Math.round(m)+"A"+d+","+e+","+Math.round(-a.fTheta)+",1,0,"+Math.round(l)+","+
Math.round(n)+"Z").call(this.lineatt.func).call(this.fillatt.func))};f.Painter.drawPie=function(){var a=this.GetObject();this.CreateG();var b=this.AxisToSvg("x",a.fX),c=this.AxisToSvg("y",a.fY),d=this.AxisToSvg("x",a.fX+a.fRadius)-b,e=this.AxisToSvg("y",a.fY+a.fRadius)-c;this.draw_g.attr("transform","translate("+b+","+c+")");b=a.fPieSlices.length;c=0;for(var g=a.fAngularOffset*Math.PI/180,k=Math.round(d*Math.cos(g)),h=Math.round(e*Math.sin(g)),m=0;m<b;m++)c+=a.fPieSlices[m].fValue;for(m=0;m<b;m++){var l=
a.fPieSlices[m],n=new f.TAttLineHandler({attr:l}),p=this.createAttFill(l);g+=l.fValue/c*2*Math.PI;l=Math.round(d*Math.cos(g));var r=Math.round(e*Math.sin(g));this.draw_g.append("svg:path").attr("d","M0,0L"+k+","+h+"A"+d+","+e+",0,0,0,"+l+","+r+"z").call(n.func).call(p.func);k=l;h=r}};f.Painter.drawBox=function(){var a=this.GetObject(),b=0<=this.OptionsAsString().toUpperCase().indexOf("L"),c=this.createAttLine(a),d=this.createAttFill(a);this.CreateG();var e=this.AxisToSvg("x",a.fX1),g=this.AxisToSvg("x",
a.fX2),f=this.AxisToSvg("y",a.fY1),h=this.AxisToSvg("y",a.fY2),m=Math.min(e,g),l=Math.min(f,h);e=Math.abs(g-e);f=Math.abs(f-h);d.empty()||b||(c.color="none");this.draw_g.append("svg:rect").attr("x",m).attr("y",l).attr("width",e).attr("height",f).call(c.func).call(d.func);a.fBorderMode&&a.fBorderSize&&"none"!==d.color&&(h=c=a.fBorderSize,b="M"+m+","+l+"h"+e+"l"+-c+","+h+"h"+(2*c-e)+"v"+(f-2*h)+"l"+-c+","+h+"z",m="M"+(m+e)+","+(l+f)+"v"+-f+"l"+-c+","+h+"v"+(f-2*h)+"h"+(2*c-e)+"l"+-c+","+h+"z",0>a.fBorderMode&&
(a=b,b=m,m=a),this.draw_g.append("svg:path").attr("d",b).style("stroke","none").call(d.func).style("fill",r.rgb(d.color).brighter(.5).toString()),this.draw_g.append("svg:path").attr("d",m).style("stroke","none").call(d.func).style("fill",r.rgb(d.color).darker(.5).toString()))};f.Painter.drawMarker=function(){var a=this.GetObject(),b=new f.TAttMarkerHandler(a),c=f.BIT(14),d=a.TestBit(c);this.CreateG();c=this.AxisToSvg("x",a.fX,d);a=this.AxisToSvg("y",a.fY,d);(a=b.create(c,a))&&this.draw_g.append("svg:path").attr("d",
a).call(b.func)};f.Painter.drawPolyMarker=function(){this.CreateG();for(var a=this.GetObject(),b=new f.TAttMarkerHandler(a),c="",d=this.AxisToSvgFunc(),e=0;e<a.fN;++e)c+=b.create(d.x(a.fX[e]),d.y(a.fY[e]));c&&this.draw_g.append("svg:path").attr("d",c).call(b.func)};f.Painter.drawWebPainting=function(a,b,c){b=new f.TObjectPainter(b,c);b.UpdateObject=function(a){if(!this.MatchObjectType(a))return!1;this.draw_object=a;return!0};b.ReadAttr=function(a,b){for(var c=0,d={_typename:"any"},e=0;e<b.length;++e){var f=
a.indexOf(":",c+1);d[b[e]]=parseInt(a.substr(c+1,f>c?f-c-1:void 0));c=f}return d};b.Redraw=function(){function a(a,b){if(b!=l&&(m&&(m.attr("d",n),n="",m=null,l="none"),b))switch(l=b,m=a.draw_g.append("svg:path"),b){case "f":m.call(a.fillatt.func).attr("stroke","none");break;case "l":m.call(a.lineatt.func).attr("fill","none");break;case "m":m.call(a.markeratt.func)}}var b=this.GetObject(),c=this.AxisToSvgFunc();if(b&&b.fOper&&c){var k=0,h={},m=null,l="none",n="",p,r=b.fOper.split(";");this.CreateG();
for(p=0;p<r.length;++p){var t=r[p][0];switch(t){case "z":this.createAttLine({attr:this.ReadAttr(r[p],["fLineColor","fLineStyle","fLineWidth"]),force:!0});a();continue;case "y":this.createAttFill({attr:this.ReadAttr(r[p],["fFillColor","fFillStyle"]),force:!0});a();continue;case "x":this.createAttMarker({attr:this.ReadAttr(r[p],["fMarkerColor","fMarkerStyle","fMarkerSize"]),force:!0});a();continue;case "o":h=this.ReadAttr(r[p],["fTextColor","fTextFont","fTextSize","fTextAlign","fTextAngle"]);0>h.fTextSize&&
(h.fTextSize*=-.001);a();continue;case "r":case "b":a(this,"b"==t?"f":"l");t=c.x(b.fBuf[k++]);var q=c.y(b.fBuf[k++]);var v=c.x(b.fBuf[k++]);var w=c.y(b.fBuf[k++]);n+="M"+t+","+q+"h"+(v-t)+"v"+(w-q)+"h"+(t-v)+"z";continue;case "l":case "f":a(this,t);v=parseInt(r[p].substr(1));for(q=0;q<v;++q)n+=(0<q?"L":"M")+c.x(b.fBuf[k++])+","+c.y(b.fBuf[k++]);"f"==t&&(n+="Z");continue;case "m":a(this,t);v=parseInt(r[p].substr(1));this.markeratt.reset_pos();for(q=0;q<v;++q)n+=this.markeratt.create(c.x(b.fBuf[k++]),
c.y(b.fBuf[k++]));continue;case "h":case "t":if(h.fTextSize){a();q=1<h.fTextSize?h.fTextSize:this.pad_height()*h.fTextSize;v=this.draw_g.append("svg:g");this.StartTextDrawing(h.fTextFont,q,v);w=h.fTextAngle;360<=w&&(w-=360*Math.floor(w/360));var x=r[p].substr(1);if("h"==t){t="";for(q=0;q<x.length;q+=2)t+=String.fromCharCode(parseInt(x.substr(q,2),16));x=t}this.DrawText({align:h.fTextAlign,x:c.x(b.fBuf[k++]),y:c.y(b.fBuf[k++]),rotate:-w,text:x,color:f.Painter.root_colors[h.fTextColor],latex:0,draw_g:v});
this.FinishTextDrawing(v)}continue;default:console.log("unsupported operation "+t)}}a()}};b.SetDivId(a);b.Redraw();return b.DrawingReady()};f.Painter.drawRooPlot=function(a,b,c){function d(){if(++g>=b._items.arr.length)return e.DrawingReady();f.draw(a,b._items.arr[g],b._items.opt[g],d)}var e=new f.TObjectPainter(b),g=-1;f.draw(a,b._hist,"hist",d);return e};f.Painter.drawGraph=function(a,b,c){b=new p(b);b.SetDivId(a,-1);b.DecodeOptions(c);b.CreateBins();b.CreateStat();!b.main_painter()&&b.options.HOptions?
f.draw(a,b.CreateHistogram(),b.options.HOptions,b.PerformDrawing.bind(b,a)):b.PerformDrawing(a);return b};f.Painter.drawFunction=function(a,b,c){b=new y(b);b.SetDivId(a,-1);a=new f.DrawOptions(c);b.nosave=a.check("NOSAVE");if(void 0!==f.Math)return b.PerformDraw();f.AssertPrerequisites("math",b.PerformDraw.bind(b));return b};f.Painter.drawGraphPolar=function(a,b,c){var d=new w(b);d.DecodeOptions(c);d.SetDivId(a,-1);if(c=d.main_painter()){if(!c.$polargram)return console.error("Cannot superimpose TGraphPolar with plain histograms"),
null;d.PerformDrawing(a);return d}b.fPolargram||(b.fPolargram=d.CreatePolargram());return f.draw(a,b.fPolargram,"",d.PerformDrawing.bind(d,a))};f.Painter.drawGraphPolargram=function(a,b,c){c=new z(b);c.SetDivId(a,-1);var d=c.main_painter();if(d)return d.GetObject()!==b&&console.error("Cannot superimpose TGraphPolargram with any other drawings"),null;c.SetDivId(a,4);c.Redraw();return c.DrawingReady()};f.Painter.drawASImage=function(a,b,c){b=new t(b,c);b.DecodeOptions(c);b.SetDivId(a,1);b.CreateImage();
b.FillToolbar();return b.DrawingReady()};f.TF1Painter=y;f.TGraphPainter=p;f.TGraphPolarPainter=w;f.TMultiGraphPainter=x;f.TSplinePainter=v;f.TASImagePainter=t;return f});
