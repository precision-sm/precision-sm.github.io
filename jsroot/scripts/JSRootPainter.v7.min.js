var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(d){var g=0;return function(){return g<d.length?{done:!1,value:d[g++]}:{done:!0}}};$jscomp.arrayIterator=function(d){return{next:$jscomp.arrayIteratorImpl(d)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,g,r){d!=Array.prototype&&d!=Object.prototype&&(d[g]=r.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(d,g){this.$jscomp$symbol$id_=d;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function d(r){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(r||"")+"_"+g++,r)}var g=0;return d}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.asyncIterator;d||(d=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};
$jscomp.iteratorFromArray=function(d,g){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var r=0,l={next:function(){if(r<d.length){var n=r++;return{value:g(n,d[n]),done:!1}}l.next=function(){return{done:!0,value:void 0}};return l.next()}};l[Symbol.iterator]=function(){return l};return l};
$jscomp.polyfill=function(d,g,r,l){if(g){r=$jscomp.global;d=d.split(".");for(l=0;l<d.length-1;l++){var n=d[l];n in r||(r[n]={});r=r[n]}d=d[d.length-1];l=r[d];g=g(l);g!=l&&null!=g&&$jscomp.defineProperty(r,d,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Array.prototype.values",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d,r){return r})}},"es8","es3");
(function(d){if("function"===typeof define&&define.amd)define(["JSRootPainter","d3"],d);else if("object"===typeof exports&&"undefined"!==typeof module)d(require("./JSRootCore.js"),require("d3"));else{if("object"!=typeof d3)throw Error("This extension requires d3.js","JSRootPainter.v7.js");if("undefined"==typeof JSROOT)throw Error("JSROOT is not defined","JSRootPainter.v7.js");if("object"!=typeof JSROOT.Painter)throw Error("JSROOT.Painter not defined","JSRootPainter.v7.js");d(JSROOT,d3)}})(function(d,
g){function r(a,b){var c=d.Create("TAxis");d.TObjectPainter.call(this,c);this.embedded=a;this.csstype="frame";this.cssprefix=b;this.name="yaxis";this.kind="normal";this.func=null;this.full_min=this.order=0;this.full_max=1;this.scale_min=0;this.scale_max=1;this.ticks=[];this.lbls_both_sides=this.invert_side=!1}function l(a){d.TooltipHandler.call(this,a);this.csstype="frame";this.shrink_frame_left=0;this.y_kind=this.x_kind="normal";this.ymin=this.ymax=this.xmin=this.xmax=0;this.axes_drawn=!1;this.keys_handler=
null;this.mode3d=!1}function n(a,b){d.TObjectPainter.call(this,a);this.csstype="pad";this.pad=a;this.iscan=b;this.this_pad_name="";this.iscan||null===a||(this.this_pad_name=a.fObjectID?"pad"+a.fObjectID:"ppp"+d.id_counter++);this.painters=[];this.has_canvas=!0}function t(a){n.call(this,a,!0);this._websocket=null;this.tooltip_allowed=0<d.gStyle.Tooltip}function A(a,b,c){d.TObjectPainter.call(this,a,b);this.csstype=c||"pave"}function W(a,b,c){b=new A(b,c);b.SetDivId(a);b.DrawPave();return b.DrawingReady()}
function X(a){if(!this.frame_painter())return console.log("no frame painter - no title");var b=this.frame_x(),c=this.frame_y(),e=this.frame_width();this.frame_height();var f=this.pad_height(),d=this.GetObject();this.pad_painter();var m=this.v7EvalLength("margin",f,.02),k=e,p=this.v7EvalLength("height",f,.05);e=this.v7EvalAttr("text_size",20);var g=-1*this.v7EvalAttr("text_angle",0);this.v7EvalAttr("text_align",22);var q=this.v7EvalColor("text_color","black"),u=this.v7EvalAttr("text_font",41);this.CreateG(!1);
"drag"==a?(k=parseInt(this.draw_g.attr("width")),p=parseInt(this.draw_g.attr("height")),a={},this.v7AttrChange(a,"margin",(c-parseInt(this.draw_g.attr("y"))-p)/f),this.v7AttrChange(a,"height",p/f),this.v7SendAttrChanges(a,!1)):this.draw_g.attr("transform","translate("+b+","+Math.round(c-m-p)+")").attr("x",b).attr("y",Math.round(c-m-p)).attr("width",k).attr("height",p);c={align:22,x:k/2,y:p/2,text:d.fText,rotate:g,color:q,latex:1};this.StartTextDrawing(u,e);this.DrawText(c);this.FinishTextDrawing();
this.AddDrag({minwidth:20,minheight:20,no_change_x:!0,redraw:this.Redraw.bind(this,"drag")})}function C(a){d.TObjectPainter.call(this,a);this.csstype="palette"}d.sources.push("v7");d.v7={};d.TObjectPainter.prototype.v7EvalAttr=function(a,b){var c=this.GetObject();if(!c)return b;if(c.fAttr&&c.fAttr.m){var e=c.fAttr.m[a];if(e)return e.v}if(this.rstyle&&this.rstyle.fBlocks)for(var f=this.rstyle.fBlocks,d=0;d<f.length;++d)if(e=f[d],(this.csstype&&e.selector==this.csstype||c.fId&&e.selector=="#"+c.fId||
c.fCssClass&&e.selector=="."+c.fCssClass)&&e.map&&e.map.m&&(e=e.map.m[a]))return e.v;return b};d.TObjectPainter.prototype.v7SetAttr=function(a,b){var c=this.GetObject();c&&c.fAttr&&c.fAttr.m&&(c.fAttr.m[a]={v:b})};d.TObjectPainter.prototype.v7EvalLength=function(a,b,c){0>=b&&(b=1);a=this.v7EvalAttr(a);if(void 0===a)return Math.round(c*b);if("number"==typeof a)return Math.round(a*b);for(var e=0,f=0,d=a,m=0,k=0;0<d.length;){for(;k<d.length&&(" "==d[k]||"\t"==d[k]);)++k;if(k>=d.length)break;if("-"==
d[k]||"+"==d[k]){if(m)return console.log("Fail to parse RPadLength "+a),c;m="-"==d[k]?-1:1;k++}else{0<k&&(d=d.substr(k),k=0);for(;k<d.length&&("0"<=d[k]&&"9">=d[k]||"."==d[k]);)k++;var p=parseFloat(d.substr(0,k));if(isNaN(p))return console.log("Fail to parse RPadLength "+a),Math.round(c*b);d=d.substr(k);k=0;m||(m=1);0<d.length&&"%"==d[0]?(d=d.substr(1),e+=m*p*.01):1<d.length&&"p"==d[0]&&"x"==d[1]?(d=d.substr(2),f+=m*p):e+=m*p;m=0}}return Math.round(e*b+f)};d.TObjectPainter.prototype.v7EvalColor=function(a,
b){var c=this.v7EvalAttr(a+"_rgb","");return c?"#"+c+this.v7EvalAttr(a+"_a",""):this.v7EvalAttr(a+"_name","")||b};d.TObjectPainter.prototype.createv7AttFill=function(a){a&&"string"==typeof a||(a="fill_");var b=this.v7EvalColor(a+"color","");a=this.v7EvalAttr(a+"style",1001);this.createAttFill({pattern:a,color:0});this.fillatt.SetSolidColor(b||"none")};d.TObjectPainter.prototype.createv7AttLine=function(a){a&&"string"==typeof a||(a="line_");var b=this.v7EvalColor(a+"color","black"),c=this.v7EvalAttr(a+
"width",1);a=this.v7EvalAttr(a+"style",1);this.createAttLine({color:b,width:c,style:a})};d.TObjectPainter.prototype.createv7AttMarker=function(a){a&&"string"==typeof a||(a="marker_");var b=this.v7EvalColor(a+"color","black"),c=this.v7EvalAttr(a+"size",1);a=this.v7EvalAttr(a+"style",1);this.createAttMarker({color:b,size:c,style:a})};d.TObjectPainter.prototype.v7AttrChange=function(a,b,c,e){if(!this.snapid)return!1;a._typename||(a._typename="ROOT::Experimental::RChangeAttrRequest",a.ids=[],a.names=
[],a.values=[],a.update=!0);a.ids.push(this.snapid);a.names.push(b);b=null;if(null!==c&&void 0!==c)switch(e||("string"==typeof c?e="string":"number"==typeof c&&(e="double")),b={_typename:"ROOT::Experimental::RAttrMap::"},e){case "none":b._typename+="NoValue_t";break;case "bool":b._typename+="BoolValue_t";b.v=c?!0:!1;break;case "int":b._typename+="IntValue_t";b.v=parseInt(c);break;case "double":b._typename+="DoubleValue_t";b.v=parseFloat(c);break;default:b._typename+="StringValue_t",b.v="string"==
typeof c?c:JSON.stringify(c)}a.values.push(b);return!0};d.TObjectPainter.prototype.v7SendAttrChanges=function(a,b){var c=this.canv_painter();c&&a&&a._typename&&(void 0!==b&&(a.update=b?!0:!1),c.v7SubmitRequest("",a))};d.TObjectPainter.prototype.v7SubmitRequest=function(a,b,c){var e=this.canv_painter();return e&&e.SubmitDrawableRequest?this.snapid?e.SubmitDrawableRequest(a,b,this,c):(this._pending_request={_kind:a,_req:b,_method:c},b):null};d.TObjectPainter.prototype.AssignSnapId=function(a){(this.snapid=
a)&&this._pending_request&&(a=this._pending_request,this.v7SubmitRequest(a._kind,a._req,a._method),delete this._pending_request)};d.v7.CommMode={kNormal:1,kLessTraffic:2,kOffline:3};d.TObjectPainter.prototype.v7CommMode=function(){var a=this.canv_painter();return a&&a.SubmitDrawableRequest&&a._websocket?d.v7.CommMode.kNormal:d.v7.CommMode.kOffline};r.prototype=Object.create(d.TObjectPainter.prototype);r.prototype.Cleanup=function(){this.ticks=[];this.func=null;delete this.format;d.TObjectPainter.prototype.Cleanup.call(this)};
r.prototype.SetAxisConfig=function(a,b,c,e,d,h,m){this.name=a;this.kind=b;this.func=c;this.full_min=e;this.full_max=d;this.scale_min=h;this.scale_max=m};r.prototype.format10Exp=function(a,b){var c="";b&&(b=Math.round(b/Math.pow(10,a)),0!=b&&1!=b&&(c=b.toString()+(d.gStyle.Latex?"#times":"x")));c+="10";if(1<d.gStyle.Latex)return c+"^{"+a+"}";b={0:"\u2070",1:"\u00b9",2:"\u00b2",3:"\u00b3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079","-":"\u207b"};a=a.toString();for(var e=0;e<a.length;++e)c+=
b[a[e]];return c};r.prototype.CreateFormatFuncs=function(){var a=this.GetObject(),b=a&&"TGaxis"===a._typename;delete this.format;var c=508;b?c=a.fNdiv:a&&(c=Math.max(a.fNdivisions,4));this.nticks=c%100;this.nticks2=(c%1E4-this.nticks)/100;this.nticks3=Math.floor(c/1E4);a&&!b&&7<this.nticks&&(this.nticks=7);c=Math.abs(this.func.range()[1]-this.func.range()[0]);0>=c&&(c=100);if("time"==this.kind){8<this.nticks&&(this.nticks=8);b=this.scale_max-this.scale_min;a=d.Painter.getTimeFormat(a);c=d.Painter.chooseTimeFormat(b/
c,!1);if(0==a.length||b<.1*(this.full_max-this.full_min))a=d.Painter.chooseTimeFormat(b/this.nticks,!0);this.tfunc1=this.tfunc2=g.timeFormat(a);c!==a&&(this.tfunc2=g.timeFormat(c));this.format=function(a,b){return b?this.tfunc1(a):this.tfunc2(a)}}else"log"==this.kind?(1<this.nticks2&&(this.nticks*=this.nticks2,this.nticks2=1),this.noexp=a?a.TestBit(d.EAxisBits.kNoExponent):!1,300>this.scale_max&&.3<this.scale_min&&(this.noexp=!0),this.moreloglabels=a?a.TestBit(d.EAxisBits.kMoreLogLabels):!1,this.format=
function(a,b,c){a=parseFloat(a);var e=Math.round(a);if(!b)return e===a&&1E9>Math.abs(e)?e.toString():d.FFormat(a,c||d.gStyle.fStatFormat);if(0>=a)return null;b=d.log10(a);return this.moreloglabels||.001>Math.abs(b-Math.round(b))?this.noexp||c?0>b?a.toFixed(Math.round(-b+.5)):a.toFixed(0):this.format10Exp(Math.floor(b+.01),a):null}):"labels"==this.kind?(this.nticks=50,b=this.scale_max-this.scale_min,this.nticks>b&&(this.nticks=Math.round(b)),this.nticks2=1,this.regular_labels=!0,a&&a.fNbins&&a.fLabels&&
(a.fNbins!=Math.round(a.fXmax-a.fXmin)||0!=a.fXmin||a.fXmax!=a.fNbins)&&(this.regular_labels=!1),this.axis=a,this.format=function(a){a=parseFloat(a);this.regular_labels||(a=(a-this.axis.fXmin)/(this.axis.fXmax-this.axis.fXmin)*this.axis.fNbins);a=Math.round(a);if(0>a||a>=this.axis.fNbins)return null;for(var b=0;b<this.axis.fLabels.arr.length;++b){var c=this.axis.fLabels.arr[b];if(c.fUniqueID===a+1)return c.fString}return null}):(this.ndig=this.order=0,this.format=function(a,b,c){a=parseFloat(a);b&&
this.order&&(a/=Math.pow(10,this.order));return a===Math.round(a)?1E9>Math.abs(a)?a.toFixed(0):a.toExponential(4):b?10<this.ndig?a.toExponential(this.ndig-11):a.toFixed(this.ndig):d.FFormat(a,c||d.gStyle.fStatFormat)})};r.prototype.ProduceTicks=function(a,b){if(!this.noticksopt)return this.func.ticks(a*(b||1));b&&(a=(a-1)*b);b=this.func.domain();for(var c=[],e=0;e<=a;++e)c.push((b[0]*(a-e)+b[1]*e)/a);return c};r.prototype.CreateTicks=function(a,b,c,e){c&&this.nticks&&"normal"==this.kind&&(this.noticksopt=
!0);c={nminor:0,nmiddle:0,nmajor:0,func:this.func};c.minor=c.middle=c.major=this.ProduceTicks(this.nticks);if(a)return e=c.major,c=1E-5*(this.scale_max-this.scale_min),e[0]>this.scale_min+c&&e.unshift(this.scale_min),e[e.length-1]<this.scale_max-c&&e.push(this.scale_max),e;if("labels"==this.kind&&!this.regular_labels)for(c.lbl_pos=[],a=0;a<this.axis.fNbins;++a){var f=this.axis.fXmin+a/this.axis.fNbins*(this.axis.fXmax-this.axis.fXmin);f>=this.scale_min&&f<this.scale_max&&c.lbl_pos.push(f)}1<this.nticks2&&
((c.minor=c.middle=this.ProduceTicks(c.major.length,this.nticks2),a=Math.abs(this.func.range()[1]-this.func.range()[0]),c.middle.length<=c.major.length||c.middle.length>a/3.5)?c.minor=c.middle=c.major:1<this.nticks3&&"log"!==this.kind&&(c.minor=this.ProduceTicks(c.middle.length,this.nticks3),c.minor.length<=c.middle.length||c.minor.length>a/1.7)&&(c.minor=c.middle));c.reset=function(){this.nminor=this.nmiddle=this.nmajor=0};c.next=function(a){if(this.nminor>=this.minor.length)return!1;this.tick=this.minor[this.nminor++];
this.grpos=this.func(this.tick);a&&(this.grpos=Math.round(this.grpos));this.kind=3;this.nmiddle<this.middle.length&&1>Math.abs(this.grpos-this.func(this.middle[this.nmiddle]))&&(this.nmiddle++,this.kind=2);this.nmajor<this.major.length&&1>Math.abs(this.grpos-this.func(this.major[this.nmajor]))&&(this.nmajor++,this.kind=1);return!0};c.last_major=function(){return 1!==this.kind?!1:this.nmajor==this.major.length};c.next_major_grpos=function(){return this.nmajor>=this.major.length?null:this.func(this.major[this.nmajor])};
this.ndig=this.order=0;if("normal"==this.kind&&0<c.major.length){var h=a=0;f=!1;if(!b){b=Math.max(Math.abs(c.major[0]),Math.abs(c.major[c.major.length-1]));var m=Math.min(Math.abs(c.major[0]),Math.abs(c.major[c.major.length-1])),k=0<b?3*Math.round(d.log10(b)/3):0,p=0<m?3*Math.round(d.log10(m)/3):0;f=2E4>b;if(b||m)a=Math.max(k,p)+3,h=Math.min(k,p)-3}b=0;m=this.ndig;for(k=1E10;h<=a;h+=3)if(!f||3!==h){this.order=h;this.ndig=0;p=[];for(var g=0,q=0;g<c.major.length;){var u=this.format(c.major[g],!0);if(0>
p.indexOf(u))p.push(u),q+=u.length,g++;else{if(11<++this.ndig)break;p=[];q=g=0}}!h&&4>this.ndig&&(q-=2*c.major.length+3);q<k&&(k=q,b=this.order,m=this.ndig)}this.order=b;this.ndig=m;e&&(this.order&&console.warn("Axis painter - integer labels are configured, but axis order "+this.order+" is preferable"),this.ndig&&console.warn("Axis painter - integer labels are configured, but "+this.ndig+" decimal digits are required"),this.order=this.ndig=0)}return c};r.prototype.IsCenterLabels=function(){if("labels"===
this.kind)return!0;if("log"===this.kind)return!1;var a=this.GetObject();return a&&a.TestBit(d.EAxisBits.kCenterLabels)};r.prototype.AddTitleDrag=function(a,b,c,e,f){if(d.gStyle.MoveResize){var h=this,m=null,k="",p,E,q,u,z,l;if(3===d._test_d3_){k="drag";var n=g.behavior.drag().origin(Object)}else n=g.drag().subject(Object);n.on(k+"start",function(){g.event.sourceEvent.preventDefault();g.event.sourceEvent.stopPropagation();var c=a.node().getBBox(),k=h.GetObject();q=p=a.property("shift_x");u=E=a.property("shift_y");
z=b?0<p:0<E;l=k.TestBit(d.EAxisBits.kCenterTitle)?e===b?f:0:Math.round(f/2);m=a.append("rect").classed("zoom",!0).attr("x",c.x).attr("y",c.y).attr("width",c.width).attr("height",c.height).style("cursor","move")}).on("drag",function(){if(m){g.event.sourceEvent.preventDefault();g.event.sourceEvent.stopPropagation();p+=g.event.dx;E+=g.event.dy;var c=a.property("shift_x"),e=a.property("shift_y");b?(c=p,Math.abs(E-e)>Math.abs(E-l)&&(e=l)):(e=E,Math.abs(p-c)>Math.abs(p-l)&&(c=l));z===(b?0<c:0<e)&&(q=c,
u=e,a.attr("transform","translate("+q+","+u+")"))}}).on(k+"end",function(){if(m){g.event.sourceEvent.preventDefault();g.event.sourceEvent.stopPropagation();a.property("shift_x",q).property("shift_y",u);var e=h.GetObject();e.fTitleOffset=(b?q:u)/c;(b?u:q)===l&&e.InvertBit(d.EAxisBits.kCenterTitle);m.remove();m=null}});a.style("cursor","move").call(n)}};r.prototype.DrawAxis=function(a,b,c,e,f,h,m,k,p){function E(a,b){return a&&!b||!a&&b}var q=this.GetObject(),u="",z=b,l=.03,n=100,r=this.pad_width()||
10,t=this.pad_height()||10;this.vertical=a;m?this.invert_side&&(m=-m):m=0;this.createv7AttLine(this.cssprefix+"line_");u=E(a,this.invert_side)?"-S":"+S";l=q.fTickLength;n=a?r:t;z=b.select("."+this.name+"_container");z.empty()?z=b.append("svg:g").attr("class",this.name+"_container"):z.selectAll("*").remove();z.attr("transform",f||null);var v=1;f=0;b=Math.min(r,t);var x=0<=u.indexOf("+"),w=0<=u.indexOf("-"),D=0<=u.indexOf("S");u.indexOf("Y");u.indexOf("0");u.indexOf("O");var I=0<=u.indexOf("U"),y=0<=
u.indexOf("N");u=0<=u.indexOf("I");var K=q.TestBit(d.EAxisBits.kNoExponent);x&&w?f=v=1:w?v=E(h,a)?1:-1:x&&(v=E(h,a)?-1:1);l=Math.round((D?l:.03)*n);this.max_tick_size&&l>this.max_tick_size&&(l=this.max_tick_size);this.CreateFormatFuncs();w=x="";D=n=0;this.ticks=[];for(var B=this.CreateTicks(!1,K,y,u);B.next(!0);)y=Math.round(l/4),u=0,3>B.kind&&(y=Math.round(l/2)),1==B.kind&&("format"in this&&null===this.format(B.tick,!0)||(y=l),this.ticks.push(B.grpos)),0<f?u=-y:0>v?(u=-y,y=0):u=0,0==x.length?(x=
a?"M"+y+","+B.grpos:"M"+B.grpos+","+-y,w=a?"M"+(m-y)+","+B.grpos:"M"+B.grpos+","+(m+y)):(x+=a?"m"+(y-D)+","+(B.grpos-n):"m"+(B.grpos-n)+","+(D-y),w+=a?"m"+(D-y)+","+(B.grpos-n):"m"+(B.grpos-n)+","+(y-D)),x+=a?"h"+(u-y):"v"+(y-u),w+=a?"h"+(y-u):"v"+(u-y),n=B.grpos,D=u;0<x.length&&!k&&z.append("svg:path").attr("d",x).call(this.lineatt.func);0!==m&&0<w.length&&!k&&z.append("svg:path").attr("d",w).call(this.lineatt.func);m=Math.round(1>q.fLabelSize?q.fLabelSize*b:q.fLabelSize);if(0>=m||1.1<Math.abs(q.fLabelOffset))I=
!0;if(!k&&!I){I=this.get_color(q.fLabelColor);y=Math.round(q.fLabelOffset*b);u=this.IsCenterLabels();K=q.TestBit(d.EAxisBits.kLabelsVert);x=1;w=0;D=!1;var A=null,L=[z.append("svg:g").attr("class","axis_labels")];B=B.lbl_pos||B.major;this.lbls_both_sides&&L.push(z.append("svg:g").attr("class","axis_labels").attr("transform",a?"translate("+c+",0)":"translate(0,"+-e+")"));for(var H=0;H<L.length;++H){0<H&&(v=-v);n=0;var C=a?-y*v:(y+2)*v+f*l;A=d.Painter.getFontDetails(q.fLabelFont,m);this.StartTextDrawing(A,
"font",L[H]);for(var M=0;M<B.length;++M){var N=this.format(B[M],!0);if(null!==N){var J=Math.round(this.func(B[M])),R=0<M?Math.abs(Math.round(J-this.func(B[M-1]))):0,S=M<B.length-1?Math.abs(Math.round(this.func(B[M+1])-J)):0;if(u){var F=S||R;J=Math.round(J-(a?.5*F:-.5*F));if(-5>J||J>(a?e:c)+5)continue}F={text:N,color:I,latex:1,draw_g:L[H]};w=Math.max(w,N.length);a?(F.x=C,F.y=J,F.align=K?0>v?23:20:0>v?12:32):(F.x=J,F.y=C,F.align=K?0>v?12:32:0>v?20:23);K&&(F.rotate=270);(N=this.DrawText(F))&&(!a&&!K||
a&&K)&&"log"!=this.kind?(F=.45*R+.45*S,R?S||(F=.9*R):F=.9*S,x=Math.min(x,F/N)):a&&p&&!H&&20<p-y&&N>p-y&&(x=Math.min(x,(p-y)/N));n&&J!=n&&(a&&!K||!a&&K)&&(x=Math.min(x,.9*Math.abs(J-n)/m));n=J}}this.order&&this.DrawText({color:I,x:a?5*v:c+5,y:this.has_obstacle?C:a?-3:-3*v,align:a?0>v?30:10:E(this.has_obstacle,0>v)?13:10,latex:1,text:"#times"+this.format10Exp(this.order),draw_g:L[H]})}.01<x&&.7>x&&!a&&!K&&5<w&&!this.lbls_both_sides&&(D=!0,x*=3);for(H=0;H<L.length;++H).01<x&&1>x&&this.TextScaleFactor(1/
x,L[H]),this.FinishTextDrawing(L[H]),D&&L[H].selectAll("text").each(function(){var a=g.select(this),b=a.attr("transform");a.attr("transform",b+" rotate(25)").style("text-anchor","start")});1<L.length&&(v=-v);A&&(m=A.size)}d.gStyle.Zooming&&!this.disable_zooming&&(p=z.append("svg:rect").attr("class","axis_zoom").style("opacity","0").style("cursor","crosshair"),a?p.attr("x",0<v?-2*m-3:3).attr("y",0).attr("width",2*m+3).attr("height",e):p.attr("x",0).attr("y",0<v?0:-m-3).attr("width",c).attr("height",
m+3));if(0<q.fTitle.length&&!k){var O=z.append("svg:g").attr("class","axis_title"),V=1<=q.fTitleSize?q.fTitleSize:Math.round(q.fTitleSize*b);k=1.6*(1>q.fTitleSize?q.fTitleSize:q.fTitleSize/(this.pad_height("")||10));p=q.TestBit(d.EAxisBits.kCenterTitle);l=q.TestBit(d.EAxisBits.kRotateTitle)?-1:1;b=this.get_color(q.fTitleColor);var Q=0,T=0;this.StartTextDrawing(q.fTitleFont,V,O);f=0>l&&!h||0<=l&&h;a?(k*=-v*r,Q=Math.round(k*q.fTitleOffset),T=Math.round(p?e/2:h?e:0),this.DrawText({align:(p?"middle":
f?"begin":"end")+";middle",rotate:0>l?90:270,text:q.fTitle,color:b,draw_g:O})):(k*=v*t,Q=Math.round(p?c/2:h?0:c),T=Math.round(k*q.fTitleOffset),this.DrawText({align:(p?"middle":f?"begin":"end")+";middle",rotate:0>l?180:0,text:q.fTitle,color:b,draw_g:O}));var U=null;a&&0==q.fTitleOffset&&"getBoundingClientRect"in z.node()&&(U=z.node().getBoundingClientRect());this.FinishTextDrawing(O,function(){if(U){var a=O.node().getBoundingClientRect();Q=0<v?Math.round(U.left-a.right-.3*V):Math.round(U.right-a.left+
.3*V)}O.attr("transform","translate("+Q+","+T+")").property("shift_x",Q).property("shift_y",T)});this.AddTitleDrag(O,a,k,h,a?e:c)}this.position=0;"getBoundingClientRect"in z.node()&&(a=z.node().getBoundingClientRect(),c=this.svg_pad().node().getBoundingClientRect(),this.position=a.left-c.left)};r.prototype.Redraw=function(){var a=this.GetObject(),b=this.AxisToSvg("x",a.fX1),c=this.AxisToSvg("y",a.fY1),e=this.AxisToSvg("x",a.fX2),f=this.AxisToSvg("y",a.fY2),h=e-b,m=c-f,k=Math.abs(h)<Math.abs(m),p=
!1,E=a.fWmin,q=a.fWmax,l=E,z=q;if(0<=a.fChopt.indexOf("t")){var n=g.scaleTime();var r="time";this.toffset=d.Painter.getTimeOffset(a);l=new Date(this.toffset+1E3*E);z=new Date(this.toffset+1E3*q)}else 0<=a.fChopt.indexOf("G")?(n=g.scaleLog(),r="log"):(n=g.scaleLinear(),r="normal");n.domain([l,z]);k?0<m?n.range([m,0]):(f=c,m=-m,p=!0,n.range([0,m])):0<h?n.range([0,h]):(b=e,h=-h,p=!0,n.range([h,0]));this.SetAxisConfig(k?"yaxis":"xaxis",r,n,E,q,E,q);this.CreateG();this.DrawAxis(k,this.draw_g,h,m,"translate("+
b+","+f+")",p)};l.prototype=Object.create(d.TooltipHandler.prototype);l.prototype.frame_painter=function(){return this};l.prototype.SetActive=function(a){};l.prototype.GetTipName=function(a){var b=d.TooltipHandler.prototype.GetTipName.call(this)||"RFrame";a&&(b+=a);return b};l.prototype.Shrink=function(a,b){this.fX1NDC+=a;this.fX2NDC-=b};l.prototype.SetLastEventPos=function(a){this.fLastEventPnt=a};l.prototype.GetLastEventPos=function(){return this.fLastEventPnt};l.prototype.UpdateAttributes=function(a){this.GetObject();
if(void 0===this.fX1NDC||a&&!this.modified_NDC){a=this.pad_width();var b=this.pad_height();this.fX1NDC=this.v7EvalLength("margin_left",a,d.gStyle.FrameNDC.fX1NDC)/a;this.fY1NDC=this.v7EvalLength("margin_bottom",b,d.gStyle.FrameNDC.fY1NDC)/b;this.fX2NDC=1-this.v7EvalLength("margin_right",a,1-d.gStyle.FrameNDC.fX2NDC)/a;this.fY2NDC=1-this.v7EvalLength("margin_top",b,1-d.gStyle.FrameNDC.fY2NDC)/b}this.fillatt||this.createv7AttFill("fill_");this.createv7AttLine("border_")};l.prototype.ProjectAitoff2xy=
function(a,b){var c=Math.PI/180;a=a/2*c;b*=c;var e=Math.sqrt(2),d=2*e/Math.PI,h=Math.cos(b),m=Math.sqrt(1+h*Math.cos(a));return{x:h*Math.sin(a)*2*e/m/d/c,y:Math.sin(b)*e/m/d/c}};l.prototype.ProjectMercator2xy=function(a,b){return{x:a,y:Math.log(Math.tan((Math.PI/2+b/180*Math.PI)/2))}};l.prototype.ProjectSinusoidal2xy=function(a,b){return{x:a*Math.cos(b/180*Math.PI),y:b}};l.prototype.ProjectParabolic2xy=function(a,b){return{x:a*(2*Math.cos(2*b/180*Math.PI/3)-1),y:180*Math.sin(b/180*Math.PI/3)}};l.prototype.RecalculateRange=
function(a){if(a){var b=[];if(1==a)b.push(this.ProjectAitoff2xy(this.scale_xmin,this.scale_ymin)),b.push(this.ProjectAitoff2xy(this.scale_xmin,this.scale_ymax)),b.push(this.ProjectAitoff2xy(this.scale_xmax,this.scale_ymax)),b.push(this.ProjectAitoff2xy(this.scale_xmax,this.scale_ymin)),0>this.scale_ymin&&0<this.scale_ymax&&(b.push(this.ProjectAitoff2xy(.9999*this.scale_xmin,0)),b.push(this.ProjectAitoff2xy(.9999*this.scale_xmax,0))),0>this.scale_xmin&&0<this.scale_xmax&&(b.push(this.ProjectAitoff2xy(0,
this.scale_ymin)),b.push(this.ProjectAitoff2xy(0,this.scale_ymax)));else if(2==a){if(-90>=this.scale_ymin||90<=this.scale_ymax){console.warn("Mercator Projection","Latitude out of range",this.scale_ymin,this.scale_ymax);this.options.Proj=0;return}b.push(this.ProjectMercator2xy(this.scale_xmin,this.scale_ymin));b.push(this.ProjectMercator2xy(this.scale_xmax,this.scale_ymax))}else 3==a?(b.push(this.ProjectSinusoidal2xy(this.scale_xmin,this.scale_ymin)),b.push(this.ProjectSinusoidal2xy(this.scale_xmin,
this.scale_ymax)),b.push(this.ProjectSinusoidal2xy(this.scale_xmax,this.scale_ymax)),b.push(this.ProjectSinusoidal2xy(this.scale_xmax,this.scale_ymin)),0>this.scale_ymin&&0<this.scale_ymax&&(b.push(this.ProjectSinusoidal2xy(this.scale_xmin,0)),b.push(this.ProjectSinusoidal2xy(this.scale_xmax,0))),0>this.scale_xmin&&0<this.scale_xmax&&(b.push(this.ProjectSinusoidal2xy(0,this.scale_ymin)),b.push(this.ProjectSinusoidal2xy(0,this.scale_ymax)))):4==a&&(b.push(this.ProjectParabolic2xy(this.scale_xmin,this.scale_ymin)),
b.push(this.ProjectParabolic2xy(this.scale_xmin,this.scale_ymax)),b.push(this.ProjectParabolic2xy(this.scale_xmax,this.scale_ymax)),b.push(this.ProjectParabolic2xy(this.scale_xmax,this.scale_ymin)),0>this.scale_ymin&&0<this.scale_ymax&&(b.push(this.ProjectParabolic2xy(this.scale_xmin,0)),b.push(this.ProjectParabolic2xy(this.scale_xmax,0))),0>this.scale_xmin&&0<this.scale_xmax&&(b.push(this.ProjectParabolic2xy(0,this.scale_ymin)),b.push(this.ProjectParabolic2xy(0,this.scale_ymax))));this.original_xmin=
this.scale_xmin;this.original_xmax=this.scale_xmax;this.original_ymin=this.scale_ymin;this.original_ymax=this.scale_ymax;this.scale_xmin=this.scale_xmax=b[0].x;this.scale_ymin=this.scale_ymax=b[0].y;for(a=1;a<b.length;++a)this.scale_xmin=Math.min(this.scale_xmin,b[a].x),this.scale_xmax=Math.max(this.scale_xmax,b[a].x),this.scale_ymin=Math.min(this.scale_ymin,b[a].y),this.scale_ymax=Math.max(this.scale_ymax,b[a].y)}};l.prototype.DrawGrids=function(){var a=this.svg_frame().select(".grid_layer");a.selectAll(".xgrid").remove();
a.selectAll(".ygrid").remove();var b=this.frame_height(),c=this.frame_width(),e=this.v7EvalAttr("gridx",!1),f=this.v7EvalAttr("gridy",!1),h=d.gStyle.fGridStyle,m=0<d.gStyle.fGridColor?this.get_color(d.gStyle.fGridColor):"black";if(0>h||h>=d.Painter.root_line_styles.length)h=11;if(this.x_handle&&e){e="";for(var k=0;k<this.x_handle.ticks.length;++k)e=this.swap_xy?e+("M0,"+this.x_handle.ticks[k]+"h"+c):e+("M"+this.x_handle.ticks[k]+",0v"+b);0<e.length&&a.append("svg:path").attr("class","xgrid").attr("d",
e).style("stroke",m).style("stroke-width",d.gStyle.fGridWidth).style("stroke-dasharray",d.Painter.root_line_styles[h])}if(this.y_handle&&f){e="";for(k=0;k<this.y_handle.ticks.length;++k)e=this.swap_xy?e+("M"+this.y_handle.ticks[k]+",0v"+b):e+("M0,"+this.y_handle.ticks[k]+"h"+c);0<e.length&&a.append("svg:path").attr("class","ygrid").attr("d",e).style("stroke",m).style("stroke-width",d.gStyle.fGridWidth).style("stroke-dasharray",d.Painter.root_line_styles[h])}};l.prototype.AxisAsText=function(a,b){if("x"==
a){if("time"==this.x_kind&&(b=this.ConvertX(b)),this.x_handle&&"format"in this.x_handle)return this.x_handle.format(b,!1,d.gStyle.XValuesFormat)}else if("y"==a){if("time"==this.y_kind&&(b=this.ConvertY(b)),this.y_handle&&"format"in this.y_handle)return this.y_handle.format(b,!1,d.gStyle.YValuesFormat)}else if(this.z_handle&&"format"in this.z_handle)return this.z_handle.format(b,!1,d.gStyle.ZValuesFormat);return b.toPrecision(4)};l.prototype.SetAxesRanges=function(a,b,c,e,d,h){if(!this.axes_drawn){if(this.xmin==
this.xmax){var f=this.v7EvalAttr("x_min");var k=this.v7EvalAttr("x_max");void 0!==f&&(a=f);void 0!==k&&(b=k);a<b&&(this.xmin=a,this.xmax=b);this.zoom_xmin!=this.zoom_xmax||this.zoom_changed_interactive||(f=this.v7EvalAttr("x_zoommin"),k=this.v7EvalAttr("x_zoommax"),void 0===f&&void 0===k)||(this.zoom_xmin=void 0===f?this.xmin:f,this.zoom_xmax=void 0===k?this.xmax:k)}this.ymin!=this.ymax||(f=this.v7EvalAttr("y_min"),k=this.v7EvalAttr("y_max"),void 0!==f&&(c=f),void 0!==k&&(e=k),c<e&&(this.ymin=c,this.ymax=
e),this.zoom_ymin!=this.zoom_ymax||this.zoom_changed_interactive||(f=this.v7EvalAttr("y_zoommin"),k=this.v7EvalAttr("y_zoommax"),void 0===f&&void 0===k))||(this.zoom_ymin=void 0===f?this.ymin:f,this.zoom_ymax=void 0===k?this.ymax:k);this.zmin!=this.zmax||(f=this.v7EvalAttr("z_min"),k=this.v7EvalAttr("z_max"),void 0!==f&&(d=f),void 0!==k&&(h=k),d<h&&(this.zmin=d,this.zmax=h),this.zoom_zmin!=this.zoom_zmax||this.zoom_changed_interactive||(f=this.v7EvalAttr("z_zoommin"),k=this.v7EvalAttr("z_zoommax"),
void 0===f&&void 0===k))||(this.zoom_zmin=void 0===f?this.zmin:f,this.zoom_zmax=void 0===k?this.zmax:k)}};l.prototype.DrawAxes=function(){if(this.axes_drawn)return!0;if(this.xmin==this.xmax||this.ymin==this.ymax)return!1;this.CleanupAxes();this.CleanXY();this.CreateXY();var a=this.svg_frame().select(".axis_layer"),b=this.frame_width(),c=this.frame_height();this.x_handle=new r(!0,"x_");this.x_handle.SetDivId(this.divid,-1);this.x_handle.pad_name=this.pad_name;this.x_handle.rstyle=this.rstyle;this.x_handle.SetAxisConfig("xaxis",
this.logx&&"time"!==this.x_kind?"log":this.x_kind,this.x,this.xmin,this.xmax,this.scale_xmin,this.scale_xmax);this.x_handle.invert_side=!1;this.x_handle.lbls_both_sides=!1;this.x_handle.has_obstacle=!1;this.y_handle=new r(!0,"y_");this.y_handle.SetDivId(this.divid,-1);this.y_handle.pad_name=this.pad_name;this.y_handle.rstyle=this.rstyle;this.y_handle.SetAxisConfig("yaxis",this.logy&&"time"!==this.y_kind?"log":this.y_kind,this.y,this.ymin,this.ymax,this.scale_ymin,this.scale_ymax);this.y_handle.invert_side=
!1;this.y_handle.lbls_both_sides=!1;var e=this.swap_xy?this.y_handle:this.x_handle,d=this.swap_xy?this.x_handle:this.y_handle,h=!1;if(!h){var m=this.pad_painter();m&&m._fast_drawing&&(h=!0)}h||(e.DrawAxis(!1,a,b,c,e.invert_side?void 0:"translate(0,"+c+")",!1,0,h),d.DrawAxis(!0,a,b,c,d.invert_side?"translate("+b+",0)":void 0,!1,0,h,d.invert_side?0:this.frame_x()),this.DrawGrids());return this.axes_drawn=!0};l.prototype.SizeChanged=function(){var a={};this.v7AttrChange(a,"margin_left",this.fX1NDC);
this.v7AttrChange(a,"margin_bottom",this.fY1NDC);this.v7AttrChange(a,"margin_right",1-this.fX2NDC);this.v7AttrChange(a,"margin_top",1-this.fY2NDC);this.v7SendAttrChanges(a,!1);this.RedrawPad()};l.prototype.CleanXY=function(){delete this.x;delete this.grx;delete this.ConvertX;delete this.RevertX;delete this.y;delete this.gry;delete this.ConvertY;delete this.RevertY;delete this.z;delete this.grz};l.prototype.CleanupAxes=function(){this.x_handle&&(this.x_handle.Cleanup(),delete this.x_handle);this.y_handle&&
(this.y_handle.Cleanup(),delete this.y_handle);this.z_handle&&(this.z_handle.Cleanup(),delete this.z_handle);this.draw_g&&(this.draw_g.select(".grid_layer").selectAll("*").remove(),this.draw_g.select(".axis_layer").selectAll("*").remove());this.axes_drawn=!1};l.prototype.CleanFrameDrawings=function(){"function"===typeof this.Create3DScene&&this.Create3DScene(-1);this.CleanupAxes();this.CleanXY();this.scale_zmin=this.scale_zmax=this.scale_ymin=this.scale_ymax=this.scale_xmin=this.scale_xmax=this.zoom_zmin=
this.zoom_zmax=this.zoom_ymin=this.zoom_ymax=this.zoom_xmin=this.zoom_xmax=this.zmin=this.zmax=this.ymin=this.ymax=this.xmin=this.xmax=0;this.draw_g&&(this.draw_g.select(".main_layer").selectAll("*").remove(),this.draw_g.select(".upper_layer").selectAll("*").remove())};l.prototype.Cleanup=function(){this.CleanFrameDrawings();this.draw_g&&(this.draw_g.selectAll("*").remove(),this.draw_g.on("mousedown",null).on("dblclick",null).on("wheel",null).on("contextmenu",null).property("interactive_set",null));
this.keys_handler&&(window.removeEventListener("keydown",this.keys_handler,!1),this.keys_handler=null);this.draw_g=null;delete this._click_handler;delete this._dblclick_handler;d.TooltipHandler.prototype.Cleanup.call(this)};l.prototype.Redraw=function(){var a=this.pad_painter();a&&(a.frame_painter_ref=this);this.UpdateAttributes();var b=this.pad_width(),c=this.pad_height(),e=Math.round(b*this.fX1NDC);b=Math.round(b*(this.fX2NDC-this.fX1NDC));var f=Math.round(c*(1-this.fY2NDC));c=Math.round(c*(this.fY2NDC-
this.fY1NDC));var h=!1,m=!1,k="translate("+e+","+f+")";a&&a.options&&(a.options.RotateFrame&&(h=!0),a.options.FixFrame&&(m=!0));if(h){k+=" rotate(-90) translate("+-c+",0)";var p=b;b=c;c=p}this._frame_x=e;this._frame_y=f;this._frame_width=b;this._frame_height=c;if(!this.mode3d){this.draw_g=this.svg_layer("primitives_layer").select(".root_frame");if(this.draw_g.empty()){this.draw_g=this.svg_layer("primitives_layer").append("svg:g").attr("class","root_frame");this.draw_g.append("svg:title").text("");
var g=this.draw_g.append("svg:rect");this.draw_g.append("svg:g").attr("class","grid_layer");p=this.draw_g.append("svg:svg").attr("class","main_layer").attr("x",0).attr("y",0).attr("overflow","hidden");this.draw_g.append("svg:g").attr("class","axis_layer");this.draw_g.append("svg:g").attr("class","upper_layer")}else if(g=this.draw_g.select("rect"),p=this.draw_g.select(".main_layer"),this.axes_drawn){var q=this.v7EvalAttr("x_zoommin"),l=this.v7EvalAttr("x_zoommax"),n=this.v7EvalAttr("y_zoommin"),r=
this.v7EvalAttr("y_zoommax");console.log("TODO: RFrame zooming update",q,l,n,r)}this.axes_drawn=!1;this.draw_g.attr("transform",k);g.attr("x",0).attr("y",0).attr("width",b).attr("height",c).call(this.fillatt.func).call(this.lineatt.func);p.attr("width",b).attr("height",c).attr("viewBox","0 0 "+b+" "+c);d.BatchMode||(this.draw_g.attr("x",e).attr("y",f).attr("width",b).attr("height",c),h||m||this.AddDrag({obj:this,only_resize:!0,minwidth:20,minheight:20,redraw:this.SizeChanged.bind(this)}),p.style("pointer-events",
"visibleFill").property("handlers_set",0),e=a&&a._fast_drawing?0:1,p.property("handlers_set")!=e&&(a=e?this.ProcessTooltipEvent.bind(this,null):null,f=e?this.ProcessTooltipEvent.bind(this,{handler:!0,touch:!1}):null,p.property("handlers_set",e).on("mouseenter",f).on("mousemove",f).on("mouseleave",a),d.touches&&(e=e?this.ProcessTooltipEvent.bind(this,{handler:!0,touch:!0}):null,p.on("touchstart",e).on("touchmove",e).on("touchend",a).on("touchcancel",a))),p.attr("x",0).attr("y",0).attr("width",b).attr("height",
c),b=this.hints_layer().select(".objects_hints"),!b.empty()&&this.IsTooltipAllowed()&&b.property("hints_pad")==this.pad_name&&setTimeout(this.ProcessTooltipEvent.bind(this,b.property("last_point")),10))}};l.prototype.GetFrameRect=function(){return{x:this.frame_x(),y:this.frame_y(),width:this.frame_width(),height:this.frame_height(),transform:this.draw_g?this.draw_g.attr("transform"):"",hint_delta_x:0,hint_delta_y:0}};l.prototype.GetPalette=function(a){if(a=this.FindPainterFor(void 0,void 0,"ROOT::Experimental::RPaletteDrawable"))return a.GetPalette();
this.fDfltPalette||(this.fDfltPalette={_typename:"ROOT::Experimental::RPalette",fColors:[{fOrdinal:0,fColor:{fRGBA:[53,42,135]}},{fOrdinal:.125,fColor:{fRGBA:[15,92,221]}},{fOrdinal:.25,fColor:{fRGBA:[20,129,214]}},{fOrdinal:.375,fColor:{fRGBA:[6,164,202]}},{fOrdinal:.5,fColor:{fRGBA:[46,183,164]}},{fOrdinal:.625,fColor:{fRGBA:[135,191,119]}},{fOrdinal:.75,fColor:{fRGBA:[209,187,89]}},{fOrdinal:.875,fColor:{fRGBA:[254,200,50]}},{fOrdinal:1,fColor:{fRGBA:[249,251,14]}}],fInterpolate:!0,fNormalized:!0},
d.addMethods(this.fDfltPalette,"ROOT::Experimental::RPalette"));return this.fDfltPalette};l.prototype.ProcessFrameClick=function(a,b){var c=this.pad_painter();if(c){a.painters=!0;a.disabled=!0;for(var e=c.GetTooltips(a),d=null,h=0;h<e.length&&!d;++h)e[h]&&e[h].exact&&(d=e[h]);var m;d&&(e=b?this._dblclick_handler:this._click_handler)&&(m=e(d.user_info,a));b||c.SelectObjectPainter(d?d.painter:this,{x:a.x+(this._frame_x||0),y:a.y+(this._frame_y||0)});return m}};l.prototype.ConfigureUserClickHandler=
function(a){this._click_handler=a&&"function"==typeof a?a:null};l.prototype.ConfigureUserDblclickHandler=function(a){this._dblclick_handler=a&&"function"==typeof a?a:null};l.prototype.Zoom=function(a,b,c,e,f,h){if(this.options&&this.options.Proj)return!1;"x"===a?(a=b,b=c,c=void 0):"y"===a?(e=c,c=b,a=b=void 0):"z"===a&&(f=b,h=c,a=b=c=void 0);var m=a!==b,k=c!==e,p=f!==h,g=!1,q=!1,l=!1;if(m){var n=0;a<=this.xmin&&(a=this.xmin,n++);b>=this.xmax&&(b=this.xmax,n++);2===n&&(m=!1,g=!0)}else g=a===b&&0===
a;k?(n=0,c<=this.ymin&&(c=this.ymin,n++),e>=this.ymax&&(e=this.ymax,n++),2===n&&(k=!1,q=!0)):q=c===e&&0===c;p?(n=0,f<=this.zmin&&(f=this.zmin,n++),h>=this.zmax&&(h=this.zmax,n++),2===n&&(p=!1,l=!0)):l=f===h&&0===f;var r=!1,t=this,G={},A="",v="",x="",w={_typename:"ROOT::Experimental::RFrame::RUserRanges",values:[0,0,0,0,0,0],flags:[!1,!1,!1,!1,!1,!1]};(m||k||p)&&this.ForEachPainter(function(d){m&&d.CanZoomIn("x",a,b)&&(t.zoom_xmin=a,t.zoom_xmax=b,r=!0,A="0",m=!1,t.v7AttrChange(G,"x_zoommin",a),t.v7AttrChange(G,
"x_zoommax",b),w.values[0]=a,w.values[1]=b,w.flags[0]=w.flags[1]=!0);k&&d.CanZoomIn("y",c,e)&&(t.zoom_ymin=c,t.zoom_ymax=e,r=!0,v="1",k=!1,t.v7AttrChange(G,"y_zoommin",c),t.v7AttrChange(G,"y_zoommax",e),w.values[2]=c,w.values[3]=e,w.flags[2]=w.flags[3]=!0);p&&d.CanZoomIn("z",f,h)&&(t.zoom_zmin=f,t.zoom_zmax=h,r=!0,x="2",p=!1,t.v7AttrChange(G,"z_zoommin",f),t.v7AttrChange(G,"z_zoommax",h),w.values[4]=f,w.values[5]=h,w.flags[4]=w.flags[5]=!0)});if(g||q||l)g&&(this.zoom_xmin!==this.zoom_xmax&&(r=!0,
A="0"),this.zoom_xmin=this.zoom_xmax=0,t.v7AttrChange(G,"x_zoommin",null),t.v7AttrChange(G,"x_zoommax",null),w.values[0]=w.values[1]=-1),q&&(this.zoom_ymin!==this.zoom_ymax&&(r=!0,v="1"),this.zoom_ymin=this.zoom_ymax=0,t.v7AttrChange(G,"y_zoommin",null),t.v7AttrChange(G,"y_zoommax",null),w.values[2]=w.values[3]=-1),l&&(this.zoom_zmin!==this.zoom_zmax&&(r=!0,x="2"),this.zoom_zmin=this.zoom_zmax=0,t.v7AttrChange(G,"z_zoommin",null),t.v7AttrChange(G,"z_zoommax",null),w.values[4]=w.values[5]=-1);this.v7CommMode()==
d.v7.CommMode.kNormal&&this.v7SubmitRequest("zoom",{_typename:"ROOT::Experimental::RFrame::RZoomRequest",ranges:w});r&&this.InteractiveRedraw("pad","zoom"+A+v+x);return r};l.prototype.IsAxisZoomed=function(a){return this["zoom_"+a+"min"]!==this["zoom_"+a+"max"]};l.prototype.Unzoom=function(a,b,c){"undefined"===typeof a?c=b=a=!0:"string"===typeof a&&(c=0<=a.indexOf("z"),b=0<=a.indexOf("y"),a=0<=a.indexOf("x"));var e=this.zoom_changed_interactive;if(a||b||c)this.zoom_changed_interactive=2;var d=this.Zoom(a?
0:void 0,a?0:void 0,b?0:void 0,b?0:void 0,c?0:void 0,c?0:void 0);(a||b||c)&&!d&&(this.zoom_changed_interactive=!isNaN(e)&&0<e?e-1:0);return d};l.prototype.clearInteractiveElements=function(){d.Painter.closeMenu();this.zoom_rect&&(this.zoom_rect.remove(),this.zoom_rect=null);this.zoom_kind=0;this.SwitchTooltip(!0)};l.prototype.mouseDoubleClick=function(){g.event.preventDefault();var a=g.mouse(this.svg_frame().node());this.clearInteractiveElements();var b=0<=a[0]&&a[0]<=this.frame_width(),c=0<=a[1]&&
a[1]<=this.frame_height();b&&c&&this._dblclick_handler&&this.ProcessFrameClick({x:a[0],y:a[1]},!0)||(a="xyz",b?c||(a=this.swap_xy?"y":"x"):a=this.swap_xy?"x":"y",this.Unzoom(a))};l.prototype.startRectSel=function(){if(!(100<this.zoom_kind)&&1===(g.event.which||g.event.button)){g.event.preventDefault();var a=g.mouse(this.svg_frame().node());this.clearInteractiveElements();this.zoom_origin=a;a=this.frame_width();var b=this.frame_height();this.zoom_curr=[Math.max(0,Math.min(a,this.zoom_origin[0])),Math.max(0,
Math.min(b,this.zoom_origin[1]))];0>this.zoom_origin[0]||this.zoom_origin[0]>a?(this.zoom_kind=3,this.zoom_origin[0]=0,this.zoom_origin[1]=this.zoom_curr[1],this.zoom_curr[0]=a,this.zoom_curr[1]+=1):0>this.zoom_origin[1]||this.zoom_origin[1]>b?(this.zoom_kind=2,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_origin[1]=0,this.zoom_curr[0]+=1,this.zoom_curr[1]=b):(this.zoom_kind=1,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_origin[1]=this.zoom_curr[1]);g.select(window).on("mousemove.zoomRect",this.moveRectSel.bind(this)).on("mouseup.zoomRect",
this.endRectSel.bind(this),!0);this.zoom_rect=null;this.SwitchTooltip(!1);g.event.stopPropagation()}};l.prototype.moveRectSel=function(){if(!(0==this.zoom_kind||100<this.zoom_kind)){g.event.preventDefault();var a=g.mouse(this.svg_frame().node());a[0]=Math.max(0,Math.min(this.frame_width(),a[0]));a[1]=Math.max(0,Math.min(this.frame_height(),a[1]));switch(this.zoom_kind){case 1:this.zoom_curr[0]=a[0];this.zoom_curr[1]=a[1];break;case 2:this.zoom_curr[0]=a[0];break;case 3:this.zoom_curr[1]=a[1]}null===
this.zoom_rect&&(this.zoom_rect=this.svg_frame().append("rect").attr("class","zoom").attr("pointer-events","none"));this.zoom_rect.attr("x",Math.min(this.zoom_origin[0],this.zoom_curr[0])).attr("y",Math.min(this.zoom_origin[1],this.zoom_curr[1])).attr("width",Math.abs(this.zoom_curr[0]-this.zoom_origin[0])).attr("height",Math.abs(this.zoom_curr[1]-this.zoom_origin[1]))}};l.prototype.endRectSel=function(){if(!(0==this.zoom_kind||100<this.zoom_kind)){g.event.preventDefault();g.select(window).on("mousemove.zoomRect",
null).on("mouseup.zoomRect",null);var a=g.mouse(this.svg_frame().node()),b=[!0,!0];a[0]=Math.max(0,Math.min(this.frame_width(),a[0]));a[1]=Math.max(0,Math.min(this.frame_height(),a[1]));switch(this.zoom_kind){case 1:this.zoom_curr[0]=a[0];this.zoom_curr[1]=a[1];break;case 2:this.zoom_curr[0]=a[0];b[1]=!1;break;case 3:this.zoom_curr[1]=a[1],b[0]=!1}a=!1;var c=this.swap_xy?1:0,e=1-c;if(b[c]&&10<Math.abs(this.zoom_curr[c]-this.zoom_origin[c])){var d=Math.min(this.RevertX(this.zoom_origin[c]),this.RevertX(this.zoom_curr[c]));
var h=Math.max(this.RevertX(this.zoom_origin[c]),this.RevertX(this.zoom_curr[c]));a=!0}if(b[e]&&10<Math.abs(this.zoom_curr[e]-this.zoom_origin[e])){var m=Math.min(this.RevertY(this.zoom_origin[e]),this.RevertY(this.zoom_curr[e]));var k=Math.max(this.RevertY(this.zoom_origin[e]),this.RevertY(this.zoom_curr[e]));a=!0}b=this.zoom_kind;c=1===b?{x:this.zoom_origin[0],y:this.zoom_origin[1]}:null;this.clearInteractiveElements();if(a)this.zoom_changed_interactive=2,this.Zoom(d,h,m,k);else switch(b){case 1:this.ProcessFrameClick(c);
break;case 2:(d=this.pad_painter())&&d.SelectObjectPainter(this.x_handle);break;case 3:(d=this.pad_painter())&&d.SelectObjectPainter(this.y_handle)}this.zoom_kind=0}};l.prototype.startTouchZoom=function(){if(0!=this.zoom_kind)g.event.preventDefault(),g.event.stopPropagation();else{var a=g.touches(this.svg_frame().node());this.touch_cnt+=1;if(1==a.length){var b=new Date,c=b.getTime()-this.last_touch.getTime();this.last_touch=b;300>c&&this.zoom_curr&&30>Math.abs(this.zoom_curr[0]-a[0][0])&&30>Math.abs(this.zoom_curr[1]-
a[0][1])?(g.event.preventDefault(),g.event.stopPropagation(),this.clearInteractiveElements(),this.Unzoom("xyz"),this.last_touch=new Date(0),this.svg_frame().on("touchcancel",null).on("touchend",null,!0)):d.gStyle.ContextMenu&&(this.zoom_curr=a[0],this.svg_frame().on("touchcancel",this.endTouchSel.bind(this)).on("touchend",this.endTouchSel.bind(this)),g.event.preventDefault(),g.event.stopPropagation())}if(2==a.length&&d.gStyle.Zooming&&d.gStyle.ZoomTouch){g.event.preventDefault();g.event.stopPropagation();
this.clearInteractiveElements();this.svg_frame().on("touchcancel",null).on("touchend",null);b=a[0];a=a[1];c=this.frame_width();var e=this.frame_height();this.zoom_curr=[Math.min(b[0],a[0]),Math.min(b[1],a[1])];this.zoom_origin=[Math.max(b[0],a[0]),Math.max(b[1],a[1])];0>this.zoom_curr[0]||this.zoom_curr[0]>c?(this.zoom_kind=103,this.zoom_curr[0]=0,this.zoom_origin[0]=c):this.zoom_origin[1]>e||0>this.zoom_origin[1]?(this.zoom_kind=102,this.zoom_curr[1]=0,this.zoom_origin[1]=e):this.zoom_kind=101;this.SwitchTooltip(!1);
this.zoom_rect=this.svg_frame().append("rect").attr("class","zoom").attr("id","zoomRect").attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]);g.select(window).on("touchmove.zoomRect",this.moveTouchSel.bind(this)).on("touchcancel.zoomRect",this.endTouchSel.bind(this)).on("touchend.zoomRect",this.endTouchSel.bind(this))}}};l.prototype.moveTouchSel=function(){if(!(100>this.zoom_kind)){g.event.preventDefault();
var a=g.touches(this.svg_frame().node());if(2!=a.length)return this.clearInteractiveElements();var b=a[0];a=a[1];103!=this.zoom_kind&&(this.zoom_curr[0]=Math.min(b[0],a[0]),this.zoom_origin[0]=Math.max(b[0],a[0]));102!=this.zoom_kind&&(this.zoom_curr[1]=Math.min(b[1],a[1]),this.zoom_origin[1]=Math.max(b[1],a[1]));this.zoom_rect.attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]);(10<this.zoom_origin[0]-
this.zoom_curr[0]||10<this.zoom_origin[1]-this.zoom_curr[1])&&this.SwitchTooltip(!1);g.event.stopPropagation()}};l.prototype.endTouchSel=function(){this.svg_frame().on("touchcancel",null).on("touchend",null);if(0===this.zoom_kind){g.event.preventDefault();var a=(new Date).getTime()-this.last_touch.getTime();500<a&&2E3>a&&!this.IsTooltipShown()?(this.ShowContextMenu("main",{clientX:this.zoom_curr[0],clientY:this.zoom_curr[1]}),this.last_touch=new Date(0)):this.clearInteractiveElements()}if(!(100>this.zoom_kind)){g.event.preventDefault();
g.select(window).on("touchmove.zoomRect",null).on("touchend.zoomRect",null).on("touchcancel.zoomRect",null);a=!1;var b=this.swap_xy?1:0,c=1-b,e=[!0,!0];102===this.zoom_kind&&(e[1]=!1);103===this.zoom_kind&&(e[0]=!1);if(e[b]&&10<Math.abs(this.zoom_curr[b]-this.zoom_origin[b])){var d=Math.min(this.RevertX(this.zoom_origin[b]),this.RevertX(this.zoom_curr[b]));var h=Math.max(this.RevertX(this.zoom_origin[b]),this.RevertX(this.zoom_curr[b]));a=!0}if(e[c]&&10<Math.abs(this.zoom_curr[c]-this.zoom_origin[c])){var m=
Math.min(this.RevertY(this.zoom_origin[c]),this.RevertY(this.zoom_curr[c]));var k=Math.max(this.RevertY(this.zoom_origin[c]),this.RevertY(this.zoom_curr[c]));a=!0}this.clearInteractiveElements();this.last_touch=new Date(0);a&&(this.zoom_changed_interactive=2,this.Zoom(d,h,m,k));g.event.stopPropagation()}};l.prototype.ShowContextMenu=function(a,b,c){if(!("zoom_kind"in this&&100<this.zoom_kind)){var e=this,f=!1,h=this;if(!b&&(g.event.preventDefault(),g.event.stopPropagation(),b=g.event,void 0===a)){var m=
g.mouse(this.svg_frame().node()),k=g.touches(this.svg_frame().node()),p=this.pad_painter(),l=null,q=null;1===k.length?l={x:k[0][0],y:k[0][1],touch:!0}:2===m.length&&(l={x:m[0],y:m[1],touch:!1});if(null!==l&&null!==p)for(l.painters=!0,m=p.GetTooltips(l),k=1E3,p=0;p<m.length;++p)if(m[p]&&m[p].menu){var n="menu_dist"in m[p]?m[p].menu_dist:7;n<k&&(q=m[p].painter,k=n)}null!==q&&(e=q);null!==l&&(f=0<l.x&&20>l.x&&0<l.y&&20>l.y);this.SetLastEventPos(l)}d.Painter.createMenu(e,function(b){var e=b.painter.FillContextMenu(b,
a,c);h&&(!e||f&&"frame"!==a&&h!=b.painter)&&(e=h.FillContextMenu(b));e&&b.painter.FillObjectExecMenu(b,a,function(){0==b.size()&&"function"==typeof b.painter.FillObjectOfflineMenu&&b.painter.FillObjectOfflineMenu(b,a);b.painter.SwitchTooltip(!1);b.show(null,b.painter.SwitchTooltip.bind(b.painter,!0))})},b)}};l.prototype.FillObjectOfflineMenu=function(a,b){if("x"==b||"y"==b)a.add("Unzoom",this.Unzoom.bind(this,b)),"normal"==this[b+"_kind"]&&a.addchk(this["log"+b],"SetLog"+b,this.ToggleLog.bind(this,
b))};l.prototype.FillContextMenu=function(a,b,c){this.clearInteractiveElements();if("x"==b||"y"==b)return a.add("header: "+b.toUpperCase()+" axis"),!0;(b=0==a.size())?a.add("header:Frame"):a.add("separator");this.zoom_xmin!==this.zoom_xmax&&a.add("Unzoom X",this.Unzoom.bind(this,"x"));this.zoom_ymin!==this.zoom_ymax&&a.add("Unzoom Y",this.Unzoom.bind(this,"y"));this.zoom_zmin!==this.zoom_zmax&&a.add("Unzoom Z",this.Unzoom.bind(this,"z"));a.add("Unzoom all",this.Unzoom.bind(this,"xyz"));a.addchk(this.logx,
"SetLogx",this.ToggleLog.bind(this,"x"));a.addchk(this.logy,"SetLogy",this.ToggleLog.bind(this,"y"));a.add("separator");a.addchk(this.IsTooltipAllowed(),"Show tooltips",function(){this.SetTooltipAllowed("toggle")});this.FillAttContextMenu(a,b?"":"Frame ");a.add("separator");a.add("Save as frame.png",function(){this.pad_painter().SaveAs("png","frame","frame.png")});a.add("Save as frame.svg",function(){this.pad_painter().SaveAs("svg","frame","frame.svg")});return!0};l.prototype.ShowAxisStatus=function(a){var b=
this.GetShowStatusFunc();if("function"==typeof b){var c=g.mouse(this.svg_frame().node()),e="x"==a?0:1;this.swap_xy&&(e=1-e);e="x"==a?this.RevertX(c[e]):this.RevertY(c[e]);b(a,"TAxis",a+" : "+this.AxisAsText(a,e),c[0]+","+c[1])}};l.prototype.AddInteractive=function(){if(!d.BatchMode&&(d.gStyle.Zooming||d.gStyle.ContextMenu)){var a=this.pad_painter();if(!a||!a._fast_drawing)if(a=this.svg_frame(),!a.empty()){var b=a.selectAll(".xaxis_container"),c=a.selectAll(".yaxis_container");a.property("interactive_set")||
(this.AddKeysHandler(),this.last_touch=new Date(0),this.zoom_kind=0,this.zoom_curr=this.zoom_origin=this.zoom_rect=null,this.touch_cnt=0);if(d.gStyle.Zooming&&(!this.options||!this.options.Proj)&&(d.gStyle.ZoomMouse&&(a.on("mousedown",this.startRectSel.bind(this)),a.on("dblclick",this.mouseDoubleClick.bind(this))),d.gStyle.ZoomWheel))a.on("wheel",this.mouseWheel.bind(this));if(d.touches&&(d.gStyle.Zooming&&d.gStyle.ZoomTouch||d.gStyle.ContextMenu))a.on("touchstart",this.startTouchZoom.bind(this));
d.gStyle.ContextMenu&&(d.touches&&(b.on("touchstart",this.startTouchMenu.bind(this,"x")),c.on("touchstart",this.startTouchMenu.bind(this,"y"))),a.on("contextmenu",this.ShowContextMenu.bind(this)),b.on("contextmenu",this.ShowContextMenu.bind(this,"x")),c.on("contextmenu",this.ShowContextMenu.bind(this,"y")));b.on("mousemove",this.ShowAxisStatus.bind(this,"x"));c.on("mousemove",this.ShowAxisStatus.bind(this,"y"));a.property("interactive_set",!0)}}};l.prototype.mouseWheel=function(){g.event.stopPropagation();
g.event.preventDefault();this.clearInteractiveElements();var a={name:"x",reverse:this.reverse_x,ignore:!1},b={name:"y",reverse:this.reverse_y,ignore:!this.AllowDefaultYZooming()},c=g.mouse(this.svg_frame().node()),e=this.frame_width(),d=this.frame_height();this.AnalyzeMouseWheelEvent(g.event,this.swap_xy?b:a,c[0]/e,0<=c[1]&&c[1]<=d);this.AnalyzeMouseWheelEvent(g.event,this.swap_xy?a:b,1-c[1]/d,0<=c[0]&&c[0]<=e);this.Zoom(a.min,a.max,b.min,b.max);if(a.changed||b.changed)this.zoom_changed_interactive=
2};l.prototype.AllowDefaultYZooming=function(){var a=this.pad_painter();if(a&&a.painters)for(var b=0;b<a.painters.length;++b){var c=a.painters[b];if(c&&void 0!==c.wheel_zoomy)return c.wheel_zoomy}return!1};l.prototype.AnalyzeMouseWheelEvent=function(a,b,c,e){b.min=b.max=void 0;b.changed=!1;if(!e||!b.ignore){var f=0,h=e=1;"dleft"in b&&(e=b.dleft,f=1);"dright"in b&&(h=b.dright,f=1);"delta"in b?f=b.delta:a&&void 0!==a.wheelDelta?f=-a.wheelDelta:a&&void 0!==a.deltaY?f=a.deltaY:a&&void 0!==a.detail&&(f=
a.detail);if(0!==f){f=0>f?-.2:.2;e*=f;h*=f;a=b.min=this["scale_"+b.name+"min"];var m=b.max=this["scale_"+b.name+"max"],k=this[b.name+"min"],g=this[b.name+"max"];b.min===b.max&&0>f&&(b.min=k,b.max=g);if(!(b.min>=b.max)){b.reverse&&(c=1-c);if(0<c&&1>c){if(this["log"+b.name])f=0<b.min?d.log10(b.max/b.min):2,10<f?f=10:.01>f&&(f=.01),b.min/=Math.pow(10,f*e*c),b.max*=Math.pow(10,f*h*(1-c));else{var l=f=b.max-b.min;0<e&&(f=1.001*f/(1-e));b.min+=-e*c*f;0<h&&(l=1.001*l/(1-h));b.max-=-h*(1-c)*l}b.min>=b.max?
b.min=b.max=void 0:e!==h&&(b.min<k&&a===k||b.max>g&&m==g)&&(b.min=b.max=void 0)}else b.min=b.max=void 0;b.changed=void 0!==b.min&&void 0!==b.max}}}};l.prototype.AddKeysHandler=function(){this.keys_handler||d.BatchMode||"undefined"==typeof window||(this.keys_handler=this.ProcessKeyPress.bind(this),window.addEventListener("keydown",this.keys_handler,!1))};l.prototype.ProcessKeyPress=function(a){var b=this.select_main();if(d.key_handling&&!b.empty()){switch(a.keyCode){case 33:b="PageUp";break;case 34:b=
"PageDown";break;case 37:b="ArrowLeft";break;case 38:b="ArrowUp";break;case 39:b="ArrowRight";break;case 40:b="ArrowDown";break;case 42:b="PrintScreen";break;case 106:b="*";break;default:return!1}a.shiftKey&&(b="Shift "+b);a.altKey&&(b="Alt "+b);a.ctrlKey&&(b="Ctrl "+b);var c={name:"x",dleft:0,dright:0};switch(b){case "ArrowLeft":c.dleft=-1;c.dright=1;break;case "ArrowRight":c.dleft=1;c.dright=-1;break;case "Ctrl ArrowLeft":c.dleft=c.dright=-1;break;case "Ctrl ArrowRight":c.dleft=c.dright=1;break;
case "ArrowUp":c.name="y";c.dleft=1;c.dright=-1;break;case "ArrowDown":c.name="y";c.dleft=-1;c.dright=1;break;case "Ctrl ArrowUp":c.name="y";c.dleft=c.dright=1;break;case "Ctrl ArrowDown":c.name="y",c.dleft=c.dright=-1}if(c.dleft||c.dright){if(!d.gStyle.Zooming||this.mode3d&&0!==b.indexOf("Ctrl"))return!1;this.AnalyzeMouseWheelEvent(null,c,.5);this.Zoom(c.name,c.min,c.max);c.changed&&(this.zoom_changed_interactive=2);a.stopPropagation();a.preventDefault()}else if(b=(c=this.pad_painter())?c.FindButton(b):
"")c.PadButtonClick(b),a.stopPropagation(),a.preventDefault();return!0}};l.prototype.CreateXY=function(){this.logx=this.logy=this.logz=this.reverse_y=this.reverse_x=this.swap_xy=!1;this.logx=!!this.v7EvalAttr("x_log");this.logy=!!this.v7EvalAttr("y_log");this.logz=!!this.v7EvalAttr("z_log");var a=this.frame_width(),b=this.frame_height();this.scale_xmin=this.xmin;this.scale_xmax=this.xmax;this.scale_ymin=this.ymin;this.scale_ymax=this.ymax;this._xaxis_timedisplay?(this.x_kind="time",this.timeoffsetx=
d.Painter.getTimeOffset(),this.ConvertX=function(a){return new Date(this.timeoffsetx+1E3*a)},this.RevertX=function(a){return(this.x.invert(a)-this.timeoffsetx)/1E3}):(this.x_kind="normal",this.ConvertX=function(a){return a},this.RevertX=function(a){return this.x.invert(a)});this.zoom_xmin!=this.zoom_xmax&&(this.scale_xmin=this.zoom_xmin,this.scale_xmax=this.zoom_xmax);if("time"==this.x_kind)this.x=g.scaleTime();else if(this.logx){0>=this.scale_xmax&&(this.scale_xmax=1);if(0>=this.scale_xmin||this.scale_xmin>=
this.scale_xmax)this.scale_xmin=1E-4*this.scale_xmax;this.x=g.scaleLog()}else this.x=g.scaleLinear();a=this.reverse_x?[a,0]:[0,a];b=this.reverse_y?[0,b]:[b,0];this.x.domain([this.ConvertX(this.scale_xmin),this.ConvertX(this.scale_xmax)]).range(this.swap_xy?b:a);this.grx="time"==this.x_kind?function(a){return this.x(this.ConvertX(a))}:this.logx?function(a){return a<this.scale_xmin?this.swap_xy?this.x.range()[0]+5:-5:this.x(a)}:this.x;this.zoom_ymin!=this.zoom_ymax&&(this.scale_ymin=this.zoom_ymin,
this.scale_ymax=this.zoom_ymax);this._yaxis_timedisplay?(this.y_kind="time",this.timeoffsety=d.Painter.getTimeOffset(),this.ConvertY=function(a){return new Date(this.timeoffsety+1E3*a)},this.RevertY=function(a){return(this.y.invert(a)-this.timeoffsety)/1E3}):(this.y_kind="normal",this.ConvertY=function(a){return a},this.RevertY=function(a){return this.y.invert(a)});if(this.logy){0>=this.scale_ymax&&(this.scale_ymax=1);if(0>=this.scale_ymin||this.scale_ymin>=this.scale_ymax)this.scale_ymin=3E-4*this.scale_ymax;
this.y=g.scaleLog()}else this.y="time"==this.y_kind?g.scaleTime():g.scaleLinear();this.y.domain([this.ConvertY(this.scale_ymin),this.ConvertY(this.scale_ymax)]).range(this.swap_xy?a:b);this.gry="time"==this.y_kind?function(a){return this.y(this.ConvertY(a))}:this.logy?function(a){return a<this.scale_ymin?this.swap_xy?-5:this.y.range()[0]+5:this.y(a)}:this.y};l.prototype.SetRootPadRange=function(a,b){};l.prototype.ToggleLog=function(a){var b=this["log"+a];if(!b){var c=this[a+"_kind"];this.swap_xy&&
"x"===a?c=this.y_kind:this.swap_xy&&"y"===a&&(c=this.x_kind);if("labels"===c)return}this.v7CommMode()==d.v7.CommMode.kOffline?(this.v7SetAttr(a+"_log",!b),this.RedrawPad()):this.WebCanvasExec("Attr"+a.toUpperCase()+"().SetLog"+(b?"(false)":"(true)"))};n.prototype=Object.create(d.TObjectPainter.prototype);n.prototype.Cleanup=function(){for(var a=0;a<this.painters.length;++a)this.painters[a].Cleanup();a=this.svg_pad(this.this_pad_name);a.empty()||(a.property("pad_painter",null),a.property("mainpainter",
null),this.iscan||a.remove());delete this.frame_painter_ref;delete this.pads_cache;this.painters=[];this.pad_frame=this.draw_object=this.pad=null;this.this_pad_name="";this.has_canvas=!1;d.Painter.SelectActivePad({pp:this,active:!1});d.TObjectPainter.prototype.Cleanup.call(this)};n.prototype.CleanPrimitives=function(a){if(a&&"function"===typeof a)for(var b=this.painters.length-1;0<=b;--b)a(this.painters[b])&&(this.painters[b].Cleanup(),this.painters.splice(b,1))};n.prototype.ForEachPainterInPad=function(a,
b){b||(b="all");"objects"!=b&&a(this);for(var c=0;c<this.painters.length;++c){var e=this.painters[c];"function"===typeof e.ForEachPainterInPad?"objects"!=b&&e.ForEachPainterInPad(a,b):"pads"!=b&&a(e)}};n.prototype.ButtonSize=function(a){return Math.round((a?a:1)*(this.iscan||!this.has_canvas?16:12))};n.prototype.RegisterForPadEvents=function(a){this.pad_events_receiver=a};n.prototype.SelectObjectPainter=function(a,b){var c=this.iscan||!this.has_canvas,e=c?this:this.canv_painter(),f=a instanceof n?
a:a.pad_painter();b&&!c&&this.CalcAbsolutePosition(this.svg_pad(this.this_pad_name),b);d.Painter.SelectActivePad({pp:f,active:!0});"function"==typeof e.SelectActivePad&&e.SelectActivePad(f,a,b);e.pad_events_receiver&&e.pad_events_receiver({what:"select",padpainter:f,painter:a,position:b})};n.prototype.SetActive=function(a){var b=this.frame_painter();b&&"function"==typeof b.SetActive&&b.SetActive(a)};n.prototype.CreateCanvasSvg=function(a,b){if(0<a){if(this._fixed_size)return 1<a;var c=this.svg_canvas();
if(c.empty())return!1;var e=c.property("height_factor");b=this.check_main_resize(a,null,e);if(!b.changed)return!1;a=this.svg_layer("btns_layer")}else{var f=this.select_main();"static"==f.style("position")&&f.style("position","relative");c=f.append("svg").attr("class","jsroot root_canvas").property("pad_painter",this).property("mainpainter",null).property("current_pad","").property("redraw_by_resize",!1);c.append("svg:title").text("ROOT canvas");e=c.append("svg:rect").attr("class","canvas_fillrect").attr("x",
0).attr("y",0);if(!d.BatchMode)e.style("pointer-events","visibleFill").on("dblclick",this.EnlargePad.bind(this)).on("click",this.SelectObjectPainter.bind(this,this)).on("mouseenter",this.ShowObjectStatus.bind(this));c.append("svg:g").attr("class","primitives_layer");c.append("svg:g").attr("class","info_layer");a=c.append("svg:g").attr("class","btns_layer").property("leftside","left"==d.gStyle.ToolBarSide).property("vertical",d.gStyle.ToolBarVert);if(d.gStyle.ContextMenu&&!d.BatchMode)c.select(".canvas_fillrect").on("contextmenu",
this.ShowContextMenu.bind(this));e=.66;this.pad&&this.pad.fWinSize[0]&&this.pad.fWinSize[1]&&(e=this.pad.fWinSize[1]/this.pad.fWinSize[0],.1>e||10<e)&&(e=.66);this._fixed_size?(f.style("overflow","auto"),b={width:this.pad.fWinSize[0],height:this.pad.fWinSize[1]}):b=this.check_main_resize(2,b,e)}this.createAttFill({pattern:1001,color:0});5>=b.width||5>=b.height?(c.style("display","none"),console.warn("Hide canvas while geometry too small w=",b.width," h=",b.height),b.width=200,b.height=100):c.style("display",
null);this._fixed_size?c.attr("x",0).attr("y",0).attr("width",b.width).attr("height",b.height).style("position","absolute"):c.attr("x",0).attr("y",0).style("width","100%").style("height","100%").style("position","absolute").style("left",0).style("top",0).style("right",0).style("bottom",0);c.attr("viewBox","0 0 "+b.width+" "+b.height).attr("preserveAspectRatio","none").property("height_factor",e).property("draw_x",0).property("draw_y",0).property("draw_width",b.width).property("draw_height",b.height);
c.select(".canvas_fillrect").attr("width",b.width).attr("height",b.height).call(this.fillatt.func);this._fast_drawing=d.gStyle.SmallPad&&(b.width<d.gStyle.SmallPad.width||b.height<d.gStyle.SmallPad.height);this.AlignBtns(a,b.width,b.height,c);return!0};n.prototype.EnlargePad=function(){g.event&&(g.event.preventDefault(),g.event.stopPropagation());var a=this.svg_canvas(),b=a.property("pad_enlarged");if(!this.iscan&&this.has_canvas&&(b||this.HasObjectsToDraw()||this.painters))b?b===this.pad?(this.enlarge_main(!1),
a.property("pad_enlarged",null)):console.error("missmatch with pad double click events"):(this.enlarge_main(!0,!0),a.property("pad_enlarged",this.pad));else{if(this._fixed_size||!this.enlarge_main("toggle"))return;"off"==this.enlarge_main("state")&&a.property("pad_enlarged",null)}a=this._fast_drawing;this.CheckResize({force:!0});this._fast_drawing!=a&&this.ShowButtons()};n.prototype.CreatePadSvg=function(a){if(!this.has_canvas)return this.CreateCanvasSvg(a?2:0),!0;var b=this.svg_pad(),c=this.svg_canvas(),
e=b.property("draw_width"),f=b.property("draw_height"),h=c.property("pad_enlarged");c=!h||h===this.pad;var m=e,k=f,g=0,l=0;this.pad&&this.pad.fPos&&this.pad.fSize&&(g=Math.round(e*this.pad.fPos.fHoriz.fArr[0]),l=Math.round(f*this.pad.fPos.fVert.fArr[0]),m=Math.round(e*this.pad.fSize.fHoriz.fArr[0]),k=Math.round(f*this.pad.fSize.fVert.fArr[0]));h===this.pad&&(m=e,k=f,g=l=0);if(a)a=this.svg_pad(this.this_pad_name),b=a.select(".root_pad_border"),e=this.svg_layer("btns_layer",this.this_pad_name);else{a=
b.select(".primitives_layer").append("svg:svg").classed("__root_pad_"+this.this_pad_name,!0).attr("pad",this.this_pad_name).property("pad_painter",this).property("mainpainter",null);b=a.append("svg:rect").attr("class","root_pad_border");a.append("svg:g").attr("class","primitives_layer");e=a.append("svg:g").attr("class","btns_layer").property("leftside","left"!=d.gStyle.ToolBarSide).property("vertical",d.gStyle.ToolBarVert);if(d.gStyle.ContextMenu)b.on("contextmenu",this.ShowContextMenu.bind(this));
if(!d.BatchMode)b.attr("pointer-events","visibleFill").on("dblclick",this.EnlargePad.bind(this)).on("click",this.SelectObjectPainter.bind(this,this)).on("mouseenter",this.ShowObjectStatus.bind(this))}this.createAttFill({attr:this.pad});this.createAttLine({attr:this.pad,color0:0==this.pad.fBorderMode?"none":""});a.attr("display",c?null:"none").attr("viewBox","0 0 "+m+" "+k).attr("preserveAspectRatio","none").attr("x",g).attr("y",l).attr("width",m).attr("height",k).property("draw_x",g).property("draw_y",
l).property("draw_width",m).property("draw_height",k);b.attr("x",0).attr("y",0).attr("width",m).attr("height",k).call(this.fillatt.func).call(this.lineatt.func);this._fast_drawing=d.gStyle.SmallPad&&(m<d.gStyle.SmallPad.width||k<d.gStyle.SmallPad.height);1===a.property("can3d")&&this.select_main().select(".draw3d_"+this.this_pad_name).style("display",c?"":"none");this.AlignBtns(e,m,k);return c};n.prototype.RemovePrimitive=function(a){this.pad&&this.pad.fPrimitives&&(a=this.pad.fPrimitives.arr.indexOf(a),
0<=a&&this.pad.fPrimitives.RemoveAt(a))};n.prototype.FindPrimitive=function(a,b,c){if(!this.pad||!this.pad.fPrimitives)return null;for(var e=0;e<this.pad.fPrimitives.arr.length;e++){var d=this.pad.fPrimitives.arr[e];if(null===a||d===a)if(void 0===b||null===b||d._typename===b)if(void 0===c||null===c||d.fName===c)return d}return null};n.prototype.HasObjectsToDraw=function(){var a=this.pad?this.pad.fPrimitives:null;if(a)for(var b=0;b<a.length;++b)if(a[b]&&"ROOT::Experimental::RPadDisplayItem"!=a[b]._typename)return!0;
return!1};n.prototype.DrawPrimitives=function(a,b,c){0===a&&(this._doing_pad_draw=!0,this.iscan&&(this._start_tm=this._lasttm_tm=(new Date).getTime()),this._num_primitives=this.pad&&this.pad.fPrimitives?this.pad.fPrimitives.length:0);for(;;){c&&"object"==typeof c&&(c._primitive=!0);if(!this.pad||a>=this.pad.fPrimitives.length)return delete this._doing_pad_draw,delete this._current_primitive_indx,this._start_tm&&(a=(new Date).getTime()-this._start_tm,3E3<a&&console.log("Canvas drawing took "+(.001*
a).toFixed(2)+"s"),delete this._start_tm,delete this._lasttm_tm),d.CallBack(b);var e={func:this.DrawPrimitives.bind(this,a+1,b)};this._current_primitive_indx=a;c=d.draw(this.divid,this.pad.fPrimitives[a],"",e);a++;if(!e.completed)break;if(!d.BatchMode&&this.iscan){var f=(new Date).getTime();if(f>this._lasttm_tm+500)return this._lasttm_tm=f,c._primitive=!0,requestAnimationFrame(e.func)}}};n.prototype.GetTooltips=function(a){var b=[],c=[];null!==this.painters&&this.painters.forEach(function(a){"ProcessTooltip"in
a&&b.push(a)});a&&(a.nproc=b.length);b.forEach(function(b){var e=b.ProcessTooltip(a);e||(e={user_info:null});c.push(e);e&&a&&a.painters&&(e.painter=b)});return c};n.prototype.FillContextMenu=function(a){this.pad?a.add("header: "+this.pad._typename+"::"+this.pad.fName):a.add("header: Canvas");a.addchk(this.IsTooltipAllowed(),"Show tooltips",this.SetTooltipAllowed.bind(this,"toggle"));if(!this._websocket){var b=function(a){this.pad[a.substr(1)]=parseInt(a[0]);(a=this.svg_pad(this.this_pad_name).property("mainpainter"))&&
"function"==typeof a.DrawAxes&&a.DrawAxes()},c=function(a){this.pad[a]=this.pad[a]?0:1;(a=this.svg_pad(this.this_pad_name).property("mainpainter"))&&"function"==typeof a.DrawGrids&&a.DrawGrids()};a.addchk(this.pad.fGridx,"Grid x","fGridx",c);a.addchk(this.pad.fGridy,"Grid y","fGridy",c);a.add("sub:Ticks x");a.addchk(0==this.pad.fTickx,"normal","0fTickx",b);a.addchk(1==this.pad.fTickx,"ticks on both sides","1fTickx",b);a.addchk(2==this.pad.fTickx,"labels up","2fTickx",b);a.add("endsub:");a.add("sub:Ticks y");
a.addchk(0==this.pad.fTicky,"normal","0fTicky",b);a.addchk(1==this.pad.fTicky,"ticks on both side","1fTicky",b);a.addchk(2==this.pad.fTicky,"labels right","2fTicky",b);a.add("endsub:");this.FillAttContextMenu(a)}a.add("separator");this.ToggleEventStatus&&a.addchk(this.HasEventStatus(),"Event status",this.ToggleEventStatus.bind(this));(this.enlarge_main()||this.has_canvas&&this.HasObjectsToDraw())&&a.addchk("on"==this.enlarge_main("state"),"Enlarge "+(this.iscan?"canvas":"pad"),this.EnlargePad.bind(this));
b=this.this_pad_name;0===b.length&&(b=this.iscan?"canvas":"pad");a.add("Save as "+b+".png",b+".png",this.SaveAs.bind(this,"png",!1));a.add("Save as "+b+".svg",b+".svg",this.SaveAs.bind(this,"svg",!1));return!0};n.prototype.ShowContextMenu=function(a){if(!a){if((a=g.mouse(this.svg_pad(this.this_pad_name).node()))&&2==a.length&&0<a[0]&&10>a[0]&&0<a[1]&&10>a[1])return;g.event.stopPropagation();g.event.preventDefault();a=g.event;var b=this.frame_painter();b&&b.SetLastEventPos()}d.Painter.createMenu(this,
function(a){a.painter.FillContextMenu(a);a.painter.FillObjectExecMenu(a,"",function(){a.show()})},a)};n.prototype.Redraw=function(a){if(this._doing_pad_draw)return console.log("Prevent pad redrawing");var b=!0;this.iscan?this.CreateCanvasSvg(2):b=this.CreatePadSvg(!0);for(var c=0;c<this.painters.length;++c){var e=this.painters[c];(b||e.this_pad_name)&&e.Redraw(a)}};n.prototype.NumDrawnSubpads=function(){if(void 0===this.painters)return 0;for(var a=0,b=0;b<this.painters.length;++b){var c=this.painters[b].GetObject();
c&&"TPad"===c._typename&&a++}return a};n.prototype.RedrawByResize=function(){if(1===this.access_3d_kind())return!0;for(var a=0;a<this.painters.length;++a)if("function"===typeof this.painters[a].RedrawByResize&&this.painters[a].RedrawByResize())return!0;return!1};n.prototype.CheckCanvasResize=function(a,b){if(!this.iscan&&this.has_canvas)return!1;if(!0===a||!1===a)b=a,a=null;a&&"object"===typeof a&&a.force&&(b=!0);b||(b=this.RedrawByResize());if(a=this.CreateCanvasSvg(b?2:1,a))for(var c=0;c<this.painters.length;++c)this.painters[c].Redraw(b?
"redraw":"resize");return a};n.prototype.UpdateObject=function(a){if(!a)return!1;this.pad.fStyle=a.fStyle;this.pad.fAttr=a.fAttr;this.iscan?(this.pad.fTitle=a.fTitle,this.pad.fWinSize=a.fWinSize):(this.pad.fPos=a.fPos,this.pad.fSize=a.fSize);return!0};n.prototype.DrawNextSnap=function(a,b,c,e){-1===b&&(this._doing_pad_draw=!0,this._snaps_map={},this._num_primitives=a?a.length:0);"workaround"===e&&(--b,e=null);for(;;){e&&a&&a[b]&&void 0===e.snapid&&(0>this.painters.indexOf(e)&&this.painters.push(e),
e.AssignSnapId(a[b].fObjectID),e.rstyle||(e.rstyle=a[b].fStyle||this.rstyle));delete this.next_rstyle;e=null;++b;if(!a||b>=a.length)return delete this._doing_pad_draw,delete this._snaps_map,delete this._current_primitive_indx,d.CallBack(c,this);var f=a[b],h=f.fObjectID,m=this._snaps_map[h];m?m++:m=1;this._snaps_map[h]=m;this._current_primitive_indx=b;if(!f.fDummy){for(var k=0;k<this.painters.length;++k)if(this.painters[k].snapid===h&&0===--m){e=this.painters[k];break}var g=this.DrawNextSnap.bind(this,
a,b,c);if(e){if("ROOT::Experimental::RPadDisplayItem"==f._typename)return e.RedrawPadSnap(f,g);e.UpdateObject(f.fDrawable||f.fObject||f,f.fOption||"")&&e.Redraw()}else{if("ROOT::Experimental::RPadDisplayItem"==f._typename){var l=new n(f,!1);l.DecodeOptions("");l.SetDivId(this.divid);l.AssignSnapId(f.fObjectID);l.rstyle=f.fStyle;l.CreatePadSvg();f.fPrimitives&&0<f.fPrimitives.length&&(l.AddButton(d.ToolbarIcons.camera,"Create PNG","PadSnapShot"),l.AddButton(d.ToolbarIcons.circle,"Enlarge pad","EnlargePad"),
d.gStyle.ContextMenu&&l.AddButton(d.ToolbarIcons.question,"Access context menus","PadContextMenus"));var q=l.CurrentPadName(l.this_pad_name);l.DrawNextSnap(f.fPrimitives,-1,function(){l.CurrentPadName(q);g(l)});break}this.next_rstyle=a[b].fStyle||this.rstyle;var u={func:g};if("ROOT::Experimental::RObjectDisplayItem"===f._typename&&!this.frame_painter())return d.draw(this.divid,{_typename:"TFrame",$dummy:!0},"",function(){u.func("workaround")});e=d.draw(this.divid,f.fDrawable||f.fObject||f,f.fOption||
"",u);if(!u.completed)break}}}};n.prototype.FindSnap=function(a,b){function c(c){return c&&"string"==typeof c?c==a?!0:b&&c.length>a.length&&c.indexOf(a)==c.length-a.length:!1}if(c(this.snapid))return this;if(!this.painters)return null;for(var e=0;e<this.painters.length;++e){var d=this.painters[e];b||"function"!==typeof d.FindSnap?c(d.snapid)||(d=null):d=d.FindSnap(a);if(d)return d}return null};n.prototype.AddOnlineButtons=function(){this.AddButton(d.ToolbarIcons.camera,"Create PNG","CanvasSnapShot",
"Ctrl PrintScreen");d.gStyle.ContextMenu&&this.AddButton(d.ToolbarIcons.question,"Access context menus","PadContextMenus");this.enlarge_main("verify")&&this.AddButton(d.ToolbarIcons.circle,"Enlarge canvas","EnlargePad")};n.prototype.RedrawPadSnap=function(a,b){if(a&&a.fPrimitives)if(this.iscan&&a.fTitle&&document&&(document.title=a.fTitle),this.iscan&&a.fTitle&&document&&(document.title=a.fTitle),void 0===this.snapid)this.AssignSnapId(a.fObjectID),this.pad=this.draw_object=a,this.batch_mode&&this.iscan&&
(this._fixed_size=!0),this.CreateCanvasSvg(0),this.SetDivId(this.divid),this.AddOnlineButtons(),this.DrawNextSnap(a.fPrimitives,-1,b);else{this.UpdateObject(a);this.iscan?this.CreateCanvasSvg(2):this.CreatePadSvg(!0);for(var c=!1,e=!1,d=0;d<this.painters.length;++d){var h=this.painters[d];if(void 0!==h.snapid){for(var m=0;m<a.fPrimitives.length;++m)if(a.fPrimitives[m].fObjectID===h.snapid){h=null;c=!0;break}h&&(this.painters.splice(d--,1),h.Cleanup(),e=!0)}}e&&delete this.pads_cache;if(!c){d=this.svg_pad(this.this_pad_name);
c=this.frame_painter();d&&!d.empty()&&d.property("mainpainter",null);for(d=0;d<this.painters.length;++d)c!==this.painters[d]&&this.painters[d].Cleanup();this.painters=[];c&&(this.painters.push(c),c.CleanFrameDrawings());this.RemoveButtons();this.AddOnlineButtons()}var k=this,g=k.CurrentPadName(k.this_pad_name);k.DrawNextSnap(a.fPrimitives,-1,function(){k.CurrentPadName(g);b(k)})}};n.prototype.CreateImage=function(a,b){"pdf"==a?d.CallBack(b,btoa("dummy PDF file")):"png"==a||"jpeg"==a||"svg"==a?this.ProduceImage(!0,
a,function(c){if("svg"==a||!c)return d.CallBack(b,c);var e=c.indexOf("base64,");d.CallBack(b,0<e?c.substr(e+7):"")}):d.CallBack(b,"")};n.prototype.ItemContextMenu=function(a){var b=this.svg_pad(this.this_pad_name).node().getBoundingClientRect();b={clientX:b.left+10,clientY:b.top+10};if("pad"==a)return setTimeout(this.ShowContextMenu.bind(this,b),50);var c=null;switch(a){case "xaxis":case "yaxis":case "zaxis":c=this.main_painter();var e=a[0];break;case "frame":c=this.frame_painter();break;default:a=
parseInt(a),isNaN(a)||(c=this.painters[a])}c&&"function"===typeof c.FillContextMenu&&d.Painter.createMenu(c,function(a){c.FillContextMenu(a,e)&&setTimeout(a.show.bind(a),50)},b)};n.prototype.SaveAs=function(a,b,c){c||(c=this.this_pad_name,0===c.length&&(c=this.iscan?"canvas":"pad"),c+="."+a);this.ProduceImage(b,a,function(b){var d=document.createElement("a");d.download=c;d.href="svg"!=a?b:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(b);document.body.appendChild(d);d.addEventListener("click",
function(a){d.parentNode.removeChild(d)});d.click()})};n.prototype.ProduceImage=function(a,b,c){function e(a){for(var b=0;b<m.length;++b){var e=m[b];e.img&&e.img.remove();var f=e.prnt.select(".primitives_layer");e.foreign&&e.prnt.node().insertBefore(e.foreign.node(),f.node());e.frame_node&&f.node().insertBefore(e.frame_node,e.frame_next);e.btns_node&&e.btns_prnt.insertBefore(e.btns_node,e.btns_next)}d.CallBack(c,a)}var f="frame"===a,h=f?this.svg_frame():a?this.svg_canvas():this.svg_pad(this.this_pad_name);
if(h.empty())return d.CallBack(c);a=a&&!f?this.canv_painter():this;var m=[];f||a.ForEachPainterInPad(function(a){var b={prnt:a.svg_pad(a.this_pad_name)};m.push(b);var c=a.svg_layer("btns_layer",a.this_pad_name);b.btns_node=c.node();b.btns_node&&(b.btns_prnt=b.btns_node.parentNode,b.btns_next=b.btns_node.nextSibling,c.remove());var d=a.frame_painter_ref;if(d&&"function"===typeof d.Render3D){var e=d.access_3d_kind();if(1===e||2===e){a=d.size_for_3d(2);2==e||d.size_for_3d(1);c=d.renderer.domElement;
d.Render3D(0);var f=c.toDataURL("image/png");2==e&&(b.foreign=b.prnt.select("."+a.clname),b.foreign.remove());d=d.svg_frame();b.frame_node=d.node();b.frame_node&&(b.frame_next=b.frame_node.nextSibling,d.remove());b.img=b.prnt.insert("image",".primitives_layer").attr("x",a.x).attr("y",a.y).attr("width",c.width).attr("height",c.height).attr("href",f)}}},"pads");a=h.property("draw_width");var k=h.property("draw_height");f&&(a=this.frame_width(),k=this.frame_height());f='<svg width="'+a+'" height="'+
k+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+h.node().innerHTML+"</svg>";if("svg"==b)return e(f);var g=new Image;g.onload=function(){var a=document.createElement("canvas");a.width=g.width;a.height=g.height;a.getContext("2d").drawImage(g,0,0);e(a.toDataURL("image/"+b))};g.onerror=function(a){console.log("IMAGE ERROR",a);e(null)};g.src="data:image/svg+xml;base64,"+window.btoa(function(a){a=encodeURIComponent(a);a=a.replace(/%([0-9A-F]{2})/g,function(a,b){a=String.fromCharCode("0x"+
b);return"%"===a?"%25":a});return decodeURIComponent(a)}('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+f))};n.prototype.PadButtonClick=function(a){if("CanvasSnapShot"==a)return this.SaveAs("png",!0);if("EnlargePad"==a)return this.EnlargePad();if("PadSnapShot"==a)return this.SaveAs("png",!1);if("PadContextMenus"==a){if(g.event.preventDefault(),g.event.stopPropagation(),!d.Painter.closeMenu()){var b=this;d.Painter.createMenu(this,
function(a){a.add("header:Menus");b.iscan?a.add("Canvas","pad",b.ItemContextMenu):a.add("Pad","pad",b.ItemContextMenu);b.frame_painter()&&a.add("Frame","frame",b.ItemContextMenu);var c=b.main_painter();c&&(a.add("X axis","xaxis",b.ItemContextMenu),a.add("Y axis","yaxis",b.ItemContextMenu),"function"===typeof c.Dimension&&1<c.Dimension()&&a.add("Z axis","zaxis",b.ItemContextMenu));if(b.painters&&0<b.painters.length){a.add("separator");c=[];for(var d=0;d<b.painters.length;++d){var e=b.painters[d];if((e=
e?e.GetObject():null)&&!(0<=c.indexOf(e))){var f="_typename"in e?e._typename+"::":"";"fName"in e&&(f+=e.fName);0==f.length&&(f="item"+d);a.add(f,d,b.ItemContextMenu)}}}a.show()},g.event)}}else for(var c=!1,e=0;e<this.painters.length;++e){var f=this.painters[e];"function"==typeof f.PadButtonClick&&f.PadButtonClick(a);c||"function"!=typeof f.ButtonClick||(c=f.ButtonClick(a))}};n.prototype.FindButton=function(a){var b=this.svg_layer("btns_layer",this.this_pad_name),c="";b.empty()||b.selectAll("svg").each(function(){g.select(this).attr("key")===
a&&(c=g.select(this).attr("name"))});return c};n.prototype.toggleButtonsVisibility=function(a){var b=this.svg_layer("btns_layer",this.this_pad_name),c=b.select("[name='Toggle']");if(!c.empty()){var d=c.property("buttons_state");c.property("timout_handler")&&("timeout"!==a&&clearTimeout(c.property("timout_handler")),c.property("timout_handler",null));var f=!1;switch(a){case "enable":f=!0;break;case "enterbtn":return;case "timeout":f=!1;break;case "toggle":d=!d;c.property("buttons_state",d);f=d;break;
case "disable":case "leavebtn":d||c.property("timout_handler",setTimeout(this.toggleButtonsVisibility.bind(this,"timeout"),500));return}b.selectAll("svg").each(function(){this!==c.node()&&g.select(this).style("display",f?"":"none")})}};n.prototype.RemoveButtons=function(){var a=this.svg_layer("btns_layer",this.this_pad_name);a.empty()||(a.selectAll("*").remove(),a.property("nextx",null))};n.prototype.AddButton=function(a,b,c,e){if(d.gStyle.ToolBar&&!d.BatchMode){this._buttons||(this._buttons=[]);
for(var f=0;f<this._buttons.length;++f)if(this._buttons[f].funcname==c)return;this._buttons.push({btn:a,tooltip:b,funcname:c,keyname:e});!this.iscan&&this.has_canvas&&0!=c.indexOf("Pad")&&"EnlargePad"!==c&&(e=this.canv_painter())&&e!==this&&e.AddButton(a,b,c)}};n.prototype.ShowButtons=function(){if(this._buttons){var a=this.svg_layer("btns_layer",this.this_pad_name);if(!a.empty()){a.selectAll("*").remove();var b=this.iscan||!this.has_canvas,c=a.property("leftside")?this.ButtonSize(1.25):0;if(this._fast_drawing){var e=
d.ToolbarIcons.CreateSVG(a,d.ToolbarIcons.circle,this.ButtonSize(),"EnlargePad");e.attr("name","Enlarge").attr("x",0).attr("y",0).on("click",this.PadButtonClick.bind(this,"EnlargePad"))}else{e=d.ToolbarIcons.CreateSVG(a,d.ToolbarIcons.rect,this.ButtonSize(),"Toggle tool buttons");e.attr("name","Toggle").attr("x",0).attr("y",0).property("buttons_state","popup"!==d.gStyle.ToolBar).on("click",this.toggleButtonsVisibility.bind(this,"toggle")).on("mouseenter",this.toggleButtonsVisibility.bind(this,"enable")).on("mouseleave",
this.toggleButtonsVisibility.bind(this,"disable"));for(var f=0;f<this._buttons.length;++f){var h=this._buttons[f],g=d.ToolbarIcons.CreateSVG(a,h.btn,this.ButtonSize(),h.tooltip+(b?"":" on pad "+this.this_pad_name)+(h.keyname?" (keyshortcut "+h.keyname+")":""));a.property("vertical")?g.attr("x",0).attr("y",c):g.attr("x",c).attr("y",0);g.attr("name",h.funcname).style("display",e.property("buttons_state")?"":"none").on("mouseenter",this.toggleButtonsVisibility.bind(this,"enterbtn")).on("mouseleave",
this.toggleButtonsVisibility.bind(this,"leavebtn"));h.keyname&&g.attr("key",h.keyname);g.on("click",this.PadButtonClick.bind(this,h.funcname));c+=this.ButtonSize(1.25)}}a.property("nextx",c);this.AlignBtns(a,this.pad_width(this.this_pad_name),this.pad_height(this.this_pad_name));a.property("vertical")?e.attr("y",c):a.property("leftside")||e.attr("x",c)}}};n.prototype.AlignBtns=function(a,b,c,d){d=this.ButtonSize(1.25);var e=(a.property("nextx")||0)+d;a.property("vertical")?(b=a.property("leftside")?
2:b-d,c-=e):(b=a.property("leftside")?2:b-e,c-=d);a.attr("transform","translate("+b+","+c+")")};n.prototype.GetCoordinate=function(a){function b(a,b,c){return a.fArr&&a.fArr.length>b?a.fArr[b]:c}var c={x:0,y:0};if(!a)return c;var d=this.pad_width(this.this_pad_name),f=this.pad_height(this.this_pad_name),h=b(a.fHoriz,0,0),g=b(a.fHoriz,1,0),k=b(a.fHoriz,2),l=b(a.fVert,0,0),n=b(a.fVert,1,0);a=b(a.fVert,2);this.pad_frame&&void 0!==k||(c.x=h*d+g);this.pad_frame&&void 0!==a||(c.y=f-l*f-n);return c};n.prototype.DecodeOptions=
function(a){var b=this.GetObject();if(b){a=new d.DrawOptions(a);a.check("WEBSOCKET")&&this.OpenWebsocket();this.options||(this.options={});d.extend(this.options,{GlobalColors:!0,LocalColors:!1,IgnorePalette:!1,RotateFrame:!1,FixFrame:!1});if(a.check("NOCOLORS")||a.check("NOCOL"))this.options.GlobalColors=this.options.LocalColors=!1;if(a.check("LCOLORS")||a.check("LCOL"))this.options.GlobalColors=!1,this.options.LocalColors=!0;if(a.check("NOPALETTE")||a.check("NOPAL"))this.options.IgnorePalette=!0;
a.check("ROTATE")&&(this.options.RotateFrame=!0);a.check("FIXFRAME")&&(this.options.FixFrame=!0);a.check("WHITE")&&(b.fFillColor=0);a.check("LOGX")&&(b.fLogx=1);a.check("LOGY")&&(b.fLogy=1);a.check("LOGZ")&&(b.fLogz=1);a.check("LOG")&&(b.fLogx=b.fLogy=b.fLogz=1);a.check("GRIDX")&&(b.fGridx=1);a.check("GRIDY")&&(b.fGridy=1);a.check("GRID")&&(b.fGridx=b.fGridy=1);a.check("TICKX")&&(b.fTickx=1);a.check("TICKY")&&(b.fTicky=1);a.check("TICK")&&(b.fTickx=b.fTicky=1)}};t.prototype=Object.create(n.prototype);
t.prototype.Cleanup=function(){delete this._websocket;delete this._submreq;n.prototype.Cleanup.call(this)};t.prototype.ChangeLayout=function(a,b){if(this.get_layout_kind()==a)return d.CallBack(b,!0);for(var c=this.select_main("origin"),e=c.select(".side_panel"),f=this.select_main(),h=[];f.node().firstChild;)h.push(f.node().removeChild(f.node().firstChild));e.empty()||d.cleanup(e.node());this.set_layout_kind("simple");c.html("");if("simple"==a){f=c;for(var m=0;m<h.length;++m)f.node().appendChild(h[m]);
this.set_layout_kind(a);d.resize(f.node());return d.CallBack(b,!0)}var k=this;d.AssertPrerequisites("jq2d",function(){var m=new d.GridDisplay(c.node(),a);0==a.indexOf("vert")?(f=g.select(m.GetFrame(0)),e=g.select(m.GetFrame(1))):(f=g.select(m.GetFrame(1)),e=g.select(m.GetFrame(0)));f.classed("central_panel",!0).style("position","relative");e.classed("side_panel",!0).style("position","relative");for(m=0;m<h.length;++m)f.node().appendChild(h[m]);k.set_layout_kind(a,".central_panel");c.property("mdi",
null);d.resize(f.node());d.CallBack(b,!0)})};t.prototype.ToggleProjection=function(a,b){delete this.proj_painter;a&&(this.proj_painter=1);if(this.ShowUI5ProjectionArea)return this.ShowUI5ProjectionArea(a,b);var c="simple";"X"==a?c="vert2_31":"Y"==a&&(c="horiz2_13");this.ChangeLayout(c,b)};t.prototype.DrawProjection=function(a,b){if(this.proj_painter)if(1===this.proj_painter){var c=d.Create("TCanvas"),e=this,f=this.root_pad(),h=this.main_painter();"X"==a?(c.fLeftMargin=f.fLeftMargin,c.fRightMargin=
f.fRightMargin,c.fLogx=h.logx?1:0,c.fUxmin=h.logx?d.log10(h.scale_xmin):h.scale_xmin,c.fUxmax=h.logx?d.log10(h.scale_xmax):h.scale_xmax,a="fixframe"):(c.fBottomMargin=f.fBottomMargin,c.fTopMargin=f.fTopMargin,c.fLogx=h.logy?1:0,c.fUxmin=h.logy?d.log10(h.scale_ymin):h.scale_ymin,c.fUxmax=h.logy?d.log10(h.scale_ymax):h.scale_ymax,a="rotate");c.fPrimitives.Add(b,"hist");this.DrawInUI5ProjectionArea?this.DrawInUI5ProjectionArea(c,a,function(a){e.proj_painter=a}):this.DrawInSidePanel(c,a,function(a){e.proj_painter=
a})}else(c=this.proj_painter.main_painter())&&c.UpdateObject(b,"hist"),this.proj_painter.RedrawPad()};t.prototype.DrawInSidePanel=function(a,b,c){var e=this.select_main("origin").select(".side_panel");if(e.empty())return d.CallBack(c,null);d.draw(e.node(),a,b,c)};t.prototype.ShowMessage=function(a){d.progress(a,7E3)};t.prototype.SaveCanvasAsFile=function(a){var b=this,c=a.indexOf(".");this.CreateImage(a.substr(c+1),function(c){b.SendWebsocket("SAVE:"+a+":"+c)})};t.prototype.SendSaveCommand=function(a){this.SendWebsocket("PRODUCE:"+
a)};t.prototype.SendWebsocket=function(a,b){this._websocket&&this._websocket.Send(a,b)};t.prototype.CloseWebsocket=function(a){this._websocket&&(this._websocket.Close(a),this._websocket.Cleanup(),delete this._websocket)};t.prototype.OpenWebsocket=function(a){this.CloseWebsocket();this._websocket=new d.WebWindowHandle(a);this._websocket.SetReceiver(this);this._websocket.Connect()};t.prototype.UseWebsocket=function(a,b){this.CloseWebsocket();this._websocket=a;console.log("Use websocket",this._websocket.key);
this._websocket.SetReceiver(this);this._websocket.Connect(b)};t.prototype.WindowBeforeUnloadHanlder=function(){this.CloseWebsocket(!0)};t.prototype.OnWebsocketOpened=function(a){};t.prototype.OnWebsocketClosed=function(a){d.CloseCurrentWindow()};t.prototype.OnWebsocketMsg=function(a,b){console.log("GET MSG "+b.substr(0,30));if("CLOSE"==b)this.OnWebsocketClosed(),this.CloseWebsocket(!0);else if("SNAP:"==b.substr(0,5)){b=b.substr(5);var c=b.indexOf(":"),e=b.substr(0,c);b=d.parse(b.substr(c+1));this.RedrawPadSnap(b,
function(){a.Send("SNAPDONE:"+e)})}else if("JSON"==b.substr(0,4))b=d.parse(b.substr(4)),this.RedrawObject(b);else if("REPL_REQ:"==b.substr(0,9))this.ProcessDrawableReply(b.substr(9));else if("MENU:"==b.substr(0,5))b=d.parse(b.substr(5)),"function"==typeof this._getmenu_callback&&this._getmenu_callback(b);else if("CMD:"==b.substr(0,4)){b=b.substr(4);c=b.indexOf(":");var f=b.substr(0,c);b=b.substr(c+1);var h="REPLY:"+f+":";if("SVG"==b||"PNG"==b||"JPEG"==b)this.CreateImage(b.toLowerCase(),function(b){a.Send(h+
b)});else if(0==b.indexOf("ADDPANEL:"))if(b=b.substr(9),console.log("request panel = "+b),this.ShowUI5Panel){f=new d.WebWindowHandle(a.kind);f.SetReceiver({cpainter:this,OnWebsocketOpened:function(a){console.log("Panel socket connected")},OnWebsocketMsg:function(b,c){var d=0==c.indexOf("SHOWPANEL:")?c.substr(10):"";console.log("Panel get message "+c+" show "+d);this.cpainter.ShowUI5Panel(d,b,function(b){a.Send(h+(b?"true":"false"))})},OnWebsocketClosed:function(b){a.Send(h+"false")},OnWebsocketError:function(b){a.Send(h+
"false")}});c=a.href;if(0==b.indexOf("../")){var g=c.lastIndexOf("/",c.length-2);c=c.substr(0,g)+b.substr(2)}else c+=b;f.Connect(c)}else a.Send(h+"false");else console.log("Unrecognized command "+b),a.Send(h)}else"DXPROJ:"==b.substr(0,7)||"DYPROJ:"==b.substr(0,7)?(f=b[1],b=d.parse(b.substr(7)),this.DrawProjection(f,b)):"SHOW:"==b.substr(0,5)?(b=b.substr(5),f="1"==b[b.length-1],this.ShowSection(b.substr(0,b.length-2),f)):console.log("unrecognized msg len:"+b.length+" msg:"+b.substr(0,20))};t.prototype.SubmitDrawableRequest=
function(a,b,c,d){if(!(this._websocket&&b&&b._typename&&c.snapid)||"string"!=typeof c.snapid)return null;if(a&&d){c._requests||(c._requests={});var e=c._requests[a];if(e){var h=(new Date).getTime();if(!e._tm||5E3>h-e._tm)return e._nextreq=b,!1;delete c._requests[a]}c._requests[a]=b}b.id=c.snapid;d?(this._nextreqid||(this._nextreqid=1),b.reqid=this._nextreqid++):b.reqid=0;e=JSON.stringify(b);b.reqid&&(b._kind=a,b._painter=c,b._method=d,b._tm=(new Date).getTime(),this._submreq||(this._submreq={}),this._submreq[b.reqid]=
b);this.SendWebsocket("REQ:"+e);return b};t.prototype.SubmitMenuRequest=function(a,b,c,d){this.SubmitDrawableRequest("",{_typename:"ROOT::Experimental::RDrawableMenuRequest",menukind:b||"",menureqid:c},a,d)};t.prototype.SubmitExec=function(a,b,c){console.log("SubmitExec",b,a.snapid);this._websocket&&this.SubmitDrawableRequest("",{_typename:"ROOT::Experimental::RDrawableExecRequest",exec:b},a)};t.prototype.ProcessDrawableReply=function(a){a=d.parse(a);if(!a||!a.reqid||!this._submreq)return!1;var b=
this._submreq[a.reqid];if(!b)return!1;delete this._submreq[a.reqid];b._painter&&b._kind&&b._painter._requests&&b._painter._requests[b._kind]===b&&delete b._painter._requests[b._kind];b._method&&b._method(a,b);b._nextreq&&!b._painter._requests[b._kind]&&this.SubmitDrawableRequest(b._kind,b._nextreq,b._painter,b._method)};t.prototype.ShowSection=function(a,b){switch(a){case "ToolTips":this.SetTooltipAllowed(b)}};d.TCanvasStatusBits={kShowEventStatus:d.BIT(15),kAutoExec:d.BIT(16),kMenuBar:d.BIT(17),
kShowToolBar:d.BIT(18),kShowEditor:d.BIT(19),kMoveOpaque:d.BIT(20),kResizeOpaque:d.BIT(21),kIsGrayscale:d.BIT(22),kShowToolTips:d.BIT(23)};t.prototype.CompeteCanvasSnapDrawing=function(){this.pad&&(document&&(document.title=this.pad.fTitle),this._all_sections_showed||(this._all_sections_showed=!0,this.ShowSection("Menu",this.pad.TestBit(d.TCanvasStatusBits.kMenuBar)),this.ShowSection("StatusBar",this.pad.TestBit(d.TCanvasStatusBits.kShowEventStatus)),this.ShowSection("ToolBar",this.pad.TestBit(d.TCanvasStatusBits.kShowToolBar)),
this.ShowSection("Editor",this.pad.TestBit(d.TCanvasStatusBits.kShowEditor)),this.ShowSection("ToolTips",this.pad.TestBit(d.TCanvasStatusBits.kShowToolTips))))};t.prototype.HasEventStatus=function(){return this.has_event_status};A.prototype=Object.create(d.TObjectPainter.prototype);A.prototype.DrawContent=function(){};A.prototype.DrawPave=function(){var a=this.pad_width(),b=this.pad_height();if(this.frame_painter()){var c=this.frame_x();var e=this.frame_y();var f=this.frame_width();this.frame_height()}else{var h=
d.gStyle;c=Math.round(h.fPadLeftMargin*a);e=Math.round(h.fPadTopMargin*b);f=Math.round((1-h.fPadLeftMargin-h.fPadRightMargin)*a)}var g=this.v7EvalAttr("visible",!0),k=this.v7EvalLength("cornerx",a,.02);h=this.v7EvalLength("cornery",b,-.02);a=this.v7EvalLength("width",a,.3);b=this.v7EvalLength("height",b,.3);var l=this.v7EvalAttr("border_width",1),n=this.v7EvalAttr("border_style",1),q=this.v7EvalColor("border_color","black"),r=this.v7EvalColor("fill_color","white"),t=this.v7EvalAttr("fill_style",1);
this.CreateG(!1);this.draw_g.classed("most_upper_primitives",!0);if(g&&(0==t&&(r="none"),c=Math.round(c+f+k-a),e=Math.round(e+h),this.draw_g.attr("transform","translate("+c+","+e+")").attr("x",c).attr("y",e).attr("width",a).attr("height",b),this.draw_g.append("svg:rect").attr("x",0).attr("width",a).attr("y",0).attr("height",b).style("stroke",q).attr("stroke-width",l).style("stroke-dasharray",d.Painter.root_line_styles[n]).attr("fill",r),this.pave_width=a,this.pave_height=b,this.DrawContent(),!d.BatchMode)){if(d.gStyle.ContextMenu&&
this.ShowContextMenu)this.draw_g.on("contextmenu",this.ShowContextMenu.bind(this));this.AddDrag({minwidth:20,minheight:20,redraw:this.SizeChanged.bind(this)})}};A.prototype.SizeChanged=function(){this.pave_width=parseInt(this.draw_g.attr("width"));this.pave_height=parseInt(this.draw_g.attr("height"));var a=parseInt(this.draw_g.attr("x")),b=parseInt(this.draw_g.attr("y")),c=this.pad_width(),e=this.pad_height();if(this.frame_painter()){var f=this.frame_x();var h=this.frame_y();var g=this.frame_width();
this.frame_height()}else g=d.gStyle,f=Math.round(g.fPadLeftMargin*c),h=Math.round(g.fPadTopMargin*e),g=Math.round((1-g.fPadLeftMargin-g.fPadRightMargin)*c);var k={};this.v7AttrChange(k,"cornerx",(a+this.pave_width-f-g)/c);this.v7AttrChange(k,"cornery",(b-h)/e);this.v7AttrChange(k,"width",this.pave_width/c);this.v7AttrChange(k,"height",this.pave_height/e);this.v7SendAttrChanges(k,!1);this.draw_g.select("rect").attr("width",this.pave_width).attr("height",this.pave_height);this.DrawContent()};A.prototype.Redraw=
function(a){this.DrawPave()};d.v7.ExtractRColor=function(a){return a.fName?a.fName:3==a.fRGBA.length?"rgb("+a.fRGBA[0]+","+a.fRGBA[1]+","+a.fRGBA[2]+")":4==a.fRGBA.length?"rgba("+a.fRGBA[0]+","+a.fRGBA[1]+","+a.fRGBA[2]+","+a.fRGBA[3]+")":"black"};d.registerMethods("ROOT::Experimental::RPalette",{getColor:function(a){return this.palette[a]},getContourIndex:function(a){var b=this.fContour,c=0,d=b.length-1;if(a<b[0])return-1;if(a>=b[d])return d-1;if(this.fCustomContour){for(;c<d-1;){var f=Math.round((c+
d)/2);b[f]>a?d=f:c=f}return c}return Math.floor((a-b[0])/(b[d-1]-b[0])*(d-1))},getContourColor:function(a){a=this.getContourIndex(a);return 0>a?"":this.getColor(a)},GetContour:function(){return this.fContour&&1<this.fContour.length?this.fContour:null},DeleteContour:function(){delete this.fContour},CreatePaletteColors:function(a){for(var b=[],c=0;b.length<a;){var e=b.length/(a-1),f=this.fColors[c];if(1E-4>Math.abs(f.fOrdinal-e)||c==this.fColors.length-1)b.push(d.v7.ExtractRColor(f.fColor));else{var h=
this.fColors[c+1];if(h.fOrdinal<=e)c++;else{var l=h.fOrdinal-f.fOrdinal,k=(h.fOrdinal-e)/l;e=(e-f.fOrdinal)/l;f=g.rgb(d.v7.ExtractRColor(f.fColor));h=g.rgb(d.v7.ExtractRColor(h.fColor));k=g.rgb(Math.round(f.r*k+h.r*e),Math.round(f.g*k+h.g*e),Math.round(f.b*k+h.b*e));b.push(k.toString())}}}return b},CreateContour:function(a,b,c,d,f){this.fContour=[];delete this.fCustomContour;this.colzmin=c;this.colzmax=d;if(a){0>=this.colzmax&&(this.colzmax=1);0>=this.colzmin&&(this.colzmin=void 0===f||0>=f?1E-4*
this.colzmax:3>f||100<f?.3*f:1);this.colzmin>=this.colzmax&&(this.colzmin=1E-4*this.colzmax);a=Math.log(this.colzmin)/Math.log(10);c=(Math.log(this.colzmax)/Math.log(10)-a)/b;this.fContour.push(this.colzmin);for(d=1;d<b;d++)this.fContour.push(Math.exp((a+c*d)*Math.log(10)));this.fContour.push(this.colzmax);this.fCustomContour=!0}else for(this.colzmin===this.colzmax&&0!==this.colzmin&&(this.colzmax+=.01*Math.abs(this.colzmax),this.colzmin-=.01*Math.abs(this.colzmin)),c=(this.colzmax-this.colzmin)/
b,d=0;d<=b;d++)this.fContour.push(this.colzmin+c*d);this.palette&&this.palette.length==b||(this.palette=this.CreatePaletteColors(b))}});C.prototype=Object.create(d.TObjectPainter.prototype);C.prototype.GetPalette=function(){var a=this.GetObject();(a=a?a.fPalette:null)&&!a.getColor&&d.addMethods(a,"ROOT::Experimental::RPalette");return a};C.prototype.DrawPalette=function(a){function b(){if(w){g.event.preventDefault();var a=g.mouse(x);a[1]<D?D=a[1]:I=a[1];y.attr("y",D).attr("height",Math.abs(I-D))}}
function c(){if(w){g.event.preventDefault();g.select(window).on("mousemove.colzoomRect",null).on("mouseup.colzoomRect",null);y.remove();y=null;w=!1;var a=Math.min(v.invert(D),v.invert(I)),b=Math.max(v.invert(D),v.invert(I));h.Zoom("z",a,b)}}var e=this.GetPalette(),f=e.GetContour(),h=this.frame_painter();if(!f)return console.log("no contour - no palette");if(!h)return console.log("no frame painter - no palette");var l=f[0],k=f[f.length-1];this.GetObject();this.pad_painter();var n=this.frame_x(),r=
this.frame_y(),q=this.frame_width(),t=this.frame_height(),z=this.pad_width(),A=this.v7EvalAttr("visible",!0);if(a){var C=parseInt(this.draw_g.attr("width"));t=parseInt(this.draw_g.attr("height"));r={};this.v7AttrChange(r,"margin",(parseInt(this.draw_g.attr("x"))-n-q)/z);this.v7AttrChange(r,"size",C/z);this.v7SendAttrChanges(r,!1)}else{var G=this.v7EvalLength("margin",z,.02);n=Math.round(n+q+G);C=this.v7EvalLength("size",z,.05);this.draw_g.attr("transform","translate("+n+","+r+")").attr("x",n).attr("y",
r).attr("width",C).attr("height",t)}this.draw_g.selectAll("rect").remove();if(A){var P=this.draw_g.select(".colbtns");P.empty()?P=this.draw_g.append("svg:g").attr("class","colbtns"):P.selectAll().remove();P.append("svg:rect").attr("x",0).attr("width",C).attr("y",0).attr("height",t).style("stroke","black").attr("fill","none");var v=null;z="normal";h&&h.logz?(v=g.scaleLog(),z="log"):v=g.scaleLinear();v.domain([l,k]).range([t,0]);for(A=0;A<f.length-1;++A)if(n=v(f[A]),r=v(f[A+1]),q=e.getContourColor((f[A]+
f[A+1])/2),n=P.append("svg:rect").attr("x",0).attr("y",Math.round(r)).attr("width",C).attr("height",Math.round(n)-Math.round(r)).style("fill",q).style("stroke",q).property("fill0",q).property("fill1",g.rgb(q).darker(.5).toString()),this.IsTooltipAllowed()&&n.on("mouseover",function(){g.select(this).transition().duration(100).style("fill",g.select(this).property("fill1"))}).on("mouseout",function(){g.select(this).transition().duration(100).style("fill",g.select(this).property("fill0"))}).append("svg:title").text(f[A].toFixed(2)+
" - "+f[A+1].toFixed(2)),d.gStyle.Zooming)n.on("dblclick",function(){h.Unzoom("z")});this.z_handle.SetAxisConfig("zaxis",z,v,l,k,l,k);this.z_handle.max_tick_size=Math.round(.3*C);this.z_handle.DrawAxis(!0,this.draw_g,C,t,"translate("+C+", 0)");if(!d.BatchMode&&(a||this.AddDrag({minwidth:20,minheight:20,no_change_y:!0,redraw:this.DrawPalette.bind(this,!0)}),d.gStyle.Zooming)){var x=null,w=!1,D=0,I=0,y=null;this.draw_g.select(".axis_zoom").on("mousedown",function(){w||(w=!0,g.event.preventDefault(),
x=this,D=I=g.mouse(x)[1],y=P.append("svg:rect").attr("class","zoom").attr("id","colzoomRect").attr("x","0").attr("width",C).attr("y",D).attr("height",5),g.select(window).on("mousemove.colzoomRect",b).on("mouseup.colzoomRect",c,!0),g.event.stopPropagation())}).on("dblclick",function(){h.Unzoom("z")})}}};d.addDrawFunc({name:"ROOT::Experimental::RHist1Drawable",icon:"img_histo1d",prereq:"v7hist",func:"JSROOT.v7.drawHist1",opt:""});d.addDrawFunc({name:"ROOT::Experimental::RHist2Drawable",icon:"img_histo2d",
prereq:"v7hist",func:"JSROOT.v7.drawHist2",opt:""});d.addDrawFunc({name:"ROOT::Experimental::RHist3Drawable",icon:"img_histo3d",prereq:"v7hist3d",func:"JSROOT.v7.drawHist3",opt:""});d.addDrawFunc({name:"ROOT::Experimental::RHistDisplayItem",icon:"img_histo1d",prereq:"v7hist",func:"JSROOT.v7.drawHistDisplayItem",opt:""});d.addDrawFunc({name:"ROOT::Experimental::RText",icon:"img_text",prereq:"v7more",func:"JSROOT.v7.drawText",opt:"",direct:!0,csstype:"text"});d.addDrawFunc({name:"ROOT::Experimental::RFrameTitle",
icon:"img_text",func:X,opt:"",direct:!0,csstype:"title"});d.addDrawFunc({name:"ROOT::Experimental::RPaletteDrawable",icon:"img_text",func:function(a,b,c){b=new C(b,c);b.SetDivId(a);b.CreateG(!1);b.z_handle=new d.v7.RAxisPainter(!0,"z_");b.z_handle.SetDivId(a,-1);b.z_handle.pad_name=b.pad_name;b.z_handle.invert_side=!0;b.z_handle.rstyle=b.rstyle;return b.DrawingReady()},opt:""});d.addDrawFunc({name:"ROOT::Experimental::RDisplayHistStat",icon:"img_pavetext",prereq:"v7hist",func:"JSROOT.v7.drawHistStats",
opt:""});d.addDrawFunc({name:"ROOT::Experimental::RLine",icon:"img_graph",prereq:"v7more",func:"JSROOT.v7.drawLine",opt:"",direct:!0,csstype:"line"});d.addDrawFunc({name:"ROOT::Experimental::RBox",icon:"img_graph",prereq:"v7more",func:"JSROOT.v7.drawBox",opt:"",direct:!0,csstype:"box"});d.addDrawFunc({name:"ROOT::Experimental::RMarker",icon:"img_graph",prereq:"v7more",func:"JSROOT.v7.drawMarker",opt:"",direct:!0,csstype:"marker"});d.addDrawFunc({name:"ROOT::Experimental::RPave",icon:"img_pavetext",
func:W,opt:""});d.addDrawFunc({name:"ROOT::Experimental::RLegend",icon:"img_graph",prereq:"v7more",func:"JSROOT.v7.drawLegend",opt:""});d.addDrawFunc({name:"ROOT::Experimental::RPaveText",icon:"img_pavetext",prereq:"v7more",func:"JSROOT.v7.drawPaveText",opt:""});d.addDrawFunc({name:"ROOT::Experimental::RFrame",icon:"img_frame",func:"JSROOT.v7.drawFrame",opt:""});d.v7.RAxisPainter=r;d.v7.RFramePainter=l;d.v7.RPalettePainter=C;d.v7.RPadPainter=n;d.v7.RCanvasPainter=t;d.v7.TCanvasPainter=t;d.v7.RPavePainter=
A;d.v7.drawFrame=function(a,b,c){b=new l(b);"3d"==c&&(b.mode3d=!0);b.SetDivId(a,2);b.Redraw();return b.DrawingReady()};d.v7.drawPad=function(a,b,c){var e=new n(b,!1);e.DecodeOptions(c);e.SetDivId(a);e.svg_canvas().empty()&&(e.has_canvas=!1,e.this_pad_name="");e.CreatePadSvg();!e.MatchObjectType("TPad")||e.has_canvas&&!e.HasObjectsToDraw()||(e.AddButton(d.ToolbarIcons.camera,"Create PNG","PadSnapShot"),(e.has_canvas&&e.HasObjectsToDraw()||e.enlarge_main("verify"))&&e.AddButton(d.ToolbarIcons.circle,
"Enlarge pad","EnlargePad"),d.gStyle.ContextMenu&&e.AddButton(d.ToolbarIcons.question,"Access context menus","PadContextMenus"));var f=e.has_canvas?e.CurrentPadName(e.this_pad_name):void 0;d.Painter.SelectActivePad({pp:e,active:!1});e.DrawPrimitives(0,function(){e.ShowButtons();e.CurrentPadName(f);e.DrawingReady()});return e};d.v7.drawCanvas=function(a,b,c){if(c=!b)return console.log("No canvas specified"),null;var e=new t(b);e.normal_canvas=!c;e.SetDivId(a,-1);e.CreateCanvasSvg(0);e.SetDivId(a);
e.AddButton(d.ToolbarIcons.camera,"Create PNG","CanvasSnapShot","Ctrl PrintScreen");d.gStyle.ContextMenu&&e.AddButton(d.ToolbarIcons.question,"Access context menus","PadContextMenus");e.enlarge_main("verify")&&e.AddButton(d.ToolbarIcons.circle,"Enlarge canvas","EnlargePad");d.Painter.SelectActivePad({pp:e,active:!1});e.DrawPrimitives(0,function(){e.ShowButtons();e.DrawingReady()});return e};d.v7.drawPadSnapshot=function(a,b,c){var d=new t(null);d.normal_canvas=!1;d.batch_mode=!0;d.SetDivId(a,-1);
d.RedrawPadSnap(b,function(){d.ShowButtons();d.DrawingReady()});return d};d.v7.drawPave=W;d.v7.drawFrameTitle=X;return d});
